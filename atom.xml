<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>XiaoFeiğŸ¥</title>
  
  
  <link href="https://www.naste.top:1024/atom.xml" rel="self"/>
  
  <link href="https://www.naste.top:1024/"/>
  <updated>2023-08-15T11:06:11.409Z</updated>
  <id>https://www.naste.top:1024/</id>
  
  <author>
    <name>XiaoFeiğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hutoolå®ç°æ•°æ®è„±æ•</title>
    <link href="https://www.naste.top:1024/posts/3224676358.html"/>
    <id>https://www.naste.top:1024/posts/3224676358.html</id>
    <published>2023-08-15T11:06:11.000Z</published>
    <updated>2023-08-15T11:06:11.409Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p>]]></content>
    
    
    <summary type="html">Hutoolå®ç°æ•°æ®è„±æ•</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>EasyExcelä½¿ç”¨</title>
    <link href="https://www.naste.top:1024/posts/869019539.html"/>
    <id>https://www.naste.top:1024/posts/869019539.html</id>
    <published>2023-08-12T13:56:11.000Z</published>
    <updated>2023-08-14T07:25:41.735Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.bilibili.com/video/BV1mG4y1f7jr/">https://www.bilibili.com/video/BV1mG4y1f7jr/</a></p><h1 id="EasyExcelæ³¨è§£"><a href="#EasyExcelæ³¨è§£" class="headerlink" title="EasyExcelæ³¨è§£"></a>EasyExcelæ³¨è§£</h1><div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></div><h1 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--EasyExcel--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `<span class="keyword">user</span>`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;è‡ªå¢id&#x27;</span>,</span><br><span class="line">  `nickname` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·æ˜µç§°&#x27;</span>,</span><br><span class="line">  `avatar` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å¤´åƒé“¾æ¥&#x27;</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç ï¼ŒåŠ å¯†å­˜å‚¨&#x27;</span>,</span><br><span class="line">  `salt` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç ç›å€¼&#x27;</span>,</span><br><span class="line">  `gender` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«ï¼Œ0è¡¨ç¤ºæœªçŸ¥ï¼Œ1è¡¨ç¤ºç”·æ€§ï¼Œ2è¡¨ç¤ºå¥³æ€§&#x27;</span>,</span><br><span class="line">  `birthday` <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”Ÿæ—¥&#x27;</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">  `qq` <span class="type">varchar</span>(<span class="number">16</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;QQå·ç &#x27;</span>,</span><br><span class="line">  `wechat` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¾®ä¿¡å·&#x27;</span>,</span><br><span class="line">  `weibo` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¾®åšè´¦å·&#x27;</span>,</span><br><span class="line">  `github` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;GitHubè´¦å·&#x27;</span>,</span><br><span class="line">  `linkedin` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;LinkedInè´¦å·&#x27;</span>,</span><br><span class="line">  `country_code` <span class="type">varchar</span>(<span class="number">5</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›½å®¶ä»£ç &#x27;</span>,</span><br><span class="line">  `province` <span class="type">varchar</span>(<span class="number">16</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çœä»½&#x27;</span>,</span><br><span class="line">  `city` <span class="type">varchar</span>(<span class="number">16</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åŸå¸‚&#x27;</span>,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">128</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åœ°å€&#x27;</span>,</span><br><span class="line">  `post_code` <span class="type">varchar</span>(<span class="number">6</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç¼–&#x27;</span>,</span><br><span class="line">  `last_login_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æœ€è¿‘ä¸€æ¬¡ç™»å½•æ—¶é—´&#x27;</span>,</span><br><span class="line">  `last_login_ip` <span class="type">varchar</span>(<span class="number">15</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æœ€è¿‘ä¸€æ¬¡ç™»å½•IPåœ°å€&#x27;</span>,</span><br><span class="line">  `status` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;ç”¨æˆ·çŠ¶æ€ï¼Œ0è¡¨ç¤ºç¦ç”¨ï¼Œ1è¡¨ç¤ºå¯ç”¨&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `update_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  `remark1` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è‡ªå®šä¹‰å­—æ®µ1&#x27;</span>,</span><br><span class="line">  `remark2` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è‡ªå®šä¹‰å­—æ®µ2&#x27;</span>,</span><br><span class="line">  `remark3` <span class="type">varchar</span>(<span class="number">64</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è‡ªå®šä¹‰å­—æ®µ3&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `idx_username` (`username`) <span class="keyword">USING</span> BTREE COMMENT <span class="string">&#x27;å”¯ä¸€ç´¢å¼•ï¼Œä¿è¯ç”¨æˆ·åå”¯ä¸€&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci ROW_FORMAT<span class="operator">=</span><span class="keyword">DYNAMIC</span> COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·è¡¨&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.ExcelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ä¿¡æ¯excelæ˜ å°„ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserExcelEntity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;ç¼–å·&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;æ˜µç§°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;ç”¨æˆ·å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;å¯†ç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–‡ä»¶å¯¼å…¥"><a href="#æ–‡ä»¶å¯¼å…¥" class="headerlink" title="æ–‡ä»¶å¯¼å…¥"></a>æ–‡ä»¶å¯¼å…¥</h1><h2 id="åŸºæœ¬æ–¹å¼å¯¼å…¥"><a href="#åŸºæœ¬æ–¹å¼å¯¼å…¥" class="headerlink" title="åŸºæœ¬æ–¹å¼å¯¼å…¥"></a>åŸºæœ¬æ–¹å¼å¯¼å…¥</h2><blockquote><p><strong>åŸºæœ¬æ–¹å¼å¯¼å…¥ï¼Œç¨‹åºä¸­è·å–åˆ°çš„æ•°æ®ä¸º<code>Map</code>ç±»å‹</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1ã€åŸºæœ¬æ–¹å¼å¯¼å…¥</span></span><br><span class="line"><span class="comment"> * Date: 2023/8/12</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XiaoFei</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseImport</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\user.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Object&gt; list = EasyExcel.read(file).sheet(<span class="number">0</span>).doReadSync();</span><br><span class="line"></span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="E:\images\image-20230812232426105.png" alt="image-20230812232426105"></p><h2 id="æ¨¡å‹æ˜ å°„å¯¼å…¥"><a href="#æ¨¡å‹æ˜ å°„å¯¼å…¥" class="headerlink" title="æ¨¡å‹æ˜ å°„å¯¼å…¥"></a>æ¨¡å‹æ˜ å°„å¯¼å…¥</h2><h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><ul><li><p>å…³è”æ˜ å°„</p><ul><li><p>@ExcelProperty(index = 0)</p></li><li><p>@ExcelProperty(value = â€œåˆ—åâ€)</p></li><li><p>@ExcelProperty(value = {â€œä¸»æ ‡é¢˜â€, â€œå‰¯æ ‡é¢˜â€})</p></li></ul></li><li><p>æ ¼å¼è½¬æ¢ï¼Œæ³¨è§£éƒ½æ˜¯å±äº<code>com.alibaba.excel.annotation</code>ä¸‹çš„</p><ul><li>@DateTimeFormat(value = â€œyyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’â€)</li><li>@NumberFormat(value = â€œ#.##%â€)</li><li>@ExcelProperty(converter = è‡ªå®šä¹‰æ ¼å¼è½¬æ¢.class)</li></ul></li><li>ç›¸å…³æ–¹æ³•<ul><li>EasyExcel.read(inputStream).head(æ˜ å°„æ¨¡å‹.class).xxx</li></ul></li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.excel.UserExcelEntity;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1ã€æ–‡ä»¶å¯¼å…¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileImport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¨¡å‹æ˜ å¯¼å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">modelMapImport</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\user.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;UserExcelEntity&gt; list = EasyExcel.read(file).head(UserExcelEntity.class).sheet(<span class="number">0</span>).doReadSync();</span><br><span class="line"></span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="E:\images\image-20230813100133627.png" alt="image-20230813100133627"></p><h2 id="å¯¼å…¥çš„ç›‘æ˜•å™¨"><a href="#å¯¼å…¥çš„ç›‘æ˜•å™¨" class="headerlink" title="å¯¼å…¥çš„ç›‘æ˜•å™¨"></a>å¯¼å…¥çš„ç›‘æ˜•å™¨</h2><h3 id="ä½¿ç”¨EasyExcelè‡ªå¸¦ç›‘å¬å™¨"><a href="#ä½¿ç”¨EasyExcelè‡ªå¸¦ç›‘å¬å™¨" class="headerlink" title="ä½¿ç”¨EasyExcelè‡ªå¸¦ç›‘å¬å™¨"></a>ä½¿ç”¨EasyExcelè‡ªå¸¦ç›‘å¬å™¨</h3><p><img src="E:\images\image-20230813110435387.png" alt="image-20230813110435387"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.listener.PageReadListener;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.excel.UserExcelEntity;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1ã€æ–‡ä»¶å¯¼å…¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileImport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¼å…¥ç›‘å¬å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">listenerImport</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\user.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">        EasyExcel.read(inputStream, UserExcelEntity.class, <span class="keyword">new</span> <span class="title class_">PageReadListener</span>&lt;&gt;(<span class="built_in">this</span>::consumerMethod)).sheet(<span class="number">0</span>).doRead();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¶ˆè´¹å‡½æ•°ï¼Œç›‘å¬å™¨ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯¹æ•°æ®è¿›è¡Œæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">consumerMethod</span><span class="params">(List&lt;UserExcelEntity&gt; list)</span> &#123;</span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨è‡ªå®šä¹‰ç›‘å¬å™¨"><a href="#ä½¿ç”¨è‡ªå®šä¹‰ç›‘å¬å™¨" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰ç›‘å¬å™¨"></a>ä½¿ç”¨è‡ªå®šä¹‰ç›‘å¬å™¨</h3><blockquote><p><strong>åˆ›å»ºä¸€ä¸ªç±»ï¼Œå®ç°<code>ReadListener</code>æ¥å£</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.context.AnalysisContext;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.listener.ReadListener;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.excel.UserExcelEntity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ä¿¡æ¯excelå¯¼å…¥ç›‘å¬å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserListener</span> <span class="keyword">implements</span> <span class="title class_">ReadListener</span>&lt;UserExcelEntity&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ¯ä¸€è¡Œæ•°æ®å’Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(UserExcelEntity userExcelEntity, AnalysisContext analysisContext)</span> &#123;</span><br><span class="line">        System.out.println(userExcelEntity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterAllAnalysed</span><span class="params">(AnalysisContext analysisContext)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.excel.UserExcelEntity;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.listener.UserListener;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1ã€æ–‡ä»¶å¯¼å…¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileImport</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›‘å¬å™¨å¯¼å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">listenerImport</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\user.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">        EasyExcel.read(inputStream, UserExcelEntity.class, <span class="keyword">new</span> <span class="title class_">UserListener</span>()).sheet(<span class="number">0</span>).doRead();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æŒ‡å®šè¡¨å¤´å¯¼å…¥"><a href="#æŒ‡å®šè¡¨å¤´å¯¼å…¥" class="headerlink" title="æŒ‡å®šè¡¨å¤´å¯¼å…¥"></a>æŒ‡å®šè¡¨å¤´å¯¼å…¥</h2><p><img src="E:\images\image-20230813111609120.png" alt="image-20230813111609120"></p><blockquote><p><strong>å¦‚å›¾æ‰€ç¤ºï¼Œç”±äºè¡¨å¤´æ‰€åœ¨è¡Œæ•°ä¸æ˜¯ç¬¬ä¸€è¡Œï¼ŒEasyExcelé»˜è®¤æ˜¯æŒ‡å®šç¬¬ä¸€è¡Œä¸ºè¡¨å¤´ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦<code>EasyExcel.read().headRowNumber(è¡¨å¤´æ‰€åœ¨è¡Œæ•°)</code>æŒ‡å®šè¡¨å¤´æ‰€åœ¨è¡Œ</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.listener.PageReadListener;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.excel.UserExcelEntity;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1ã€æ–‡ä»¶å¯¼å…¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileImport</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¼å…¥ç›‘å¬å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">listenerImport</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\user.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">        EasyExcel.read(inputStream, UserExcelEntity.class, <span class="keyword">new</span> <span class="title class_">PageReadListener</span>&lt;&gt;(<span class="built_in">this</span>::consumerMethod))</span><br><span class="line">                .headRowNumber(<span class="number">3</span>)</span><br><span class="line">                .sheet(<span class="number">0</span>).doRead();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¶ˆè´¹å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">consumerMethod</span><span class="params">(List&lt;UserExcelEntity&gt; list)</span> &#123;</span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯¼å…¥å¼‚å¸¸å¤„ç†"><a href="#å¯¼å…¥å¼‚å¸¸å¤„ç†" class="headerlink" title="å¯¼å…¥å¼‚å¸¸å¤„ç†"></a>å¯¼å…¥å¼‚å¸¸å¤„ç†</h2><blockquote><p><strong><code>ReadListener</code>æ¥å£ä¸­çš„<code>onException</code>ä¸ºå‡ºç°å¼‚å¸¸æ—¶ä¼šæ‰§è¡Œçš„æ–¹æ³•</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.context.AnalysisContext;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.listener.ReadListener;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.excel.UserExcelEntity;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ä¿¡æ¯excelå¯¼å…¥ç›‘å¬å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserListener</span> <span class="keyword">implements</span> <span class="title class_">ReadListener</span>&lt;UserExcelEntity&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(UserExcelEntity userExcelEntity, AnalysisContext analysisContext)</span> &#123;</span><br><span class="line">        System.out.println(userExcelEntity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterAllAnalysed</span><span class="params">(AnalysisContext analysisContext)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‡ºç°å¼‚å¸¸æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šæ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onException</span><span class="params">(Exception exception, AnalysisContext context)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        log.error(<span class="string">&quot;Excelå¯¼å…¥æŠ¥é”™&quot;</span>);</span><br><span class="line">        ReadListener.<span class="built_in">super</span>.onException(exception, context);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶ä¸Šä¼ å¯¼å…¥"><a href="#æ–‡ä»¶ä¸Šä¼ å¯¼å…¥" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ å¯¼å…¥"></a>æ–‡ä»¶ä¸Šä¼ å¯¼å…¥</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> file ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> trueï¼šä¸Šä¼ æˆåŠŸã€‚falseï¼šä¸Šä¼ å¤±è´¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;æ–‡ä»¶ä¸Šä¼ &quot;, httpMethod = &quot;POST&quot;, response = ResponseUtils.class, produces = &quot;application/json&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseUtils&lt;Boolean&gt; <span class="title function_">uploadFile</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">Boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> userService.uploadFile(file);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseUtils</span>&lt;Boolean&gt;().success(isSuccess ? <span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span> : <span class="string">&quot;ä¸Šä¼ å¤±è´¥&quot;</span>, isSuccess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> file ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> trueï¼šä¸Šä¼ æˆåŠŸã€‚falseï¼šä¸Šä¼ å¤±è´¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">uploadFile</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¸Šä¼ çš„æ–‡ä»¶ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–fileçš„æ–‡ä»¶æµ</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> file.getInputStream();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//EasyExcelè¯»å–inputStreamé‡Œé¢çš„æ•°æ®ï¼Œæ‰¹é‡æ’å…¥æ•°æ®åº“ä¸­</span></span><br><span class="line">    EasyExcel.read(inputStream, UserEntity.class, <span class="keyword">new</span> <span class="title class_">PageReadListener</span>&lt;&gt;(<span class="built_in">this</span>::addBatch)).headRowNumber(<span class="number">3</span>).sheet().doRead();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›å¤„ç†ç»“æœ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰¹é‡æ·»åŠ æ•°æ®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> userEntityList æ•°æ®é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> trueï¼šæ·»åŠ æˆåŠŸã€‚falseï¼šæ·»åŠ å¤±è´¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@CacheEvict(cacheNames = RedisConstant.BASE_CACHE_KEY + &quot;user&quot;, allEntries = true)</span></span><br><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">addBatch</span><span class="params">(List&lt;UserEntity&gt; userEntityList)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.saveBatch(userEntityList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–‡ä»¶å¯¼å‡º"><a href="#æ–‡ä»¶å¯¼å‡º" class="headerlink" title="æ–‡ä»¶å¯¼å‡º"></a>æ–‡ä»¶å¯¼å‡º</h1><h2 id="åŸºæœ¬æ–¹å¼å¯¼å‡º"><a href="#åŸºæœ¬æ–¹å¼å¯¼å‡º" class="headerlink" title="åŸºæœ¬æ–¹å¼å¯¼å‡º"></a>åŸºæœ¬æ–¹å¼å¯¼å‡º</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">baseImport</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\userExport.xlsx&quot;</span>;</span><br><span class="line">    List&lt;UserEntity&gt; userEntities = userService.selectList();</span><br><span class="line"></span><br><span class="line">    EasyExcel.write(filePath).sheet(<span class="string">&quot;å¯¼å‡ºæ•°æ®&quot;</span>).head(UserEntity.class).doWrite(userEntities);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹æ˜ å°„å¯¼å‡º"><a href="#æ¨¡å‹æ˜ å°„å¯¼å‡º" class="headerlink" title="æ¨¡å‹æ˜ å°„å¯¼å‡º"></a>æ¨¡å‹æ˜ å°„å¯¼å‡º</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.UserEntity;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EasyExcelApplicationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŸºç¡€å¯¼å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">baseImport</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">        List&lt;UserEntity&gt; userEntities = userService.selectList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯¼å…¥Excelè¡¨æ ¼ä¸­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\userExport.xlsx&quot;</span>;</span><br><span class="line">        EasyExcel.write(filePath).sheet(<span class="string">&quot;å¯¼å‡ºæ•°æ®&quot;</span>).head(UserEntity.class).doWrite(userEntities);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯¼å‡ºè¡Œé«˜åˆ—å®½"><a href="#å¯¼å‡ºè¡Œé«˜åˆ—å®½" class="headerlink" title="å¯¼å‡ºè¡Œé«˜åˆ—å®½"></a>å¯¼å‡ºè¡Œé«˜åˆ—å®½</h2><blockquote><p><strong>åœ¨å®ä½“ç±»çš„å­—æ®µæˆ–ç±»ä¸Šï¼Œæ·»åŠ å¯¹åº”çš„æ³¨è§£</strong></p></blockquote><p><img src="E:\images\image-20230813162000907.png" alt="image-20230813162000907"></p><blockquote><p><strong>EasyExcel.write(filePath).sheet(â€œå¯¼å‡ºæ•°æ®â€).registerWriteHandlerå¯¹åº”çš„ç­–ç•¥ï¼Œä¹Ÿå¯ä»¥å†™ä¸€ä¸ªç±»ç»§æ‰¿<code>AbstractColumnWidthStyleStrategy</code></strong></p></blockquote><p><img src="E:\images\image-20230813162104164.png" alt="image-20230813162104164"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.style.column.SimpleColumnWidthStyleStrategy;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.entity.UserEntity;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EasyExcelApplicationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŸºç¡€å¯¼å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">baseImport</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">        List&lt;UserEntity&gt; userEntities = userService.selectList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯¼å…¥Excelè¡¨æ ¼ä¸­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;C:\\Users\\19030\\Desktop\\tmp\\userExport.xlsx&quot;</span>;</span><br><span class="line">        EasyExcel</span><br><span class="line">                .write(filePath)</span><br><span class="line">                .sheet(<span class="string">&quot;å¯¼å‡ºæ•°æ®&quot;</span>).head(UserEntity.class)</span><br><span class="line">                .registerWriteHandler(<span class="keyword">new</span> <span class="title class_">SimpleColumnWidthStyleStrategy</span>(<span class="number">30</span>))</span><br><span class="line">                .doWrite(userEntities);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªç±»ï¼Œç»§æ‰¿<code>AbstractCellStyleStrategy</code>å¹¶ä¸”å®ç°<code>CellWriteHandler</code>ï¼Œç¼–å†™ä¸€ä¸ªEasyExcelçš„è‡ªå®šä¹‰æ‹¦æˆªå™¨</strong></p></blockquote><h2 id="åˆå¹¶å•å…ƒæ ¼å¯¼å‡º"><a href="#åˆå¹¶å•å…ƒæ ¼å¯¼å‡º" class="headerlink" title="åˆå¹¶å•å…ƒæ ¼å¯¼å‡º"></a>åˆå¹¶å•å…ƒæ ¼å¯¼å‡º</h2><h2 id="å¯¼å‡ºåŠ¨æ€è¡¨å¤´"><a href="#å¯¼å‡ºåŠ¨æ€è¡¨å¤´" class="headerlink" title="å¯¼å‡ºåŠ¨æ€è¡¨å¤´"></a>å¯¼å‡ºåŠ¨æ€è¡¨å¤´</h2><h2 id="å¯¼å‡ºé“¾æ¥æ‰¹æ³¨å…¬å¼"><a href="#å¯¼å‡ºé“¾æ¥æ‰¹æ³¨å…¬å¼" class="headerlink" title="å¯¼å‡ºé“¾æ¥æ‰¹æ³¨å…¬å¼"></a>å¯¼å‡ºé“¾æ¥æ‰¹æ³¨å…¬å¼</h2><h2 id="å¯¼å‡ºå›¾ç‰‡å†…å®¹"><a href="#å¯¼å‡ºå›¾ç‰‡å†…å®¹" class="headerlink" title="å¯¼å‡ºå›¾ç‰‡å†…å®¹"></a>å¯¼å‡ºå›¾ç‰‡å†…å®¹</h2><h1 id="å¡«å……æ¨¡æ¿"><a href="#å¡«å……æ¨¡æ¿" class="headerlink" title="å¡«å……æ¨¡æ¿"></a>å¡«å……æ¨¡æ¿</h1><h2 id="æ¨¡æ¿å¡«å……å¯¹è±¡"><a href="#æ¨¡æ¿å¡«å……å¯¹è±¡" class="headerlink" title="æ¨¡æ¿å¡«å……å¯¹è±¡"></a>æ¨¡æ¿å¡«å……å¯¹è±¡</h2><h2 id="æ¨¡æ¿å¡«å……åˆ—è¡¨"><a href="#æ¨¡æ¿å¡«å……åˆ—è¡¨" class="headerlink" title="æ¨¡æ¿å¡«å……åˆ—è¡¨"></a>æ¨¡æ¿å¡«å……åˆ—è¡¨</h2><h2 id="æ¨¡æ¿ç»„åˆå¡«å……"><a href="#æ¨¡æ¿ç»„åˆå¡«å……" class="headerlink" title="æ¨¡æ¿ç»„åˆå¡«å……"></a>æ¨¡æ¿ç»„åˆå¡«å……</h2><h2 id="å¯¼å‡ºæ–‡ä»¶ä¸‹è½½"><a href="#å¯¼å‡ºæ–‡ä»¶ä¸‹è½½" class="headerlink" title="å¯¼å‡ºæ–‡ä»¶ä¸‹è½½"></a>å¯¼å‡ºæ–‡ä»¶ä¸‹è½½</h2><h1 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.enums.CellDataTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.metadata.Head;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.metadata.data.WriteCellData;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.util.MapUtils;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.holder.WriteSheetHolder;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.style.column.AbstractColumnWidthStyleStrategy;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Excelå¯¼å‡ºè‡ªå®šä¹‰åˆ—å®½ç­–ç•¥è®¾ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ColumnWidthStyleStrategy</span> <span class="keyword">extends</span> <span class="title class_">AbstractColumnWidthStyleStrategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX_COLUMN_WIDTH</span> <span class="operator">=</span> <span class="number">255</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;Integer, Map&lt;Integer, Integer&gt;&gt; cache = MapUtils.newHashMapWithExpectedSize(<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®åˆ—å®½åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setColumnWidth</span><span class="params">(WriteSheetHolder writeSheetHolder, List&lt;WriteCellData&lt;?&gt;&gt; cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">needSetWidth</span> <span class="operator">=</span> isHead || !CollectionUtils.isEmpty(cellDataList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ˜¯å¦éœ€è¦è®¾ç½®å®½åº¦</span></span><br><span class="line">        <span class="keyword">if</span> (needSetWidth) &#123;</span><br><span class="line">            Map&lt;Integer, Integer&gt; maxColumnWidthMap = <span class="built_in">this</span>.cache.computeIfAbsent(writeSheetHolder.getSheetNo(), (key) -&gt; <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>));</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">columnWidth</span> <span class="operator">=</span> <span class="built_in">this</span>.dataLength(cellDataList, cell, isHead);</span><br><span class="line">            <span class="comment">// åˆ—å®½åˆ¤æ–­</span></span><br><span class="line">            <span class="keyword">if</span> (columnWidth &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (columnWidth &gt; MAX_COLUMN_WIDTH) &#123;</span><br><span class="line">                    columnWidth = MAX_COLUMN_WIDTH;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Integer</span> <span class="variable">maxColumnWidth</span> <span class="operator">=</span> maxColumnWidthMap.get(cell.getColumnIndex());</span><br><span class="line">                <span class="keyword">if</span> (maxColumnWidth == <span class="literal">null</span> || columnWidth &gt; maxColumnWidth) &#123;</span><br><span class="line">                    maxColumnWidthMap.put(cell.getColumnIndex(), columnWidth);</span><br><span class="line">                    writeSheetHolder.getSheet().setColumnWidth(cell.getColumnIndex(), (columnWidth + <span class="number">15</span>) * MAX_COLUMN_WIDTH);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®é•¿åº¦è·å–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer <span class="title function_">dataLength</span><span class="params">(List&lt;WriteCellData&lt;?&gt;&gt; cellDataList, Cell cell, Boolean isHead)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isHead) &#123;</span><br><span class="line">            <span class="keyword">return</span> cell.getStringCellValue().getBytes().length;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            WriteCellData&lt;?&gt; cellData = cellDataList.get(<span class="number">0</span>);</span><br><span class="line">            <span class="type">CellDataTypeEnum</span> <span class="variable">type</span> <span class="operator">=</span> cellData.getType();</span><br><span class="line">            <span class="keyword">if</span> (type == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">                    <span class="keyword">case</span> STRING:</span><br><span class="line">                        <span class="keyword">return</span> cellData.getStringValue().getBytes().length;</span><br><span class="line">                    <span class="keyword">case</span> BOOLEAN:</span><br><span class="line">                        <span class="keyword">return</span> cellData.getBooleanValue().toString().getBytes().length;</span><br><span class="line">                    <span class="keyword">case</span> NUMBER:</span><br><span class="line">                        <span class="keyword">return</span> cellData.getNumberValue().toString().getBytes().length;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.enums.BooleanEnum;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.event.SyncReadListener;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.listener.PageReadListener;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.support.ExcelTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.style.WriteCellStyle;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.style.WriteFont;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.style.HorizontalCellStyleStrategy;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.style.row.SimpleRowHeightStyleStrategy;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.excel.strategy.ColumnWidthStyleStrategy;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * EasyExcelå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EasyExcelUtils</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–æŒ‡å®šçš„æ–‡ä»¶ä¸­çš„æŒ‡å®šçš„sheetå¹¶ä¸”æŒ‡å®šConsumerå¯¹æ•°æ®è¿›è¡Œæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream æ–‡ä»¶æµ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head        è¯»å–çš„æ•°æ®è¦è½¬æ¢æˆå“ªä¸ªç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> consumer    ç”¨äºæ¶ˆè´¹æ•°æ®æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetName   sheetNameåç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">readFile</span><span class="params">(InputStream inputStream, Class&lt;T&gt; head, Consumer&lt;List&lt;T&gt;&gt; consumer, String sheetName, Integer headRowNumber)</span> &#123;</span><br><span class="line">        EasyExcel.read(inputStream, head, <span class="keyword">new</span> <span class="title class_">PageReadListener</span>&lt;&gt;(consumer))</span><br><span class="line">                .autoCloseStream(<span class="literal">false</span>) <span class="comment">// ä¸è¦è‡ªåŠ¨å…³é—­ï¼Œäº¤ç»™ Servlet è‡ªå·±å¤„ç†</span></span><br><span class="line">                .headRowNumber(headRowNumber == <span class="literal">null</span> ? <span class="number">1</span> : headRowNumber)</span><br><span class="line">                .sheet(sheetName)</span><br><span class="line">                .doReadSync();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–æŒ‡å®šçš„æ–‡ä»¶ä¸­çš„æŒ‡å®šçš„sheetå¹¶ä¸”æŒ‡å®šConsumerå¯¹æ•°æ®è¿›è¡Œæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream æ–‡ä»¶æµ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head        è¯»å–çš„æ•°æ®è¦è½¬æ¢æˆå“ªä¸ªç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> consumer    ç”¨äºæ¶ˆè´¹æ•°æ®æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">readFile</span><span class="params">(InputStream inputStream, Class&lt;T&gt; head, Consumer&lt;List&lt;T&gt;&gt; consumer, Integer headRowNumber)</span> &#123;</span><br><span class="line">        EasyExcel.read(inputStream, head, <span class="keyword">new</span> <span class="title class_">PageReadListener</span>&lt;T&gt;(consumer))</span><br><span class="line">                .autoCloseStream(<span class="literal">false</span>) <span class="comment">// ä¸è¦è‡ªåŠ¨å…³é—­ï¼Œäº¤ç»™ Servlet è‡ªå·±å¤„ç†</span></span><br><span class="line">                .headRowNumber(headRowNumber == <span class="literal">null</span> ? <span class="number">1</span> : headRowNumber)</span><br><span class="line">                .doReadAllSync();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–æŒ‡å®šçš„æ–‡ä»¶ä¸­çš„æŒ‡å®šçš„sheetå¹¶ä¸”æŒ‡å®šConsumerå¯¹æ•°æ®è¿›è¡Œæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream   æ–‡ä»¶æµ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head          è¯»å–çš„æ•°æ®è¦è½¬æ¢æˆå“ªä¸ªç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetName     sheetNameåç§°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> headRowNumber è¡¨å¤´åœ¨å“ªä¸€è¡Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; List&lt;T&gt; <span class="title function_">readFile</span><span class="params">(InputStream inputStream, Class&lt;T&gt; head, String sheetName, Integer headRowNumber)</span> &#123;</span><br><span class="line">        <span class="type">SyncReadListener</span> <span class="variable">syncReadListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SyncReadListener</span>();</span><br><span class="line">        EasyExcel.read(inputStream, head, syncReadListener)</span><br><span class="line">                .autoCloseStream(<span class="literal">false</span>) <span class="comment">// ä¸è¦è‡ªåŠ¨å…³é—­ï¼Œäº¤ç»™ Servlet è‡ªå·±å¤„ç†</span></span><br><span class="line">                .headRowNumber(headRowNumber == <span class="literal">null</span> ? <span class="number">1</span> : headRowNumber)</span><br><span class="line">                .sheet(sheetName)</span><br><span class="line">                .doReadSync();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ¤æ–­è·å–åˆ°çš„æ•°æ®æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (syncReadListener.getList() != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (List&lt;T&gt;) syncReadListener.getList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–æŒ‡å®šçš„æ–‡ä»¶ä¸­çš„æŒ‡å®šçš„sheetå¹¶ä¸”æŒ‡å®šConsumerå¯¹æ•°æ®è¿›è¡Œæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream æ–‡ä»¶æµ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head        è¯»å–çš„æ•°æ®è¦è½¬æ¢æˆå“ªä¸ªç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; List&lt;T&gt; <span class="title function_">readFile</span><span class="params">(InputStream inputStream, Class&lt;T&gt; head, Integer headRowNumber)</span> &#123;</span><br><span class="line">        <span class="type">SyncReadListener</span> <span class="variable">syncReadListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SyncReadListener</span>();</span><br><span class="line"></span><br><span class="line">        EasyExcel.read(inputStream, head, syncReadListener)</span><br><span class="line">                .autoCloseStream(<span class="literal">false</span>) <span class="comment">// ä¸è¦è‡ªåŠ¨å…³é—­ï¼Œäº¤ç»™ Servlet è‡ªå·±å¤„ç†</span></span><br><span class="line">                .headRowNumber(headRowNumber == <span class="literal">null</span> ? <span class="number">1</span> : headRowNumber)</span><br><span class="line">                .doReadAllSync();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ¤æ–­è·å–åˆ°çš„æ•°æ®æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (syncReadListener.getList() != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (List&lt;T&gt;) syncReadListener.getList();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ•°æ®å†™å…¥Excelä¸­</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeFile</span><span class="params">(HttpServletResponse response, String filename, String sheetName, Class&lt;T&gt; head, List&lt;T&gt; data)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½® header å’Œ contentTypeã€‚å†™åœ¨æœ€åçš„åŸå› æ˜¯ï¼Œé¿å…æŠ¥é”™æ—¶ï¼Œå“åº” contentType å·²ç»è¢«ä¿®æ”¹äº†</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/vnd.ms-excel&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿™é‡ŒURLEncoder.encodeå¯ä»¥é˜²æ­¢ä¸­æ–‡ä¹±ç </span></span><br><span class="line">        filename = URLEncoder.encode(filename, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + filename + <span class="string">&quot;_&quot;</span> + System.currentTimeMillis() + ExcelTypeEnum.XLSX.getValue());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¤´æ ·å¼ç­–ç•¥</span></span><br><span class="line">        <span class="type">HorizontalCellStyleStrategy</span> <span class="variable">horizontalCellStyleStrategy</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">HorizontalCellStyleStrategy</span>(headWriteCellStyle(), contentWriteCellStyle());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å†…å®¹æ ·å¼ç­–ç•¥</span></span><br><span class="line">        EasyExcel</span><br><span class="line">                .write(response.getOutputStream(), head)</span><br><span class="line">                .autoCloseStream(<span class="literal">false</span>) <span class="comment">// ä¸è¦è‡ªåŠ¨å…³é—­ï¼Œäº¤ç»™ Servlet è‡ªå·±å¤„ç†</span></span><br><span class="line">                .registerWriteHandler(<span class="keyword">new</span> <span class="title class_">ColumnWidthStyleStrategy</span>()) <span class="comment">// è‡ªåŠ¨é€‚é…å®½åº¦ç­–ç•¥</span></span><br><span class="line">                .registerWriteHandler(<span class="keyword">new</span> <span class="title class_">SimpleRowHeightStyleStrategy</span>((<span class="type">short</span>) <span class="number">30</span>, (<span class="type">short</span>) <span class="number">25</span>))<span class="comment">//è®¾ç½®è¡¨å¤´è¡Œé«˜å’Œå†…å®¹è¡Œé«˜</span></span><br><span class="line">                .registerWriteHandler(horizontalCellStyleStrategy) <span class="comment">// è®¾ç½®è‡ªå®šä¹‰æ ·å¼</span></span><br><span class="line">                .sheet(sheetName)</span><br><span class="line">                .doWrite(data);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Excelè¡¨å¤´æ ·å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> WriteCellStyle <span class="title function_">headWriteCellStyle</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å¤´çš„ç­–ç•¥</span></span><br><span class="line">        <span class="type">WriteCellStyle</span> <span class="variable">headWriteCellStyle</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WriteCellStyle</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å­—ä½“</span></span><br><span class="line">        <span class="type">WriteFont</span> <span class="variable">headWriteFont</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WriteFont</span>();</span><br><span class="line">        headWriteFont.setFontName(<span class="string">&quot;ä»¿å®‹&quot;</span>);<span class="comment">//è®¾ç½®å­—ä½“åå­—</span></span><br><span class="line">        headWriteFont.setFontHeightInPoints((<span class="type">short</span>) <span class="number">16</span>);<span class="comment">//è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">        headWriteFont.setBold(BooleanEnum.TRUE.getBooleanValue());<span class="comment">//å­—ä½“æ˜¯å¦åŠ ç²—</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ·å¼</span></span><br><span class="line">        headWriteCellStyle.setWriteFont(headWriteFont); <span class="comment">//åœ¨æ ·å¼ç”¨åº”ç”¨è®¾ç½®çš„å­—ä½“æ ·å¼;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// èƒŒæ™¯</span></span><br><span class="line">        headWriteCellStyle.setFillForegroundColor(IndexedColors.PALE_BLUE.index);<span class="comment">//èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        headWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);<span class="comment">//èƒŒæ™¯é¢œè‰²å¡«å……ç±»å‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¾¹æ¡†</span></span><br><span class="line">        headWriteCellStyle.setBorderBottom(BorderStyle.THIN);<span class="comment">//è®¾ç½®åº•è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setBottomBorderColor((IndexedColors.BLACK1.index));<span class="comment">//è®¾ç½®åº•è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line">        headWriteCellStyle.setBorderLeft(BorderStyle.THIN);  <span class="comment">//è®¾ç½®å·¦è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setLeftBorderColor(IndexedColors.BLACK1.index);<span class="comment">//è®¾ç½®å·¦è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line">        headWriteCellStyle.setBorderRight(BorderStyle.THIN);<span class="comment">//è®¾ç½®å³è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setRightBorderColor(IndexedColors.BLACK1.index);<span class="comment">//è®¾ç½®å³è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line">        headWriteCellStyle.setBorderTop(BorderStyle.THIN);<span class="comment">//è®¾ç½®é¡¶è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setTopBorderColor(IndexedColors.BLACK1.index); <span class="comment">//è®¾ç½®é¡¶è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…¶ä»–</span></span><br><span class="line">        headWriteCellStyle.setWrapped(BooleanEnum.FALSE.getBooleanValue());  <span class="comment">//è®¾ç½®è‡ªåŠ¨æ¢è¡Œ;</span></span><br><span class="line">        headWriteCellStyle.setHorizontalAlignment(HorizontalAlignment.CENTER);<span class="comment">//è®¾ç½®æ°´å¹³å¯¹é½çš„æ ·å¼ä¸ºå±…ä¸­å¯¹é½;</span></span><br><span class="line">        headWriteCellStyle.setVerticalAlignment(VerticalAlignment.CENTER);  <span class="comment">//è®¾ç½®å‚ç›´å¯¹é½çš„æ ·å¼ä¸ºå±…ä¸­å¯¹é½;</span></span><br><span class="line">        headWriteCellStyle.setShrinkToFit(BooleanEnum.FALSE.getBooleanValue());<span class="comment">//è®¾ç½®æ–‡æœ¬æ”¶ç¼©è‡³åˆé€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> headWriteCellStyle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Excelå†…å®¹æ ·å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> WriteCellStyle <span class="title function_">contentWriteCellStyle</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å¤´çš„ç­–ç•¥</span></span><br><span class="line">        <span class="type">WriteCellStyle</span> <span class="variable">headWriteCellStyle</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WriteCellStyle</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å­—ä½“</span></span><br><span class="line">        <span class="type">WriteFont</span> <span class="variable">headWriteFont</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WriteFont</span>();</span><br><span class="line">        headWriteFont.setFontName(<span class="string">&quot;ä»¿å®‹&quot;</span>);<span class="comment">//è®¾ç½®å­—ä½“åå­—</span></span><br><span class="line">        headWriteFont.setFontHeightInPoints((<span class="type">short</span>) <span class="number">14</span>);<span class="comment">//è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">        headWriteFont.setBold(BooleanEnum.FALSE.getBooleanValue());<span class="comment">//å­—ä½“æ˜¯å¦åŠ ç²—</span></span><br><span class="line">        headWriteFont.setColor(IndexedColors.BLACK.index);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ·å¼</span></span><br><span class="line">        headWriteCellStyle.setWriteFont(headWriteFont); <span class="comment">//åœ¨æ ·å¼ç”¨åº”ç”¨è®¾ç½®çš„å­—ä½“æ ·å¼;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// èƒŒæ™¯</span></span><br><span class="line">        headWriteCellStyle.setFillForegroundColor(IndexedColors.WHITE.index);<span class="comment">//èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        headWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);<span class="comment">//èƒŒæ™¯é¢œè‰²å¡«å……ç±»å‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¾¹æ¡†</span></span><br><span class="line">        headWriteCellStyle.setBorderBottom(BorderStyle.THIN);<span class="comment">//è®¾ç½®åº•è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setBottomBorderColor((IndexedColors.BLACK1.index));<span class="comment">//è®¾ç½®åº•è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line">        headWriteCellStyle.setBorderLeft(BorderStyle.THIN);  <span class="comment">//è®¾ç½®å·¦è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setLeftBorderColor(IndexedColors.BLACK1.index);<span class="comment">//è®¾ç½®å·¦è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line">        headWriteCellStyle.setBorderRight(BorderStyle.THIN);<span class="comment">//è®¾ç½®å³è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setRightBorderColor(IndexedColors.BLACK1.index);<span class="comment">//è®¾ç½®å³è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line">        headWriteCellStyle.setBorderTop(BorderStyle.THIN);<span class="comment">//è®¾ç½®é¡¶è¾¹æ¡†;</span></span><br><span class="line">        headWriteCellStyle.setTopBorderColor(IndexedColors.BLACK1.index); <span class="comment">//è®¾ç½®é¡¶è¾¹æ¡†é¢œè‰²;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…¶ä»–</span></span><br><span class="line">        headWriteCellStyle.setWrapped(BooleanEnum.FALSE.getBooleanValue());  <span class="comment">//è®¾ç½®è‡ªåŠ¨æ¢è¡Œ;</span></span><br><span class="line">        headWriteCellStyle.setShrinkToFit(BooleanEnum.FALSE.getBooleanValue());<span class="comment">//è®¾ç½®æ–‡æœ¬æ”¶ç¼©è‡³åˆé€‚</span></span><br><span class="line">        headWriteCellStyle.setHorizontalAlignment(HorizontalAlignment.CENTER);<span class="comment">//è®¾ç½®æ°´å¹³å¯¹é½çš„æ ·å¼ä¸ºå±…ä¸­å¯¹é½;</span></span><br><span class="line">        headWriteCellStyle.setVerticalAlignment(VerticalAlignment.CENTER);  <span class="comment">//è®¾ç½®å‚ç›´å¯¹é½çš„æ ·å¼ä¸ºå±…ä¸­å¯¹é½;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> headWriteCellStyle;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">EasyExcelä½¿ç”¨</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="SpringBoot" scheme="https://www.naste.top:1024/tags/SpringBoot/"/>
    
    <category term="EasyExcel" scheme="https://www.naste.top:1024/tags/EasyExcel/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-å¤–è§‚æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/1868115705.html"/>
    <id>https://www.naste.top:1024/posts/1868115705.html</id>
    <published>2023-06-17T09:48:16.000Z</published>
    <updated>2023-06-27T09:51:15.049Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼</h1><p>å¤–è§‚æ¨¡å¼åˆå«é—¨é¢æ¨¡å¼</p><p>å¤–è§‚æ¨¡å¼ä¹Ÿå«é—¨é¢æ¨¡å¼ï¼Œåœ¨åˆ›å»ºå‹æ¨¡å¼ã€ç»“æ„å‹æ¨¡å¼å’Œè¡Œä¸ºå‹æ¨¡å¼åˆ†ç±»ä¸­ï¼Œå¤–è§‚æ¨¡å¼å½’å±äºç»“æ„å‹æ¨¡å¼</p><p>åœ¨æˆ‘ä»¬å®é™…çš„å·¥ä½œä¸­ï¼Œå¤–è§‚æ¨¡å¼æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ä¹‹ä¸€</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æŠŠå‡ ä¸ªæ–¹æ³•ä¸­å…±ç”¨çš„é€»è¾‘æŠ½è±¡æˆä¸€ä¸ªç‹¬ç«‹çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±å¯ä»¥ç†è§£æˆå¤–è§‚æ¨¡å¼</p><p>å¤–è§‚æ¨¡å¼æ˜¯é€šè¿‡å¼•å…¥ä¸€ä¸ªå¤–è§‚è§’è‰²æ¥ç®€åŒ–è°ƒç”¨è€…ä¸å„ä¸ªå­ç³»ç»Ÿä¹‹é—´çš„äº¤äº’ï¼Œä¸ºå¤æ‚çš„å­ç³»ç»Ÿè°ƒç”¨æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ï¼Œé™ä½å­ç³»ç»Ÿä¸è°ƒç”¨è€…çš„è€¦åˆåº¦ï¼Œä½¿å¾—æ‰©å±•æ›´åŠ æ–¹ä¾¿</p><p><img src="https://www.naste.top:9000/images/v2-70762a5b963aba1dc35447fb3ec87407_1440w.webp" alt="img"></p><p>å¤–è§‚æ¨¡å¼å®ç°æ­¥éª¤ï¼š</p><ol><li>æŠ½è±¡å„ä¸ªå­ç³»ç»Ÿçš„ä¸šåŠ¡é€»è¾‘</li><li>å°†æŠ½è±¡è¿‡çš„ä¸šåŠ¡é€»è¾‘å°è£…åˆ°é—¨é¢ç±»ä¸­</li><li>è°ƒç”¨è€…ä½¿ç”¨é—¨é¢ç±»ä¸­çš„æ–¹æ³•å®Œæˆè‡ªå·±çš„é€»è¾‘</li></ol><h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><ol><li>éœ€è¦ä¸ºä¸€ä¸ªå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ç³»åˆ—é€»è¾‘æ”¯æŒçš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼Œæ¯”å¦‚ï¼Œä¸Šæ–‡ä¸­æåˆ°çš„æ¡ˆä¾‹ã€‚ä¸­å°ç³»ç»Ÿéœ€è¦ç»™ä¸šåŠ¡ç³»ç»Ÿæä¾›å¤šä¸ªæ–¹æ³•æ”¯æŒï¼Œå¯ä»¥ç”¨å¤–è§‚æ¨¡å¼</li><li>å½“è°ƒç”¨è€…éœ€è¦è°ƒç”¨å¤šä¸ªå­ç³»ç»Ÿæ¥å®Œæˆè‡ªå·±çš„é€»è¾‘æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼Œæ¯”å¦‚æ—¥å¿—å¤„ç†æ¡†æ¶ <code>SLF4J</code>ï¼Œå®ƒå¯¹è°ƒç”¨è€…æä¾›æ¥å£ã€‚<code>logback</code>ã€<code>log4j</code>ç­‰å„ç§æ—¥å¿—æ¡†æ¶ä½œä¸ºå­ç³»ç»Ÿå»å®ç°è¿™äº›æ¥å£ï¼Œä¸šåŠ¡ç³»ç»Ÿéœ€è¦è®°å½•æ—¥å¿—æ—¶ï¼Œè°ƒç”¨<code>SLF4J</code>é—¨é¢ç±»å³å¯ï¼Œè€Œä¸å¿…å…³å¿ƒå…·ä½“ä½¿ç”¨çš„æ˜¯å“ªä¸€ä¸ªæ¡†æ¶</li></ol><h1 id="å›¾æ–‡è§£é‡Š"><a href="#å›¾æ–‡è§£é‡Š" class="headerlink" title="å›¾æ–‡è§£é‡Š"></a>å›¾æ–‡è§£é‡Š</h1><p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸­å°ç³»ç»Ÿï¼Œç³»ç»Ÿä¸­æœ‰5ä¸ªæ¥å£ä¾›ä¸šåŠ¡ç³»ç»Ÿè°ƒç”¨</p><p><img src="https://www.naste.top:9000/images/image-20230627164824991.png" alt="image-20230627164824991"></p><p>ä¸šåŠ¡ç³»ç»ŸAéœ€è¦è°ƒç”¨ä¸­å°ç³»ç»Ÿçš„å‰ä¸‰ä¸ªæ¥å£å®Œæˆè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘</p><p>ä¸šåŠ¡ç³»ç»ŸBéœ€è¦è°ƒç”¨ä¸­å°ç³»ç»Ÿçš„åä¸¤ä¸ªæ¥å£æ¥å®Œæˆä¸šåŠ¡ç³»ç»ŸBè‡ªå·±çš„é€»è¾‘</p><p><img src="https://www.naste.top:9000/images/image-20230627164950400.png" alt="image-20230627164950400"></p><p>æ¥ç€æ˜¯ä¸šåŠ¡ç³»ç»ŸCã€Dã€Eã€Fç­‰ç­‰ï¼Œä»–ä»¬éƒ½å’Œä¸šåŠ¡ç³»ç»ŸAæˆ–Bçš„éœ€æ±‚ä¸€æ ·ï¼šå¸Œæœ›è°ƒç”¨ä¸­å°ç³»ç»Ÿçš„å‰ä¸‰ä¸ªæ¥å£æˆ–åä¸¤ä¸ªæ¥å£å»å®ç°è‡ªå·±ç³»ç»Ÿçš„ä¸šåŠ¡é€»è¾‘</p><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™äº›ä¸šåŠ¡ç³»ç»Ÿåœ¨è°ƒç”¨ä¸­å°ç³»ç»Ÿæ—¶å­˜åœ¨å‡ ä¸ªé—®é¢˜</p><ul><li>ä¸šåŠ¡ç³»ç»Ÿéœ€è¦è¶³å¤Ÿäº†è§£ä¸­å°ç³»ç»Ÿçš„æ¯ä¸ªæ¥å£é€»è¾‘ï¼Œæ‰èƒ½å†³å®šè‡ªå·±åˆ°åº•è¯¥è°ƒç”¨å“ªäº›æ¥å£</li><li>ä¸šåŠ¡ç³»ç»Ÿåœ¨è°ƒç”¨ä¸­å°ç³»ç»Ÿæ¥å£æ—¶ï¼Œéœ€è¦è°ƒç”¨å¤šä¸ªæ¥å£ï¼Œéå¸¸éº»çƒ¦</li><li>å¤šä¸ªä¸šåŠ¡ç³»ç»Ÿå­˜åœ¨ç›¸åŒçš„ä»£ç ï¼Œå¯¼è‡´æ•´ä½“å·¥ä½œé‡å¢åŠ </li></ul><p>æˆ‘ä»¬å¯ä»¥è¿™æ ·å¯¹ä¸­å°ç³»ç»Ÿè¿›è¡Œæ”¹é€ ï¼Œè®©ä¸šåŠ¡ç³»ç»Ÿè°ƒç”¨æ›´ç®€å•</p><p><img src="https://www.naste.top:9000/images/image-20230627165113360.png" alt="image-20230627165113360"></p><p>åœ¨ä¸­å°ç³»ç»Ÿä¸­å¢åŠ <strong>æ¥å£A</strong> ï¼Œåœ¨æ¥å£Aé‡Œé¢åˆ†åˆ«åˆ†åˆ«è°ƒç”¨æ¥å£1ã€2ã€3ã€‚ä¸šåŠ¡ç³»ç»ŸAå¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£Aæ¥å®Œæˆè‡ªå·±çš„ä¸šåŠ¡</p><p>åŒæ ·çš„ï¼Œä¸­å°ç³»ç»Ÿä¸­å¢åŠ <strong>æ¥å£B</strong>ï¼Œåœ¨æ¥å£Bä¸­åˆ†åˆ«è°ƒç”¨æ¥å£4ã€5ã€‚ä¸šåŠ¡ç³»ç»ŸBå¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£Bæ¥å®Œæˆè‡ªå·±çš„ä¸šåŠ¡</p><p>è¿™æ ·æˆ‘ä»¬å°±è§£å†³äº†åˆšæ‰æ‰€è¯´çš„3ä¸ªé—®é¢˜</p><ul><li>ä¸šåŠ¡ç³»ç»Ÿä¸éœ€è¦äº†è§£ä¸­å°ç³»ç»Ÿå…·ä½“çš„æ¥å£é€»è¾‘ï¼Œåªéœ€è¦è°ƒç”¨å¯¹åº”çš„æ¥å£å³å¯</li><li>ä¸šåŠ¡ç³»ç»Ÿè°ƒç”¨ä¸­å°ç³»ç»Ÿæ—¶ä¸å†æ˜¯å¤šä¸ªæ¥å£ï¼Œåªéœ€è¦è°ƒç”¨ä¸€ä¸ªæ¥å£</li><li>åŸæ¥çš„å¤šä¸ªä¸šåŠ¡ç³»ç»Ÿä¸­ç›¸åŒçš„ä»£ç è¢«å°è£…åœ¨äº†æ¥å£Aæˆ–æ¥å£Bä¸­ï¼Œä¸šåŠ¡ç³»ç»Ÿç›¸åº”çš„å·¥ä½œé‡ä¼šå‡å°‘</li></ul><p>è¿™ç§å®ç°æ–¹å¼å°±æ˜¯åœ¨ä¸­å°ç³»ç»Ÿä¸­ä½¿ç”¨äº†<strong>å¤–è§‚æ¨¡å¼</strong>ï¼Œæ¥å£Aå’Œæ¥å£Bå°±æ˜¯ä¸­å°ç³»ç»Ÿçš„é—¨é¢ï¼ˆå¤–è§‚æ¨¡å¼ä¹Ÿå«é—¨é¢æ¨¡å¼ï¼‰</p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>é¦–å…ˆæ˜¯ä¸­å°ç³»ç»Ÿçš„5ä¸ªæ¥å£ï¼Œè¿™é‡Œç”¨5ä¸ªæ–¹æ³•ä»£è¡¨æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Center</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span>&#123;&#125; <span class="comment">// æ¨¡æ‹Ÿæ¥å£1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method2</span><span class="params">()</span>&#123;&#125; <span class="comment">// æ¨¡æ‹Ÿæ¥å£2</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method3</span><span class="params">()</span>&#123;&#125; <span class="comment">// æ¨¡æ‹Ÿæ¥å£3</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method4</span><span class="params">()</span>&#123;&#125; <span class="comment">// æ¨¡æ‹Ÿæ¥å£4</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method5</span><span class="params">()</span>&#123;&#125; <span class="comment">// æ¨¡æ‹Ÿæ¥å£5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ˜¯ä¸­å°ç³»ç»Ÿä¸­çš„å¤–è§‚ç±»ï¼Œé‡Œé¢åŒ…å«äº†æ¥å£Aå’Œæ¥å£Bã€‚åŒæ ·ç”¨ä¸¤ä¸ªæ–¹æ³•æ¥ä»£è¡¨æ¥å£</p><p>åœ¨æ¥å£Aä¸­è°ƒç”¨äº†ä¸­å°ç³»ç»Ÿçš„å‰3ä¸ªæ–¹æ³•ï¼›åœ¨æ¥å£Bä¸­è°ƒç”¨äº†ä¸­å°ç³»ç»Ÿä¸­çš„åä¸¤ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CenterFacade</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Center</span> <span class="variable">center</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Center</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿæ¥å£A</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">centerA</span><span class="params">()</span> &#123;</span><br><span class="line">        center.method1();</span><br><span class="line">        center.method2();</span><br><span class="line">        center.method3();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿæ¥å£B</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">centerB</span><span class="params">()</span> &#123;</span><br><span class="line">        center.method4();</span><br><span class="line">        center.method5();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸šåŠ¡ç³»ç»ŸAåœ¨è°ƒç”¨æ—¶ï¼Œä½¿ç”¨å¤–è§‚ç±»ä¸­çš„æ¥å£Aå³å¯å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CenterFacade</span> <span class="variable">centerFacade</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CenterFacade</span>();</span><br><span class="line">centerFacade.centerA();</span><br></pre></td></tr></table></figure><p>ä¸šåŠ¡ç³»ç»ŸBåœ¨è°ƒç”¨æ—¶ï¼Œä½¿ç”¨å¤–è§‚ç±»ä¸­çš„æ¥å£Bå³å¯å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CenterFacade</span> <span class="variable">centerFacade</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CenterFacade</span>();</span><br><span class="line">centerFacade.centerB();</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li><p>ä¼˜ç‚¹</p><ul><li>å¤–è§‚æ¨¡å¼ç»™å„ä¸ªå­ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„å…¥å£ï¼Œè°ƒç”¨è€…ä½¿ç”¨èµ·æ¥å¾ˆç®€å•</li><li>å¤–è§‚æ¨¡å¼æŠŠå„ä¸ªå­ç³»ç»Ÿå’Œè°ƒç”¨è€…è§£è€¦ï¼Œæ‰©å±•æ€§ä¼šæ›´å¥½ã€‚æ¯”å¦‚ï¼Œæƒ³è¦å¢åŠ ä¸€ä¸ªå­ç³»ç»Ÿæ—¶ï¼Œåªéœ€è¦æŒ‰ç…§å¤–è§‚æ¨¡å¼çš„è§„èŒƒè¿›è¡Œå¼€å‘ï¼Œè°ƒç”¨è€…å’Œå¤–è§‚ç±»éƒ½ä¸ç”¨ä¿®æ”¹</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>å¦‚æœè®¾è®¡ä¸åˆç†ï¼Œå¢åŠ æ–°çš„å­ç³»ç»Ÿæ—¶å¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»æˆ–è°ƒç”¨è€…çš„æºä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€</li></ul></li></ul>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-å¤–è§‚æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å¤–è§‚æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/1324173671.html"/>
    <id>https://www.naste.top:1024/posts/1324173671.html</id>
    <published>2023-06-17T09:48:08.000Z</published>
    <updated>2023-06-23T12:24:03.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼</h1><p>è§‚å¯Ÿè€…æ¨¡å¼ä¹Ÿå«å‘å¸ƒè®¢é˜…æ¨¡å¼</p><p>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°</p><p>å½“å¤šä¸ªäººéƒ½å…³æ³¨äº†ä¸€ä¸ªå…¬ä¼—å·æ—¶ï¼Œè¿™ä¸ªå…¬ä¼—å·ä¸€å‘å¸ƒæ–°çš„æ–‡ç« ï¼Œæ‰€æœ‰å…³æ³¨çš„è´¦å·éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯</p><p>è§‚å¯Ÿè€…æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†è§‚å¯Ÿè€…å¯¹è±¡æ³¨å†Œåˆ°ä¸»é¢˜å¯¹è±¡ä¸­ï¼Œå½“ä¸»é¢˜å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡è¿›è¡Œæ›´æ–°ã€‚è¿™ç§è®¾è®¡æ¨¡å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°æ¾è€¦åˆçš„å¯¹è±¡é—´äº¤äº’ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§</p><p>è§‚å¯Ÿè€…æ¨¡å¼åŒ…å«ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼š</p><ol><li>æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰ï¼šå®šä¹‰äº†ä¸€ç§æŠ½è±¡æ¥å£ï¼Œç”¨äºæ·»åŠ ã€åˆ é™¤å’Œé€šçŸ¥è§‚å¯Ÿè€…å¯¹è±¡ã€‚</li><li>å…·ä½“ä¸»é¢˜ï¼ˆConcreteSubjectï¼‰ï¼šå®ç°äº†æŠ½è±¡ä¸»é¢˜æ¥å£ï¼Œç»´æŠ¤äº†ä¸€ç»„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œå¹¶åœ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶é€šçŸ¥å®ƒä»¬ã€‚</li><li>æŠ½è±¡è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ï¼šå®šä¹‰äº†ä¸€ç§æŠ½è±¡æ¥å£ï¼Œç”¨äºæ¥æ”¶ä¸»é¢˜å¯¹è±¡çš„é€šçŸ¥ã€‚</li><li>å…·ä½“è§‚å¯Ÿè€…ï¼ˆConcreteObserverï¼‰ï¼šå®ç°äº†æŠ½è±¡è§‚å¯Ÿè€…æ¥å£ï¼Œå­˜å‚¨ä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶åœ¨æ”¶åˆ°é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±çš„çŠ¶æ€ã€‚</li></ol><h1 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h1><p><img src="https://www.naste.top:9000/images/f6dae790229e48a0ac4bd507dab3f455.png" alt="img"><img src="https://www.naste.top:9000/images/228ff4ace242424ab67c3453870e549b.png" alt="img"></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p><img src="https://www.naste.top:9000/images/observer.jpg" alt="img"></p><h1 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h1><h2 id="è¢«è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…ä¸»é¢˜"><a href="#è¢«è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…ä¸»é¢˜" class="headerlink" title="è¢«è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…ä¸»é¢˜"></a>è¢«è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…ä¸»é¢˜</h2><p>é¦–å…ˆæ˜¯ä¸Šå®˜æ— é›ªè¿™ä¸ªç»¿èŒ¶å©Šçš„ç±»</p><p>å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå¾ˆç®€å•ï¼ŒåŒ…å«ä¸€ä¸ªç”¨æ¥è®¢é˜…çš„æ–¹æ³•<code>add</code>å’Œå–æ¶ˆè®¢é˜…çš„æ–¹æ³•<code>remove</code>ã€‚è¿˜æœ‰ä¸€ä¸ªå½“çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç”¨æ¥é€šçŸ¥å…¶è§‚å¯Ÿè€…çš„æ–¹æ³•<code>notifyState</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">GreenTeaBitchSubject</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(TianDogObserver observer)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(TianDogObserver observer)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">notifyState</span><span class="params">(String state)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ˜¯å…¶å®ç°ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShangGuanSubject</span> <span class="keyword">implements</span> <span class="title class_">GreenTeaBitchSubject</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;TianDogObserver&gt; tianDogs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(TianDogObserver observer)</span> &#123;</span><br><span class="line">        tianDogs.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(TianDogObserver observer)</span> &#123;</span><br><span class="line">        tianDogs.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyState</span><span class="params">(String state)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (TianDogObserver tianDog : tianDogs) &#123;</span><br><span class="line">            tianDog.update(state);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿéå¸¸ç®€å•ï¼Œå…¶æŒæœ‰ä¸€ä¸ªå¯¹å…¶æ„Ÿå…´è¶£çš„è§‚å¯Ÿè€…é›†åˆï¼Œå½“çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶å°±å¾ªç¯é€šçŸ¥æ¯ä¸ªè§‚å¯Ÿè€…ã€‚</p><h2 id="è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…è€…"><a href="#è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…è€…" class="headerlink" title="è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…è€…"></a>è§‚å¯Ÿè€…ï¼Œæˆ–è€…å«è®¢é˜…è€…</h2><p>å…ˆå®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…æ¥å£ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œè§‚å¯Ÿè€…å°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢æ¥æ”¶è¢«è§‚å¯Ÿè€…å‘é€çš„çŠ¶æ€æ”¹å˜é€šçŸ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TianDogObserver</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String message)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å®ç°ä¸€ä¸ªèˆ”ç‹—ç‹äºŒç‹—ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog2WangObserver</span> <span class="keyword">implements</span> <span class="title class_">TianDogObserver</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;è‚šå­å¥½é¥¿&quot;</span>.equals(message))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;äºŒç‹—ï¼šåŠå¤œèµ·æ¥ï¼Œç¿»å¢™å‡ºå»æ­¥è¡Œ2å…¬é‡Œä¹°å¥³ç¥æœ€çˆ±åƒçš„å°ç¬¼åŒ…... ä¸Šå®˜ï¼šäºŒç‹—ï¼Œä½ çœŸæ˜¯ä¸ªå¥½äºº&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;å¿ƒæƒ…ä¸å¥½&quot;</span>.equals(message))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;äºŒç‹—ï¼šå®˜å“­ç€è¿°è¯´æ¸£ç”·æ€ä¹ˆæ¬ºè´Ÿçš„å¥¹...æ•´æ•´3ä¸ªå°æ—¶ï¼Œå…¨ç¨‹å®‰æ…°... ä¸Šå®˜ï¼šäºŒç‹—ï¼Œä½ çœŸæ˜¯ä¸ªå¥½äºº&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;éšå«éšåˆ°...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨updateæ–¹æ³•ä¸­ï¼Œæ¥æ”¶åˆ°å¥³ç¥çš„é€šçŸ¥åï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€åšå‡ºäº†ç›¸åº”çš„åŠ¨ä½œã€‚</p><p>è¥¿é—¨æ·«è¡ç±»å·®ä¸å¤šï¼Œå°±çœç•¥äº†ï¼Œå¯ä»¥ä»æ–‡ç« æœ€åçš„æºç æŸ¥çœ‹â€¦</p><h2 id="å®¢æˆ·ç«¯ä½¿ç”¨"><a href="#å®¢æˆ·ç«¯ä½¿ç”¨" class="headerlink" title="å®¢æˆ·ç«¯ä½¿ç”¨"></a>å®¢æˆ·ç«¯ä½¿ç”¨</h2><p>å®¢æˆ·ç«¯è°ƒç”¨æ—¶ï¼Œå…ˆç»™è¢«è§‚å¯Ÿè€…é€šè¿‡<code>add</code>æ·»åŠ è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯è®©äºŒç‹—å’Œè¥¿é—¨è®¢é˜…ä¸Šå®˜çš„çŠ¶æ€ï¼Œä»¥ä¾¿äºä¸Šå®˜çŠ¶æ€æ”¹å˜æ—¶å¯ä»¥å¾—åˆ°é€šçŸ¥ã€‚æœ€åä½¿ç”¨<code>notifyState</code>æ¥é€šçŸ¥è§‚å¯Ÿè€…çŠ¶æ€æ”¹å˜äº†ã€‚å¦‚æœæŸä¸ªè§‚å¯Ÿè€…ä¸å†å¯¹è¢«è§‚å¯Ÿè€…æ„Ÿå…´è¶£ï¼Œç›´æ¥ä½¿ç”¨<code>remove</code>æ–¹æ³•å–æ¶ˆè®¢é˜…å³å¯ã€‚æœ€åç‹äºŒç‹—è¢«ç»¿èŒ¶å©Šä¸Šå®˜ä¼¤é€äº†å¿ƒï¼Œå’Œç‰›ç¿ åèµ°åˆ°äº†ä¸€èµ·ï¼Œä»æ­¤äºŒç‹—å°±ä¸å†å…³å¿ƒä¸Šå®˜çš„çŠ¶æ€äº†ï¼Œç›´æ¥ä½¿ç”¨<code>remove</code>æ–¹æ³•å–æ¶ˆè®¢é˜…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObserverClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendThink</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">GreenTeaBitchSubject</span> <span class="variable">subject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShangGuanSubject</span>();</span><br><span class="line">        <span class="type">Dog2WangObserver</span> <span class="variable">dog2WangObserver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog2WangObserver</span>();</span><br><span class="line">        subject.add(dog2WangObserver);</span><br><span class="line">        subject.add(<span class="keyword">new</span> <span class="title class_">YinDangObserver</span>());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------åˆå¤œ12ç‚¹ï¼Œè‚šå­å¥½é¥¿ï¼Œæ‰¾ä¸ªäººæ¥ä¹°ä¸œè¥¿åƒ------&quot;</span>);</span><br><span class="line">        subject.notifyState(<span class="string">&quot;è‚šå­å¥½é¥¿&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;------åˆè¢«æ¸£ç”·ç”©äº†ï¼Œæœ‰ç‚¹å°éš¾è¿‡ï¼Œæ‰¾ä¸ªäººæ¥å®‰æ…°ä¸€ä¸‹------&quot;</span>);</span><br><span class="line">        subject.notifyState(<span class="string">&quot;å¿ƒæƒ…ä¸å¥½&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;------äºŒç‹—ç»ˆäºçœ‹é€äº†ä¸Šå®˜è¿™ä¸ªç»¿èŒ¶å©Šï¼Œå’Œç‰›ç¿ èŠ±èµ°åˆ°äº†ä¸€èµ·------&quot;</span>);</span><br><span class="line">        subject.remove(dog2WangObserver);</span><br><span class="line">        System.out.println(<span class="string">&quot;------ä¸Šå®˜åˆè¢«æ¸£ç”·ç”©äº†ï¼Œæƒ³æ‰¾ä¸ªäººæ¥å®‰æ…°ä¸€ä¸‹ï¼Œå´ä¸è§äº†é‚£ä¸ªå¥½äººçš„èº«å½±------&quot;</span>);</span><br><span class="line">        subject.notifyState(<span class="string">&quot;å¿ƒæƒ…ä¸å¥½&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">------åˆå¤œ<span class="number">12</span>ç‚¹ï¼Œè‚šå­å¥½é¥¿ï¼Œæ‰¾ä¸ªäººæ¥ä¹°ä¸œè¥¿åƒ------</span><br><span class="line">äºŒç‹—ï¼šåŠå¤œèµ·æ¥ï¼Œç¿»å¢™å‡ºå»æ­¥è¡Œ<span class="number">2</span>å…¬é‡Œä¹°å¥³ç¥æœ€çˆ±åƒçš„å°ç¬¼åŒ…... ä¸Šå®˜ï¼šäºŒç‹—ï¼Œä½ çœŸæ˜¯ä¸ªå¥½äºº</span><br><span class="line">è¥¿é—¨ï¼šæ˜¯å—ï¼Ÿé‚£æˆ‘ä¸‹é¢ç»™ä½ åƒå•Šï¼Ÿä¸Šå®˜ï¼šè®¨åŒæ‹‰...</span><br><span class="line">------åˆè¢«æ¸£ç”·ç”©äº†ï¼Œæœ‰ç‚¹å°éš¾è¿‡ï¼Œæ‰¾ä¸ªäººæ¥å®‰æ…°ä¸€ä¸‹------</span><br><span class="line">äºŒç‹—ï¼šå®˜å“­ç€è¿°è¯´æ¸£ç”·æ€ä¹ˆæ¬ºè´Ÿçš„å¥¹...æ•´æ•´<span class="number">3</span>ä¸ªå°æ—¶ï¼Œå…¨ç¨‹å®‰æ…°... ä¸Šå®˜ï¼šäºŒç‹—ï¼Œä½ çœŸæ˜¯ä¸ªå¥½äºº</span><br><span class="line">è¥¿é—¨ï¼šå—é—¨é‚£è¾¹æ–°å¼€äº†ä¸€å®¶é…’å§ï¼Œæ™šä¸Šå¸¦ä½ å»æ”¾æ¾ä¸€ä¸‹å§... ä¸Šå®˜ï¼šå¥½å—¨å†ï¼Œæ„Ÿè§‰äººç”Ÿè¾¾åˆ°äº†é«˜å³°..</span><br><span class="line">------äºŒç‹—ç»ˆäºçœ‹é€äº†ä¸Šå®˜è¿™ä¸ªç»¿èŒ¶å©Šï¼Œå’Œç‰›ç¿ èŠ±èµ°åˆ°äº†ä¸€èµ·------</span><br><span class="line">------ä¸Šå®˜åˆè¢«æ¸£ç”·ç”©äº†ï¼Œæƒ³æ‰¾ä¸ªäººæ¥å®‰æ…°ä¸€ä¸‹ï¼Œå´ä¸è§äº†é‚£ä¸ªå¥½äººçš„èº«å½±------</span><br><span class="line">è¥¿é—¨ï¼šå—é—¨é‚£è¾¹æ–°å¼€äº†ä¸€å®¶é…’å§ï¼Œæ™šä¸Šå¸¦ä½ å»æ”¾æ¾ä¸€ä¸‹å§... ä¸Šå®˜ï¼šå¥½å—¨å†ï¼Œæ„Ÿè§‰äººç”Ÿè¾¾åˆ°äº†é«˜å³°..</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è§‚å¯Ÿè€…æ¨¡å¼çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œä¾‹å¦‚åœ¨å„ç§æ¶ˆæ¯ä¸­é—´ä»¶ä¸­ï¼Œå¦‚kafkaã€rabitmqç­‰ï¼Œä¾‹å¦‚RxJava ç­‰ç­‰ã€‚å…¶å®Javaä»1.0å°±å¯¹è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œäº†æ”¯æŒï¼Œæä¾›äº†ä¸¤ä¸ªç±»å‹<code>java.util.Observable</code> å’Œ<code>java.util.Observer</code> ä½†å…¶åœ¨Java9æ—¶å€™è¢«æ ‡è®°ä¸ºåºŸå¼ƒçŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¹Ÿå°±ä¸æäº†ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»çœ‹çœ‹</p><p>å½“å‰ç”±äºå„ç§æ¡†æ¶å’Œç¬¬ä¸‰æ–¹å¼€æºåº“çš„ä½¿ç”¨ï¼Œç¨‹åºè®¾è®¡çš„è¦æ±‚è¢«é™çš„å¾ˆä½ï¼Œå¤§éƒ¨åˆ†äººç»ˆæ—¥éƒ½åœ¨å†™èƒ¶æ°´ä»£ç å’Œä¸šåŠ¡ä»£ç ï¼Œä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Œå‹æ ¹ä¸çŸ¥é“ï¼Œä¸çŸ¥é“ä¹Ÿç…§æ ·å†™ä»£ç â€¦ã€‚è¿™ä¸ªæ˜¯ITäº§ä¸šåŒ–ä¸å¯é€†è½¬çš„è¶‹åŠ¿ï¼Œä¸ç„¶ä¸ºä»€ä¹ˆITä»ä¸šäººå‘˜è¢«åˆ’å½’ä¸ºæ–°å‹æ°‘å·¥çš„è¡Œåˆ—äº†å‘¢ï¼Ÿå°±æ˜¯å› ä¸ºæˆ‘ä»¬æ­£åœ¨å˜æˆå·¥åœ°ä¸ŠæŒ‰ç…§è®¾è®¡å›¾çº¸ä¸€å—ä¸€å—å’ç –çš„å†œæ°‘å·¥çš„æ ·å­ã€‚ä¸è¿‡æˆ‘ä»¬ä¹Ÿä¸åº”è¯¥å¦„è‡ªè²è–„ï¼Œæ¬ç –æ˜¯ä¸ºäº†ç”Ÿæ´»ï¼Œä¸æ–­æ¢å¯»æ˜¯ä¸ºäº†æ¢¦æƒ³â€¦</p>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è§‚å¯Ÿè€…æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-é€‚é…å™¨æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/554442395.html"/>
    <id>https://www.naste.top:1024/posts/554442395.html</id>
    <published>2023-06-17T09:47:59.000Z</published>
    <updated>2023-06-23T12:24:19.589Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼</h1><p>é€‚é…å™¨æ¨¡å¼æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ã€‚å®ƒçš„æ€æƒ³æ˜¯ï¼šæŠŠä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦ä¸€ç§æ¥å£ï¼Œä»è€Œä½¿åŸæœ¬å› æ¥å£ä¸åŒ¹é…è€Œæ— æ³•åœ¨ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»èƒ½å¤Ÿåœ¨ä¸€èµ·å·¥ä½œã€‚</p><p>åœ¨é€‚é…å™¨æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ ä¸€ä¸ªæ–°çš„é€‚é…å™¨ç±»æ¥è§£å†³æ¥å£å…¼å®¹é—®é¢˜ã€‚è¿™ä¸ªæ–°çš„é€‚é…å™¨ç±»ä¼šæŒæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å¯¹è±¡ï¼Œå¹¶ä¸”å°†è¿™äº›ç›®æ ‡å¯¹è±¡è½¬æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸæœ›çš„å¦ä¸€ç§æ¥å£ã€‚</p><h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><ul><li>å½“éœ€è¦ä½¿ç”¨ä¸€ä¸ªç°å­˜çš„ç±»ï¼Œä½†å®ƒæä¾›çš„æ¥å£ä¸æˆ‘ä»¬ç³»ç»Ÿçš„æ¥å£ä¸å…¼å®¹ï¼Œè€Œæˆ‘ä»¬è¿˜ä¸èƒ½ä¿®æ”¹å®ƒæ—¶</li><li>å½“å¤šä¸ªå›¢é˜Ÿç‹¬ç«‹å¼€å‘ç³»ç»Ÿçš„å„åŠŸèƒ½æ¨¡å—ï¼Œç„¶åç»„åˆåœ¨ä¸€èµ·ï¼Œä½†ç”±äºæŸäº›åŸå› äº‹å…ˆä¸èƒ½ç¡®å®šæ¥å£æ—¶</li></ul><h1 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h1><p>é€‚é…å™¨æ¨¡å¼åªæœ‰3ä¸ªè§’è‰²</p><ul><li>Target</li></ul><p>æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒæ˜¯æˆ‘ä»¬å®¢æˆ·ç«¯ä½¿ç”¨çš„ç›®æ ‡æ¥å£</p><ul><li>Adaptee</li></ul><p>æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„æ¥å£ä¸<code>Target</code>ä¸å…¼å®¹çš„ç±»ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»ã€‚</p><ul><li>Adapter</li></ul><p>é€‚é…å™¨ç±»ï¼Œæ­¤æ¨¡å¼çš„æ ¸å¿ƒã€‚å®ƒéœ€è¦å®ç°ç›®æ ‡æ¥å£<code>Target</code>ï¼Œè€Œä¸”å¿…é¡»è¦å¼•ç”¨<code>Adaptee</code>ï¼Œå› ä¸ºæˆ‘ä»¬è¦åœ¨æ­¤ç±»ä¸­åŒ…è£…<code>Adaptee</code>çš„åŠŸèƒ½</p><p><img src="https://www.naste.top:9000/images/image-20230623161718401.png" alt="image-20230623161718401"></p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p><img src="https://www.naste.top:9000/images/adapter.png" alt="img"></p><h2 id="ç›®æ ‡æ¥å£"><a href="#ç›®æ ‡æ¥å£" class="headerlink" title="ç›®æ ‡æ¥å£"></a>ç›®æ ‡æ¥å£</h2><blockquote><p><strong>ç³»ç»ŸåŸæ¥çš„æ—¥å¿—æ¥å£å¦‚ä¸‹</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç³»ç»ŸåŸæ¥çš„æ—¥å¿—æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LogFactory</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">debug</span><span class="params">(String tag,String message)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰æ–¹åº“æ¥å£åŠå®ç°"><a href="#ä¸‰æ–¹åº“æ¥å£åŠå®ç°" class="headerlink" title="ä¸‰æ–¹åº“æ¥å£åŠå®ç°"></a>ä¸‰æ–¹åº“æ¥å£åŠå®ç°</h2><p>ä¸‹é¢æ˜¯ç¬¬ä¸‰æ–¹åº“æä¾›çš„æ—¥å¿—åŠŸèƒ½ï¼Œä½†æ˜¯å…¶æ¥å£ä¸åŸç³»ç»Ÿç›®å‰ä½¿ç”¨çš„ä¸å…¼å®¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–°çš„æ—¥å¿—ç³»ç»Ÿæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">NewLogger</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">newDebug</span><span class="params">(<span class="type">int</span> priority, String message, Object... obj)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–°çš„æ—¥å¿—ç³»ç»Ÿæ¥å£å®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NewLoggerImp</span> <span class="keyword">implements</span> <span class="title class_">NewLogger</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">newDebug</span><span class="params">(<span class="type">int</span> priority, String message, Object... obj)</span> &#123;</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;æ–°çš„æ—¥å¿—ç³»ç»Ÿï¼šloggerè®°å½•:%s&quot;</span>, message));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ„å»ºé€‚é…å™¨ç±»"><a href="#æ„å»ºé€‚é…å™¨ç±»" class="headerlink" title="æ„å»ºé€‚é…å™¨ç±»"></a>æ„å»ºé€‚é…å™¨ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€‚é…å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAdapter</span> <span class="keyword">implements</span> <span class="title class_">LogFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> NewLogger nbLogger;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LogAdapter</span><span class="params">(NewLogger nbLogger)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.nbLogger = nbLogger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®ç°è€çš„æ—¥å¿—æ¥å£ï¼Œå®ç°è€æ—¥å¿—æ¥å£ä¸­çš„æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ä½¿ç”¨æ–°çš„æ—¥å¿—ç³»ç»Ÿè¿›è¡Œæ—¥å¿—æ‰“å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">debug</span><span class="params">(String tag, String message)</span> &#123;</span><br><span class="line">        Objects.requireNonNull(nbLogger);</span><br><span class="line">        nbLogger.newDebug(<span class="number">1</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdapterClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨è€çš„æ—¥å¿—æ¥å£ï¼Œä½†æ˜¯newæ˜¯é€‚é…å™¨ï¼Œå¹¶ä¸”å°†æ–°çš„é€‚é…å™¨ç±»ä¼ å…¥è¿›å»ï¼Œç„¶åè°ƒç”¨çš„æ—¥å¿—æ‰“å°çš„æ–¹æ³•å°±æ˜¯ä¿¡æ¯æ—¥å¿—ç³»ç»Ÿè¿›è¡Œæ‰“å°</span></span><br><span class="line">        <span class="type">LogFactory</span> <span class="variable">logFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LogAdapter</span>(<span class="keyword">new</span> <span class="title class_">NewLoggerImp</span>());</span><br><span class="line">        logFactory.debug(<span class="string">&quot;Test&quot;</span>, <span class="string">&quot;æˆ‘å°†ä½¿ç”¨ç‰›é€¼loggeræ‰“å°log&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230623163404690.png" alt="image-20230623163404690"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¼˜ç‚¹ï¼š</p><ol><li>æé«˜ä»£ç å¤ç”¨æ€§ï¼šé€‚é…å™¨æ¨¡å¼é€šè¿‡å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸæœ›çš„æ¥å£ï¼Œå¯ä»¥è®©åŸæœ¬ä¸å…¼å®¹çš„ç±»èƒ½å¤ŸååŒå·¥ä½œï¼Œä»è€Œæé«˜ä»£ç çš„å¤ç”¨æ€§ã€‚</li><li>æé«˜ç³»ç»Ÿçµæ´»æ€§ï¼šé€‚é…å™¨æ¨¡å¼å¯ä»¥å°†ä¸åŒçš„ç±»çš„æ¥å£ç»Ÿä¸€èµ·æ¥ï¼Œä»è€Œä½¿å¾—ç³»ç»Ÿæ›´åŠ çµæ´»ï¼Œèƒ½å¤Ÿé€‚åº”å„ç§å˜åŒ–ã€‚</li><li>ç¬¦åˆå¼€é—­åŸåˆ™ï¼šé€‚é…å™¨æ¨¡å¼å¯ä»¥åœ¨ä¸ä¿®æ”¹ç°æœ‰ä»£ç çš„æƒ…å†µä¸‹æ·»åŠ æ–°åŠŸèƒ½ï¼Œä»è€Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å¢åŠ ä»£ç å¤æ‚åº¦ï¼šé€‚é…å™¨æ¨¡å¼éœ€è¦å¢åŠ ä¸€ä¸ªé€‚é…å™¨ç±»æ¥å®ç°æ¥å£è½¬æ¢ï¼Œè¿™ä¼šå¢åŠ ä»£ç çš„å¤æ‚åº¦ã€‚</li><li>é™ä½ä»£ç å¯è¯»æ€§ï¼šé€‚é…å™¨æ¨¡å¼å¯èƒ½ä¼šè®©ä»£ç çš„é€»è¾‘å˜å¾—æ›´åŠ å¤æ‚ï¼Œé™ä½ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>å¯èƒ½ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½ï¼šé€‚é…å™¨æ¨¡å¼éœ€è¦è¿›è¡Œé¢å¤–çš„ç±»å‹è½¬æ¢å’Œæ¥å£è½¬æ¢ï¼Œè¿™å¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„æ€§èƒ½ã€‚</li></ol><p>æ€»ä¹‹ï¼Œé€‚é…å™¨æ¨¡å¼æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†ç°æœ‰çš„ä»£ç ä¸å…¶ä»–ä»£ç æˆ–ç³»ç»Ÿé›†æˆèµ·æ¥ï¼Œä»è€Œæé«˜è½¯ä»¶ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨é€‚é…å™¨æ¨¡å¼æ—¶ï¼Œéœ€è¦æƒè¡¡å…¶ä¼˜ç¼ºç‚¹å¹¶è¿›è¡Œé€‚å½“çš„è®¾è®¡å’Œå®ç°ã€‚</p>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-é€‚é…å™¨æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="é€‚é…å™¨æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-è´£ä»»é“¾æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/3066120463.html"/>
    <id>https://www.naste.top:1024/posts/3066120463.html</id>
    <published>2023-06-17T09:46:56.000Z</published>
    <updated>2023-06-18T07:27:36.615Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä¸Šé¢æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼ˆèŒè´£é“¾æ¨¡å¼ï¼‰"><a href="#ä¸Šé¢æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼ˆèŒè´£é“¾æ¨¡å¼ï¼‰" class="headerlink" title="ä¸Šé¢æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼ˆèŒè´£é“¾æ¨¡å¼ï¼‰"></a>ä¸Šé¢æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼ˆèŒè´£é“¾æ¨¡å¼ï¼‰</h1><p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¸¸å¸¸ä¼šå‡ºç°è¿™æ ·çš„äº‹ä¾‹ï¼šä¸€ä¸ªè¯·æ±‚æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†ï¼Œä½†æ¯ä¸ªå¯¹è±¡çš„å¤„ç†æ¡ä»¶æˆ–æƒé™ä¸åŒã€‚ä¾‹å¦‚ï¼Œå…¬å¸å‘˜å·¥è¯·å‡ï¼Œå¯æ‰¹å‡çš„é¢†å¯¼æœ‰éƒ¨é—¨è´Ÿè´£äººã€å‰¯æ€»ç»ç†ã€æ€»ç»ç†ç­‰ï¼Œä½†æ¯ä¸ªé¢†å¯¼èƒ½æ‰¹å‡†çš„å¤©æ•°ä¸åŒï¼Œå‘˜å·¥å¿…é¡»æ ¹æ®è‡ªå·±è¦è¯·å‡çš„å¤©æ•°å»æ‰¾ä¸åŒçš„é¢†å¯¼ç­¾åï¼Œä¹Ÿå°±æ˜¯è¯´å‘˜å·¥å¿…é¡»è®°ä½æ¯ä¸ªé¢†å¯¼çš„å§“åã€ç”µè¯å’Œåœ°å€ç­‰ä¿¡æ¯ï¼Œè¿™å¢åŠ äº†éš¾åº¦ã€‚è¿™æ ·çš„ä¾‹å­è¿˜æœ‰å¾ˆå¤šï¼Œå¦‚æ‰¾é¢†å¯¼å‡ºå·®æŠ¥é”€ã€ç”Ÿæ´»ä¸­çš„â€œå‡»é¼“ä¼ èŠ±â€æ¸¸æˆç­‰ã€‚</p><p>åœ¨è®¡ç®—æœºè½¯ç¡¬ä»¶ä¸­ä¹Ÿæœ‰ç›¸å…³ä¾‹å­ï¼Œå¦‚æ€»çº¿ç½‘ä¸­æ•°æ®æŠ¥ä¼ é€ï¼Œæ¯å°è®¡ç®—æœºæ ¹æ®ç›®æ ‡åœ°å€æ˜¯å¦åŒè‡ªå·±çš„åœ°å€ç›¸åŒæ¥å†³å®šæ˜¯å¦æ¥æ”¶ï¼›è¿˜æœ‰å¼‚å¸¸å¤„ç†ä¸­ï¼Œå¤„ç†ç¨‹åºæ ¹æ®å¼‚å¸¸çš„ç±»å‹å†³å®šè‡ªå·±æ˜¯å¦å¤„ç†è¯¥å¼‚å¸¸ï¼›è¿˜æœ‰ Struts2çš„æ‹¦æˆªå™¨ã€JSPå’ŒServletçš„ Filter ç­‰ï¼Œæ‰€æœ‰è¿™äº›ï¼Œå¦‚æœç”¨è´£ä»»é“¾æ¨¡å¼éƒ½èƒ½å¾ˆå¥½è§£å†³ã€‚</p><p>è´£ä»»é“¾ï¼ˆChain of Responsibilityï¼‰æ¨¡å¼çš„å®šä¹‰ï¼šä¸ºäº†é¿å…è¯·æ±‚å‘é€è€…ä¸å¤šä¸ªè¯·æ±‚å¤„ç†è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œå°†æ‰€æœ‰è¯·æ±‚çš„å¤„ç†è€…é€šè¿‡å‰ä¸€å¯¹è±¡è®°ä½å…¶ä¸‹ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è€Œè¿æˆä¸€æ¡é“¾ï¼›å½“æœ‰è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œå¯å°†è¯·æ±‚æ²¿ç€è¿™æ¡é“¾ä¼ é€’ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><p>åœ¨è´£ä»»é“¾æ¨¡å¼ä¸­ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°è´£ä»»é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ï¼Œæ‰€ä»¥è´£ä»»é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</p><h1 id="è´£ä»»é“¾æ¨¡å¼ç»“æ„"><a href="#è´£ä»»é“¾æ¨¡å¼ç»“æ„" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼ç»“æ„"></a>è´£ä»»é“¾æ¨¡å¼ç»“æ„</h1><p>èŒè´£é“¾æ¨¡å¼ä¸»è¦åŒ…å«ä»¥ä¸‹è§’è‰²ã€‚</p><ol><li>æŠ½è±¡å¤„ç†è€…ï¼ˆHandlerï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼ŒåŒ…å«æŠ½è±¡å¤„ç†æ–¹æ³•å’Œä¸€ä¸ªåç»§è¿æ¥ã€‚</li><li>å…·ä½“å¤„ç†è€…ï¼ˆConcrete Handlerï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡å¤„ç†è€…çš„å¤„ç†æ–¹æ³•ï¼Œåˆ¤æ–­èƒ½å¦å¤„ç†æœ¬æ¬¡è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥å¤„ç†è¯·æ±‚åˆ™å¤„ç†ï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬ç»™å®ƒçš„åç»§è€…ã€‚</li><li>å®¢æˆ·ç±»ï¼ˆClientï¼‰è§’è‰²ï¼šåˆ›å»ºå¤„ç†é“¾ï¼Œå¹¶å‘é“¾å¤´çš„å…·ä½“å¤„ç†è€…å¯¹è±¡æäº¤è¯·æ±‚ï¼Œå®ƒä¸å…³å¿ƒå¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ã€‚</li></ol><p><img src="https://www.naste.top:9000/images/v2-323352bbdc7d89ec9835819fc63e779c_1440w.webp" alt="img"></p><p><img src="https://www.naste.top:9000/images/v2-56e0265703ecd889cb2f4b14a414d5c9_1440w.jpeg" alt="img"></p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>ç”¨è´£ä»»é“¾æ¨¡å¼è®¾è®¡ä¸€ä¸ªè¯·å‡æ¡å®¡æ‰¹æ¨¡å—,<strong>å°†æ‰€æœ‰å…·ä½“å¤„ç†è€…å…¨éƒ¨ç»„æˆä¸€ä¸ªé“¾è·¯ï¼Œè®©ç³»ç»Ÿä¸€è·¯å¾€ä¸‹æ‰¾èƒ½å¤„ç†çš„æ–¹æ³•è¿›è¡Œå¤„ç†</strong>ã€‚</p><p>åˆ†æï¼šå‡å¦‚è§„å®šå­¦ç”Ÿè¯·å‡å°äºæˆ–ç­‰äº 2 å¤©ï¼Œç­ä¸»ä»»å¯ä»¥æ‰¹å‡†ï¼›å°äºæˆ–ç­‰äº 7 å¤©ï¼Œç³»ä¸»ä»»å¯ä»¥æ‰¹å‡†ï¼›å°äºæˆ–ç­‰äº 10 å¤©ï¼Œé™¢é•¿å¯ä»¥æ‰¹å‡†ï¼›å…¶ä»–æƒ…å†µä¸äºˆæ‰¹å‡†ï¼›è¿™ä¸ªå®ä¾‹é€‚åˆä½¿ç”¨èŒè´£é“¾æ¨¡å¼å®ç°ã€‚</p><p>é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªé¢†å¯¼ç±»ï¼ˆLeaderï¼‰ï¼Œå®ƒæ˜¯æŠ½è±¡å¤„ç†è€…ï¼ŒåŒ…å«äº†ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä½é¢†å¯¼çš„æŒ‡é’ˆ next å’Œä¸€ä¸ªå¤„ç†å‡æ¡çš„æŠ½è±¡å¤„ç†æ–¹æ³• handleRequest(int LeaveDays)ï¼›ç„¶åï¼Œå®šä¹‰ç­ä¸»ä»»ç±»ï¼ˆClassAdviserï¼‰ã€ç³»ä¸»ä»»ç±»ï¼ˆDepartmentHeadï¼‰å’Œé™¢é•¿ç±»ï¼ˆDeanï¼‰ï¼Œå®ƒä»¬æ˜¯æŠ½è±¡å¤„ç†è€…çš„å­ç±»ï¼Œæ˜¯å…·ä½“å¤„ç†è€…ï¼Œå¿…é¡»æ ¹æ®è‡ªå·±çš„æƒåŠ›å»å®ç°çˆ¶ç±»çš„ handleRequest(int LeaveDays) æ–¹æ³•ï¼Œå¦‚æœæ— æƒå¤„ç†å°±å°†å‡æ¡äº¤ç»™ä¸‹ä¸€ä½å…·ä½“å¤„ç†è€…ï¼Œç›´åˆ°æœ€åï¼›å®¢æˆ·ç±»è´Ÿè´£åˆ›å»ºå¤„ç†é“¾ï¼Œå¹¶å°†å‡æ¡äº¤ç»™é“¾å¤´çš„å…·ä½“å¤„ç†è€…ï¼ˆç­ä¸»ä»»ï¼‰ã€‚</p><h2 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h2><p><img src="https://www.naste.top:9000/images/v2-21e07beda83e24d59c462b40c0abd15f_1440w.webp" alt="img"></p><p><img src="https://www.naste.top:9000/images/v2-21e07beda83e24d59c462b40c0abd15f_1440w-1687072779373-6.webp" alt="img"></p><h2 id="Leader"><a href="#Leader" class="headerlink" title="Leader"></a>Leader</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡å¤„ç†è€…ï¼šé¢†å¯¼ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Leader</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Leader next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNext</span><span class="params">(Leader next)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Leader <span class="title function_">getNext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¤„ç†è¯·æ±‚çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">handleRequest</span><span class="params">(<span class="type">int</span> LeaveDays)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ClassAdviser"><a href="#ClassAdviser" class="headerlink" title="ClassAdviser"></a>ClassAdviser</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“å¤„ç†è€…1ï¼šç­ä¸»ä»»ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassAdviser</span> <span class="keyword">extends</span> <span class="title class_">Leader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleRequest</span><span class="params">(<span class="type">int</span> LeaveDays)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (LeaveDays &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç­ä¸»ä»»æ‰¹å‡†æ‚¨è¯·å‡&quot;</span> + LeaveDays + <span class="string">&quot;å¤©ã€‚&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getNext() != <span class="literal">null</span>) &#123;</span><br><span class="line">                getNext().handleRequest(LeaveDays);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è¯·å‡å¤©æ•°å¤ªå¤šï¼Œæ²¡æœ‰äººæ‰¹å‡†è¯¥å‡æ¡ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="DepartmentHead"><a href="#DepartmentHead" class="headerlink" title="DepartmentHead"></a>DepartmentHead</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“å¤„ç†è€…2ï¼šç³»ä¸»ä»»ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentHead</span> <span class="keyword">extends</span> <span class="title class_">Leader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleRequest</span><span class="params">(<span class="type">int</span> LeaveDays)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (LeaveDays &lt;= <span class="number">7</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç³»ä¸»ä»»æ‰¹å‡†æ‚¨è¯·å‡&quot;</span> + LeaveDays + <span class="string">&quot;å¤©ã€‚&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getNext() != <span class="literal">null</span>) &#123;</span><br><span class="line">                getNext().handleRequest(LeaveDays);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è¯·å‡å¤©æ•°å¤ªå¤šï¼Œæ²¡æœ‰äººæ‰¹å‡†è¯¥å‡æ¡ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="DeanOfStudies"><a href="#DeanOfStudies" class="headerlink" title="DeanOfStudies"></a>DeanOfStudies</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“å¤„ç†è€…3ï¼šé™¢é•¿ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeanOfStudies</span> <span class="keyword">extends</span> <span class="title class_">Leader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleRequest</span><span class="params">(<span class="type">int</span> LeaveDays)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (LeaveDays &lt;= <span class="number">20</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ•™åŠ¡å¤„é•¿æ‰¹å‡†æ‚¨è¯·å‡&quot;</span> + LeaveDays + <span class="string">&quot;å¤©ã€‚&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getNext() != <span class="literal">null</span>) &#123;</span><br><span class="line">                getNext().handleRequest(LeaveDays);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è¯·å‡å¤©æ•°å¤ªå¤šï¼Œæ²¡æœ‰äººæ‰¹å‡†è¯¥å‡æ¡ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="DeanOfStudies-1"><a href="#DeanOfStudies-1" class="headerlink" title="DeanOfStudies"></a>DeanOfStudies</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“å¤„ç†è€…4ï¼šæ•™åŠ¡å¤„é•¿ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dean</span> <span class="keyword">extends</span> <span class="title class_">Leader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleRequest</span><span class="params">(<span class="type">int</span> LeaveDays)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (LeaveDays &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;é™¢é•¿æ‰¹å‡†æ‚¨è¯·å‡&quot;</span> + LeaveDays + <span class="string">&quot;å¤©ã€‚&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getNext() != <span class="literal">null</span>) &#123;</span><br><span class="line">                getNext().handleRequest(LeaveDays);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è¯·å‡å¤©æ•°å¤ªå¤šï¼Œæ²¡æœ‰äººæ‰¹å‡†è¯¥å‡æ¡ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LeaveApprovalTest"><a href="#LeaveApprovalTest" class="headerlink" title="LeaveApprovalTest"></a>LeaveApprovalTest</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†æ‰€æœ‰å…·ä½“å¤„ç†è€…å…¨éƒ¨ç»„æˆä¸€ä¸ªé“¾è·¯ï¼Œè®©ç³»ç»Ÿä¸€è·¯å¾€ä¸‹æ‰¾èƒ½å¤„ç†çš„æ–¹æ³•è¿›è¡Œå¤„ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LeaveApprovalTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ç»„è£…è´£ä»»é“¾</span></span><br><span class="line">        <span class="type">Leader</span> <span class="variable">teacher1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassAdviser</span>();</span><br><span class="line">        <span class="type">Leader</span> <span class="variable">teacher2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DepartmentHead</span>();</span><br><span class="line">        <span class="type">Leader</span> <span class="variable">teacher3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dean</span>();</span><br><span class="line">        Leader teacher4=<span class="keyword">new</span> <span class="title class_">DeanOfStudies</span>();</span><br><span class="line">        teacher1.setNext(teacher2);</span><br><span class="line">        teacher2.setNext(teacher3);</span><br><span class="line">        teacher3.setNext(teacher4);</span><br><span class="line">        <span class="comment">//æäº¤è¯·æ±‚</span></span><br><span class="line">        teacher1.handleRequest(<span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230618152446117.png" alt="image-20230618152446117"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>ä¼˜ç‚¹<ul><li>é™ä½äº†å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ã€‚è¯¥æ¨¡å¼ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ— é¡»çŸ¥é“åˆ°åº•æ˜¯å“ªä¸€ä¸ªå¯¹è±¡å¤„ç†å…¶è¯·æ±‚ä»¥åŠé“¾çš„ç»“æ„ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…ä¹Ÿæ— é¡»æ‹¥æœ‰å¯¹æ–¹çš„æ˜ç¡®ä¿¡æ¯ã€‚</li><li>å¢å¼ºäº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ã€‚</li><li>å¢å¼ºäº†ç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚å½“å·¥ä½œæµç¨‹å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥åŠ¨æ€åœ°æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œä¹Ÿå¯åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</li><li>è´£ä»»é“¾ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„è¿æ¥ã€‚æ¯ä¸ªå¯¹è±¡åªéœ€ä¿æŒä¸€ä¸ªæŒ‡å‘å…¶åç»§è€…çš„å¼•ç”¨ï¼Œä¸éœ€ä¿æŒå…¶ä»–æ‰€æœ‰å¤„ç†è€…çš„å¼•ç”¨ï¼Œè¿™é¿å…äº†ä½¿ç”¨ä¼—å¤šçš„ if æˆ–è€… ifÂ·Â·Â·else è¯­å¥ã€‚</li><li>è´£ä»»åˆ†æ‹…ã€‚æ¯ä¸ªç±»åªéœ€è¦å¤„ç†è‡ªå·±è¯¥å¤„ç†çš„å·¥ä½œï¼Œä¸è¯¥å¤„ç†çš„ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¯¹è±¡å®Œæˆï¼Œæ˜ç¡®å„ç±»çš„è´£ä»»èŒƒå›´ï¼Œç¬¦åˆç±»çš„å•ä¸€èŒè´£åŸåˆ™ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>ä¸èƒ½ä¿è¯æ¯ä¸ªè¯·æ±‚ä¸€å®šè¢«å¤„ç†ã€‚ç”±äºä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥æ”¶è€…ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´ä¼ åˆ°é“¾çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ã€‚</li><li>å¯¹æ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚çš„å¤„ç†å¯èƒ½æ¶‰åŠå¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ã€‚</li><li>èŒè´£é“¾å»ºç«‹çš„åˆç†æ€§è¦é å®¢æˆ·ç«¯æ¥ä¿è¯ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§ï¼Œå¯èƒ½ä¼šç”±äºèŒè´£é“¾çš„é”™è¯¯è®¾ç½®è€Œå¯¼è‡´ç³»ç»Ÿå‡ºé”™ï¼Œå¦‚å¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚</li></ul></li></ul>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-è´£ä»»é“¾æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è´£ä»»é“¾æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-æ¨¡æ¿æ–¹æ³•æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/759022725.html"/>
    <id>https://www.naste.top:1024/posts/759022725.html</id>
    <published>2023-06-17T09:45:43.000Z</published>
    <updated>2023-06-18T06:45:32.569Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h1><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Method Patternï¼‰ï¼Œåˆå«æ¨¡æ¿æ¨¡å¼(Template Pattern)ï¼Œåœ¨ä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œã€‚</p><p>ç®€å•è¯´ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„ï¼Œå°±å¯ä»¥é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ï¼Œè¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚</p><p>åœ¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­ï¼Œæœ‰ä¸€ä¸ªæŠ½è±¡çˆ¶ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„æ“ä½œï¼Œè¿™äº›æ“ä½œæ˜¯åœ¨ç®—æ³•ä¸­çš„ä¸å˜éƒ¨åˆ†ã€‚ç„¶åï¼Œæ¯ä¸ªå­ç±»éƒ½å®ç°äº†è¿™äº›æ“ä½œä¸­çš„ä¸€äº›æˆ–å…¨éƒ¨ï¼Œä»¥ä¾¿æ ¹æ®éœ€è¦è¿›è¡Œå®šåˆ¶ã€‚åœ¨å­ç±»ä¸­ï¼Œå¯ä»¥ä½¿ç”¨çˆ¶ç±»ä¸­å®šä¹‰çš„æ“ä½œæ¥å®Œæˆç®—æ³•çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥æ·»åŠ è‡ªå·±çš„å®ç°æ¥å®Œæˆå…¶ä»–éƒ¨åˆ†ã€‚</p><h1 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h1><p>å¯¹åŸç†ç±»å›¾çš„è¯´æ˜ï¼š</p><ul><li>AbstractClass æŠ½è±¡ç±»ï¼Œ ç±»ä¸­å®ç°äº†æ¨¡æ¿æ–¹æ³•(template)ï¼Œå®šä¹‰äº†ç®—æ³•çš„éª¨æ¶ï¼Œå…·ä½“å­ç±»éœ€è¦å»å®ç° å…¶å®ƒçš„æŠ½è±¡æ–¹æ³• operation2,3,4</li><li>ConcreteClass å®ç°æŠ½è±¡æ–¹æ³•ï¼Œå‡è®¾æ˜¯operation2,3,4, ä»¥å®Œæˆç®—æ³•ä¸­ç‰¹å®šå­ç±»çš„å…·ä½“ä¸šåŠ¡æ­¥éª¤</li></ul><p><img src="https://www.naste.top:9000/images/image-20230618142251707.png" alt="image-20230618142251707"></p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>ç¼–å†™åˆ¶ä½œè±†æµ†çš„ç¨‹åºï¼Œè¯´æ˜å¦‚ä¸‹ï¼š</p><ul><li>åˆ¶ä½œè±†æµ†çš„æµç¨‹ï¼šé€‰æâ€”&gt;æ·»åŠ é…æ–™â€”&gt;æµ¸æ³¡â€”&gt;æ”¾åˆ°è±†æµ†æœºæ‰“ç¢</li><li>é€šè¿‡æ·»åŠ ä¸åŒçš„é…æ–™ï¼Œå¯ä»¥åˆ¶ä½œå‡ºä¸åŒå£å‘³çš„è±†æµ†</li><li>é€‰æã€æµ¸æ³¡å’Œæ”¾åˆ°è±†æµ†æœºæ‰“ç¢è¿™å‡ ä¸ªæ­¥éª¤å¯¹äºåˆ¶ä½œæ¯ç§å£å‘³çš„è±†æµ†éƒ½æ˜¯ä¸€æ ·çš„</li></ul><blockquote><p><strong>è¯´æ˜ï¼šå› ä¸ºæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œæ¯”è¾ƒç®€å•ï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°è¿™ä¸ªæ–¹æ¡ˆï¼Œå› æ­¤å°±ç›´æ¥ä½¿ç”¨ï¼Œä¸å†ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹æ¡ˆæ¥å¼•å‡ºæ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong></p></blockquote><h2 id="ç±»å›¾-1"><a href="#ç±»å›¾-1" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h2><p><img src="https://www.naste.top:9000/images/image-20230618143104197.png" alt="image-20230618143104197"></p><h2 id="æœªä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•"><a href="#æœªä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•" class="headerlink" title="æœªä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•"></a>æœªä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•</h2><h3 id="SoyaMilk"><a href="#SoyaMilk" class="headerlink" title="SoyaMilk"></a>SoyaMilk</h3><blockquote><p><strong>æŠ½è±¡ç±»ï¼Œæ¨¡æ¿æ–¹æ³•</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡ç±»ï¼Œè¡¨ç¤ºè±†æµ†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SoyaMilk</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ¿æ–¹æ³•ï¼šå¯ä»¥åšæˆfinalï¼Œä¸è®©å­ç±»å»è¦†ç›–</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">make</span><span class="params">()</span> &#123;</span><br><span class="line">        select();</span><br><span class="line">        addCondiment();</span><br><span class="line">        soak();</span><br><span class="line">        beat();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€‰ææ–™</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">select</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©æ–°é²œçš„è±†å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ ä¸åŒçš„é…æ–™ï¼šæŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å…·ä½“å®ç°</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">addCondiment</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æµ¸æ³¡</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">soak</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸‰æ­¥ï¼šè±†å­å’Œé…æ–™å¼€å§‹æµ¸æ³¡3H&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¦¨æ±</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">beat</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬å››æ­¥ï¼šè±†å­å’Œé…æ–™æ”¾å…¥è±†æµ†æœºæ¦¨æ±&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PeanutSoyaMilk"><a href="#PeanutSoyaMilk" class="headerlink" title="PeanutSoyaMilk"></a>PeanutSoyaMilk</h3><blockquote><p><strong>ç»§æ‰¿æŠ½è±¡æ–¹æ³•å’Œé‡å†™æŠ½è±¡æ–¹æ³•ä¸­çš„æ–¹æ³•</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡æ¨¡æ¿æ–¹æ³•é›†æˆå’Œé‡å†™</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PeanutSoyaMilk</span> <span class="keyword">extends</span> <span class="title class_">SoyaMilk</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addCondiment</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬äºŒæ­¥ï¼šåŠ å…¥ä¸Šå¥½çš„èŠ±ç”Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ReadBeanSoyaMilk"><a href="#ReadBeanSoyaMilk" class="headerlink" title="ReadBeanSoyaMilk"></a>ReadBeanSoyaMilk</h3><blockquote><p><strong>ç»§æ‰¿æŠ½è±¡æ–¹æ³•å’Œé‡å†™æŠ½è±¡æ–¹æ³•ä¸­çš„æ–¹æ³•</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡æ¨¡æ¿æ–¹æ³•é›†æˆå’Œé‡å†™</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReadBeanSoyaMilk</span> <span class="keyword">extends</span> <span class="title class_">SoyaMilk</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addCondiment</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬äºŒæ­¥ï¼šåŠ å…¥ä¸Šå¥½çš„çº¢è±†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;=======åˆ¶ä½œçº¢è±†è±†æµ†=======&quot;</span>);</span><br><span class="line">        <span class="type">SoyaMilk</span> <span class="variable">redBeanSoyaMilk</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReadBeanSoyaMilk</span>();</span><br><span class="line">        redBeanSoyaMilk.make();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=======åˆ¶ä½œèŠ±ç”Ÿè±†æµ†=======&quot;</span>);</span><br><span class="line">        <span class="type">SoyaMilk</span> <span class="variable">peanutSoyaMilk</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PeanutSoyaMilk</span>();</span><br><span class="line">        peanutSoyaMilk.make();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230618143758209.png" alt="image-20230618143758209"></p><h2 id="ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•"><a href="#ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•"></a>ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é’©å­æ–¹æ³•</h2><p>åœ¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„çˆ¶ç±»ä¸­ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒé»˜è®¤ä¸åšä»»ä½•äº‹ï¼Œå­ç±»å¯ä»¥è§†æƒ…å†µè¦ä¸è¦è¦†ç›–å®ƒï¼Œè¯¥æ–¹æ³•ç§°ä¸ºâ€œé’©å­â€ã€‚è¿˜æ˜¯ç”¨ä¸Šé¢åšè±†æµ†çš„ä¾‹å­æ¥è®²è§£ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›åˆ¶ä½œçº¯è±†æµ†ï¼Œä¸æ·»åŠ ä»»ä½•çš„é…æ–™ï¼Œè¯·ä½¿ç”¨é’©å­æ–¹æ³•å¯¹å‰é¢çš„æ¨¡æ¿æ–¹æ³•è¿›è¡Œæ”¹é€ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RedBeanSoyaMilk.java/PeanutSoyaMilk.javaåŒä¸Šï¼Œç•¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡ç±»ï¼Œè¡¨ç¤ºè±†æµ†ï¼ŒSoyaMilk</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SoyaMilk</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¨¡æ¿æ–¹æ³•ï¼šå¯ä»¥åšæˆfinalï¼Œä¸è®©å­ç±»å»è¦†ç›–</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">make</span><span class="params">()</span> &#123;</span><br><span class="line">select();</span><br><span class="line"><span class="keyword">if</span>(customerWantCondiment()) &#123;</span><br><span class="line">addCondiment();</span><br><span class="line">&#125;</span><br><span class="line">soak();</span><br><span class="line">beat();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.é€‰ææ–™</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">select</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©æ–°é²œçš„è±†å­&quot;</span>); &#125;</span><br><span class="line"><span class="comment">//2.æ·»åŠ ä¸åŒçš„é…æ–™ï¼šæŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å…·ä½“å®ç°</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">addCondiment</span><span class="params">()</span>;</span><br><span class="line"><span class="comment">//3.æµ¸æ³¡</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">soak</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;ç¬¬ä¸‰æ­¥ï¼šè±†å­å’Œé…æ–™å¼€å§‹æµ¸æ³¡3H&quot;</span>); &#125;</span><br><span class="line"><span class="comment">//4.æ¦¨æ±</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">beat</span><span class="params">()</span> &#123; System.out.println(<span class="string">&quot;ç¬¬å››æ­¥ï¼šè±†å­å’Œé…æ–™æ”¾å…¥è±†æµ†æœºæ¦¨æ±&quot;</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é’©å­æ–¹æ³•ï¼šå†³å®šæ˜¯å¦éœ€è¦æ·»åŠ é…æ–™</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">customerWantCondiment</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//é»˜è®¤æƒ…å†µä¸‹æ˜¯è¦åŠ é…æ–™çš„</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PureSoyaMilk</span> <span class="keyword">extends</span> <span class="title class_">SoyaMilk</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">addCondiment</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">// æ·»åŠ é…æ–™çš„æ–¹æ³• ç©ºå®ç° å³å¯</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">customerWantCondiment</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;=åˆ¶ä½œçº¯è±†æµ†=&quot;</span>);</span><br><span class="line"><span class="type">SoyaMilk</span> <span class="variable">pureSoyMilk</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PureSoyaMilk</span>();</span><br><span class="line">pureSoyMilk.make();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å½“å¤šä¸ªç±»ä¸­ï¼Œæœ‰å¤šä¸ªæ–¹æ³•éƒ½æœ‰ç›¸åŒçš„æ–¹æ³•ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚ä¾‹å¦‚ä¸Šé¢åˆ¶ä½œè±†æµ†çš„è¿‡ç¨‹ï¼Œéƒ½éœ€è¦é€‰æ‹©ææ–™ã€åˆ¶ä½œå·¥å…·ï¼Œåˆ¶ä½œæ—¶é—´ï¼Œè¿™äº›æ­¥éª¤éƒ½æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯åŠ å…¥çš„å…¶ä»–ææ–™ä¸ä¸€è‡´ï¼Œæ­¤æ—¶åŠ å…¥ææ–™çš„æ–¹æ³•å°±éœ€è¦å…·ä½“çš„ç±»å»å®ç°äº†ï¼Œè€Œåˆ¶ä½œçš„æ­¥éª¤é¡ºåºéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ­¤æ—¶ï¼Œåˆ¶ä½œè±†æµ†çš„è¿™ä¸ªæ–¹æ³•å°±æ˜¯æ¨¡æ¿æ–¹æ³•ï¼Œä¸”æ˜¯finalä¸å¯ä»¥è¢«å­ç±»é‡å†™ä¿®æ”¹çš„ã€‚</p><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æé«˜ä»£ç çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ç¼ºç‚¹æ˜¯å¯èƒ½ä¼šå¯¼è‡´ä»£ç å˜å¾—å¤æ‚å’Œéš¾ä»¥ç†è§£</p><ul><li><p>åŸºæœ¬æ€æƒ³æ˜¯ï¼šç®—æ³•åªå­˜åœ¨äºä¸€ä¸ªåœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯åœ¨çˆ¶ç±»ä¸­ï¼Œå®¹æ˜“ä¿®æ”¹ã€‚éœ€è¦ä¿®æ”¹ç®—æ³•æ—¶ï¼Œåªè¦ä¿®æ”¹çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•æˆ–è€…å·²ç»å®ç°çš„æŸäº›æ­¥éª¤ï¼Œå­ç±»å°±ä¼šç»§æ‰¿è¿™äº›ä¿®æ”¹</p></li><li><p>å¥½å¤„ï¼š</p><ul><li><p>å®ç°äº†æœ€å¤§åŒ–ä»£ç å¤ç”¨ã€‚çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•å’Œå·²å®ç°çš„æŸäº›æ­¥éª¤ä¼šè¢«å­ç±»ç»§æ‰¿è€Œç›´æ¥ä½¿ç”¨ï¼›</p></li><li><p>æ—¢ç»Ÿä¸€äº†ç®—æ³•ï¼Œä¹Ÿæä¾›äº†å¾ˆå¤§çš„çµæ´»æ€§ã€‚çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•ç¡®ä¿äº†ç®—æ³•çš„ç»“æ„ä¿æŒä¸å˜ï¼ŒåŒæ—¶ç”±å­ç±»æä¾›éƒ¨åˆ†æ­¥éª¤çš„å®ç°</p></li></ul></li><li>è¯¥æ¨¡å¼çš„ä¸è¶³ä¹‹å¤„ï¼šæ¯ä¸€ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦ä¸€ä¸ªå­ç±»å®ç°ï¼Œå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ åºå¤§</li></ul><blockquote><p><strong>æ³¨æ„ï¼šä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®å­—ï¼Œ é˜²æ­¢å­ç±»é‡å†™æ¨¡æ¿æ–¹æ³•</strong></p></blockquote><ul><li><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li><p>å½“è¦å®Œæˆåœ¨æŸä¸ªè¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹è¦æ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤ ï¼Œè¿™ä¸€ç³»åˆ—çš„æ­¥éª¤åŸºæœ¬ç›¸åŒï¼Œä½†å…¶ä¸ªåˆ«æ­¥éª¤åœ¨å®ç°æ—¶å¯èƒ½ä¸åŒï¼Œé€šå¸¸è€ƒè™‘ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ¥å¤„ç†</p></li><li><p>ç»Ÿè®¡æŸä¸€æ®µä»£ç çš„æ‰§è¡Œæ—¶é—´ä¹Ÿå¯ä»¥ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼šåœ¨å‰é¢æ‰“å°å‡ºä»£ç æ‰§è¡Œå‰çš„æ—¶é—´ï¼Œåé¢å†æ‰“å°å‡ºä»£ç æ‰§è¡Œåçš„æ—¶é—´ï¼Œä¸­é—´éƒ¨åˆ†å°±æ˜¯ä¸åŒçš„æ‰§è¡Œä»£ç </p></li></ul></li></ul>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-æ¨¡æ¿æ–¹æ³•æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="æ¨¡æ¿æ–¹æ³•æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-è¿­ä»£å™¨æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/1151138150.html"/>
    <id>https://www.naste.top:1024/posts/1151138150.html</id>
    <published>2023-06-17T02:05:59.000Z</published>
    <updated>2023-06-17T09:29:33.822Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼</h1><p>è¿­ä»£å™¨æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œèƒ½åœ¨ä¸æš´éœ²é›†åˆåº•å±‚è¡¨ç°å½¢å¼ï¼ˆåˆ—è¡¨ã€æ ˆå’Œæ ‘ç­‰ï¼‰çš„æƒ…å†µä¸‹ä¾¿åˆ©é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ </p><h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><ul><li>å½“éœ€è¦ä¸ºèšåˆå¯¹è±¡æä¾›å¤šç§éå†æ–¹å¼æ—¶</li><li>å½“éœ€è¦ä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ—¶</li></ul><h1 id="è¿­ä»£å™¨è®¾è®¡æ¨¡å¼ç±»å›¾"><a href="#è¿­ä»£å™¨è®¾è®¡æ¨¡å¼ç±»å›¾" class="headerlink" title="è¿­ä»£å™¨è®¾è®¡æ¨¡å¼ç±»å›¾"></a>è¿­ä»£å™¨è®¾è®¡æ¨¡å¼ç±»å›¾</h1><p><img src="https://www.naste.top:9000/images/image-20230617171322142.png" alt="image-20230617171322142"></p><h1 id="è¿­ä»£å™¨ä¸­çš„è§’è‰²"><a href="#è¿­ä»£å™¨ä¸­çš„è§’è‰²" class="headerlink" title="è¿­ä»£å™¨ä¸­çš„è§’è‰²"></a>è¿­ä»£å™¨ä¸­çš„è§’è‰²</h1><ul><li>Iteratorï¼ˆè¿­ä»£å™¨ï¼‰ï¼šè¿™ä¸ªæ¥å£è´Ÿè´£å®šä¹‰æŒ‰é¡ºåºéå†å…ƒç´ çš„æ¥å£ã€‚å…¶ä¸­hasNextè´Ÿè´£åˆ¤æ–­æ˜¯å¦è¿˜å­˜åœ¨ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œnextæ–¹æ³•ç”¨äºè·å–è¯¥å…ƒç´ å¹¶å°†å…ƒç´ æŒ‡é’ˆåç§»ã€‚</li><li>ConcreteIteratorï¼ˆå…·ä½“çš„è¿­ä»£å™¨ï¼‰ï¼šè¯¥ç±»è´Ÿè´£å®ç°Iteratoræ‰€å®šä¹‰çš„æ¥å£ï¼ŒåŒæ—¶åŒ…å«éå†é›†åˆæ‰€å¿…è¦çš„ä¿¡æ¯ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒBookShelfç±»çš„å®ä¾‹ä¿å­˜è‡³bookShelfä¸­ï¼ŒæŒ‡å‘å½“å‰ä¹¦çš„ä¸‹æ ‡ä¿å­˜åœ¨indexä¸­ã€‚</li><li>Aggregateï¼ˆé›†åˆï¼‰ï¼šå®ç°è¯¥æ¥å£çš„ç±»éƒ½éœ€è¦å®ç°è·å–Iteratorçš„æ–¹æ³•</li><li>ConcreteAggregateï¼ˆå…·ä½“çš„é›†åˆï¼‰ï¼šè¯¥ç±»è´Ÿè´£å…·ä½“å®ç°Aggregateæ‰€å®šä¹‰çš„æ–¹æ³•ã€‚åœ¨è¯¥ç¤ºä¾‹ä¸­ç”±BookShelfè´Ÿè´£æ‰¿æ‹…æ­¤åŠŸèƒ½ã€‚</li><li></li></ul><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><h2 id="æœªä½¿ç”¨è¿­ä»£å™¨"><a href="#æœªä½¿ç”¨è¿­ä»£å™¨" class="headerlink" title="æœªä½¿ç”¨è¿­ä»£å™¨"></a>æœªä½¿ç”¨è¿­ä»£å™¨</h2><p>åœ¨Javaä¸­æƒ³è¦éå†ä¸€ä¸ªarrä¸­çš„æ‰€æœ‰å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨forå¾ªç¯æ¥éå†æ•´ä¸ªåˆ—è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; items = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; items.size(); i++) &#123;</span><br><span class="line">    System.out.println(items.get(i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¾ç„¶æ˜¯ä¸€ç§å¾ˆè‡ªç„¶çš„åšæ³•ï¼Œä½†æ˜¯è‹¥æ­¤æ—¶ç”¨äºå­˜å‚¨å…ƒç´ çš„åº•å±‚æ•°æ®ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬å°±éœ€è¦æ ¹æ®ä¸åŒçš„æ•°æ®ç»“æ„å®ç°ä¸åŒçš„éå†æ–¹å¼ã€‚æ­¤æ—¶çš„æˆ‘ä»…ä»…ä½œä¸ºæœåŠ¡çš„è°ƒç”¨è€…ï¼Œè¿™æ˜¾ç„¶ç»™æˆ‘å¸¦æ¥çš„ä¸å¿…è¦çš„è´Ÿæ‹…ã€‚å› ä¸ºæˆ‘åªæ˜¯æƒ³è¦éå†ä¸€éæ‰€æœ‰å…ƒç´ ï¼Œä½†æ˜¯æˆ‘å´éœ€è¦æ·±å…¥äº†è§£æœåŠ¡å¼€å‘è€…æ‰€ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œå¹¶å®ç°ä¸åŒçš„éå†é€»è¾‘ã€‚</p><p>æœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼å¯ä»¥è®©æœåŠ¡å¼€å‘è€…å®ç°ä¸€ä¸ªæ˜“è°ƒç”¨çš„æ¥å£ï¼Œæˆ‘åªéœ€è¦è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±å¯ä»¥å®Œæˆå…ƒç´ çš„éå†ã€‚å°†è¿™ç§æ€æƒ³æŠ½è±¡èµ·æ¥ï¼Œä¾¿å¾—åˆ°äº†è¿­ä»£å™¨æ¨¡å¼ã€‚</p><h2 id="ä½¿ç”¨è¿­ä»£å™¨"><a href="#ä½¿ç”¨è¿­ä»£å™¨" class="headerlink" title="ä½¿ç”¨è¿­ä»£å™¨"></a>ä½¿ç”¨è¿­ä»£å™¨</h2><h3 id="Iteratoræ¥å£"><a href="#Iteratoræ¥å£" class="headerlink" title="Iteratoræ¥å£"></a>Iteratoræ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿­ä»£å™¨æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Iterator</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å½“å‰å…ƒç´ å¹¶å°†å½“å‰ä½ç½®æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> element</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    T <span class="title function_">next</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BookShelfIterator"><a href="#BookShelfIterator" class="headerlink" title="BookShelfIterator"></a>BookShelfIterator</h3><blockquote><p><strong>è¿­ä»£å™¨æ¥å£å®ç°</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookShelfIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;Book&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> BookShelf bookShelf;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookShelfIterator</span><span class="params">(BookShelf bookShelf)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookShelf = bookShelf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bookShelf.getLength() &gt; index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> bookShelf.getBookAt(index);</span><br><span class="line">        index++;</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Aggrate"><a href="#Aggrate" class="headerlink" title="Aggrate"></a>Aggrate</h3><blockquote><p><strong>è·å–è¿­ä»£å™¨</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Aggregate</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–è¿­ä»£å™¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Iterator</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;T&gt; <span class="title function_">getIterator</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BookShelf"><a href="#BookShelf" class="headerlink" title="BookShelf"></a>BookShelf</h3><blockquote><p><strong>è·å–è¿­ä»£å™¨æ¥å£å®ç°å’Œæ·»åŠ é¢å¤–éœ€è¦ä½¿ç”¨çš„æ–¹æ³•</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookShelf</span> <span class="keyword">implements</span> <span class="title class_">Aggregate</span>&lt;Book&gt; &#123;</span><br><span class="line">    List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;Book&gt; <span class="title function_">getIterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BookShelfIterator</span>(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getLength</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.bookList.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">appendBook</span><span class="params">(Book book)</span> &#123;</span><br><span class="line">        bookList.add(book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">getBookAt</span><span class="params">(Integer position)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.bookList.get(position);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Bookç±»"><a href="#Bookç±»" class="headerlink" title="Bookç±»"></a>Bookç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¹¦ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> Double price;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">BookShelf</span> <span class="variable">bookShelf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookShelf</span>();</span><br><span class="line">    bookShelf.appendBook(<span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;æ–‡åŸ&quot;</span>, <span class="number">55.0</span>,<span class="string">&quot;ä½™å&quot;</span>));</span><br><span class="line">    bookShelf.appendBook(<span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;æœºå™¨å­¦ä¹ &quot;</span>, <span class="number">63.0</span>,<span class="string">&quot;å‘¨å¿—å&quot;</span>));</span><br><span class="line">    bookShelf.appendBook(<span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;ç»Ÿè®¡å­¦ä¹ æ–¹æ³•&quot;</span>, <span class="number">82.0</span>,<span class="string">&quot;æèˆª&quot;</span>));</span><br><span class="line"></span><br><span class="line">    Iterator&lt;Book&gt; iterator = bookShelf.getIterator();</span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;book = &quot;</span> + book);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230617171542664.png" alt="image-20230617171542664"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿­ä»£å™¨æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå®ƒè®©ä½ èƒ½åœ¨ä¸æš´éœ²é›†åˆåº•å±‚è¡¨ç°å½¢å¼(åˆ—è¡¨ã€æ ˆå’Œæ ‘ç­‰)çš„æƒ…å†µä¸‹éå†é›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ ã€‚è¿­ä»£å™¨æ¨¡å¼å°†é›†åˆå¯¹è±¡çš„éå†æ“ä½œä»é›†åˆç±»ä¸­æ‹†åˆ†å‡ºæ¥ï¼Œæ”¾åˆ°è¿­ä»£å™¨ç±»ä¸­ï¼Œè®©ä¸¤è€…çš„èŒè´£æ›´åŠ å•ä¸€ã€‚</p><p>è¿­ä»£å™¨æ¨¡å¼çš„ä¸»è¦æ€æƒ³æ˜¯å°†é›†åˆçš„éå†è¡Œä¸ºæŠ½å–ä¸ºå•ç‹¬çš„è¿­ä»£å™¨å¯¹è±¡ã€‚é™¤å®ç°è‡ªèº«ç®—æ³•å¤–ï¼Œè¿­ä»£å™¨è¿˜å°è£…äº†éå†æ“ä½œçš„æ‰€æœ‰ç»†èŠ‚ï¼Œæ¯”å¦‚å½“å‰ä½ç½®å’Œæœ«å°¾å‰©ä½™å…ƒç´ çš„æ•°é‡ã€åŒæ—¶è¿˜æœ‰æä¾›ä¸€ä¸ªè·å–é›†åˆå…ƒç´ çš„åŸºæœ¬æ–¹æ³•ã€‚å®¢æˆ·ç«¯å¯ä¸æ–­è°ƒç”¨è¯¥æ–¹æ³•ç›´åˆ°å®ƒä¸è¿”å›ä»»ä½•å†…å®¹ ( å·²éå†æ‰€æœ‰å…ƒç´  )ã€æ‰€æœ‰è¿­ä»£å™¨å¿…é¡»å®ç°ç›¸åŒçš„æ¥å£ (åªè¦æœ‰åˆé€‚çš„è¿­ä»£å™¨ï¼Œå®¢æˆ·ç«¯ä»£ç å°±èƒ½å…¼å®¹ä»»ä½•ç±»å‹çš„é›†åˆæˆ–éå†ç®—æ³•)ã€‚</p>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-è¿­ä»£å™¨æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è¿­ä»£å™¨æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Navicaté‡ç½®è¯•ç”¨æ—¶é—´</title>
    <link href="https://www.naste.top:1024/posts/1384618004.html"/>
    <id>https://www.naste.top:1024/posts/1384618004.html</id>
    <published>2023-06-07T08:17:31.000Z</published>
    <updated>2023-06-07T12:46:57.571Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="åˆ›å»ºæ¸…ç†è¯•ç”¨ä¿¡æ¯bat"><a href="#åˆ›å»ºæ¸…ç†è¯•ç”¨ä¿¡æ¯bat" class="headerlink" title="åˆ›å»ºæ¸…ç†è¯•ç”¨ä¿¡æ¯bat"></a>åˆ›å»ºæ¸…ç†è¯•ç”¨ä¿¡æ¯bat</h1><blockquote><p><strong>åˆ›å»ºåç¼€ä¸º<code>.bat</code>æ ¼å¼æ–‡ä»¶</strong></p></blockquote><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Delete HKEY_CURRENT_USER\Software\PremiumSoft\NavicatPremium\Registration[version and language]</span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (&#x27;&quot;REG QUERY &quot;HKEY_CURRENT_USER\Software\PremiumSoft\NavicatPremium&quot; /s | <span class="built_in">findstr</span> /L Registration&quot;&#x27;) <span class="keyword">do</span> (</span><br><span class="line">    reg delete <span class="variable">%%i</span> /va /f</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Delete Info folder under HKEY_CURRENT_USER\Software\Classes\CLSID</span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (&#x27;&quot;REG QUERY &quot;HKEY_CURRENT_USER\Software\Classes\CLSID&quot; /s | <span class="built_in">findstr</span> /E Info&quot;&#x27;) <span class="keyword">do</span> (</span><br><span class="line">    reg delete <span class="variable">%%i</span> /va /f</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Finish</span><br><span class="line"></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Navicaté‡ç½®è¯•ç”¨æ—¶é—´</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/709379917.html"/>
    <id>https://www.naste.top:1024/posts/709379917.html</id>
    <published>2023-06-07T07:55:57.000Z</published>
    <updated>2023-06-08T13:14:00.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/143101326">https://zhuanlan.zhihu.com/p/143101326</a></li><li><a href="https://zhuanlan.zhihu.com/p/58093669">https://zhuanlan.zhihu.com/p/58093669</a></li></ul><h1 id="ä»€ä¹ˆæ˜¯å»ºé€ è€…æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯å»ºé€ è€…æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯å»ºé€ è€…æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯å»ºé€ è€…æ¨¡å¼</h1><p>å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå¯ä»¥å°†å¯¹è±¡çš„æ„å»ºä¸è¡¨ç¤ºåˆ†ç¦»å¼€æ¥ï¼Œä»¥ä¾¿ç›¸åŒçš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºå½¢å¼ã€‚å®ƒå…è®¸æ‚¨åˆ›å»ºå¤æ‚çš„å¯¹è±¡ï¼ŒåŒæ—¶å¯¹å…¶æ„å»ºè¿‡ç¨‹è¿›è¡Œç»†ç²’åº¦çš„æ§åˆ¶ã€‚</p><p>åœ¨è¯¥æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªDirectorå¯¹è±¡è´Ÿè´£æ ¹æ®ç”¨æˆ·è¾“å…¥æŒ‡ç¤ºç”Ÿæˆæ­£ç¡®çš„äº§å“ã€‚è¯¥æ¨¡å¼é€šå¸¸ç”¨äºå¤„ç†å¤æ‚çš„å¯¹è±¡ï¼Œä¾‹å¦‚åŒ…å«å¤šä¸ªå­ç»„ä»¶ä»¥åŠéœ€è¦æ‰§è¡Œè®¸å¤šæ­¥éª¤çš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼æ ¹æ®å»ºé€ è¿‡ç¨‹ä¸åŒåˆ†ä¸ºæ ‡å‡†å»ºé€ è€…æ¨¡å¼å’Œæµå¼å»ºé€ è€…æ¨¡å¼ã€‚åœ¨æ ‡å‡†å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šä¸ªæ–¹æ³•æ¥è®¾ç½®å»ºé€ æ­¥éª¤ï¼Œåœ¨æµå¼å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ç°é“¾å¼è°ƒç”¨çš„å•ä¸ªæ–¹æ³•æ¥è®¾ç½®æ­¥éª¤ã€‚</p><h2 id="å››ä¸ªè§’è‰²"><a href="#å››ä¸ªè§’è‰²" class="headerlink" title="å››ä¸ªè§’è‰²"></a>å››ä¸ªè§’è‰²</h2><p><img src="https://www.naste.top:9000/images/image-20230608205738300.png" alt="image-20230608205738300"></p><p><strong>Productï¼ˆäº§å“è§’è‰²ï¼‰ï¼š</strong> ä¸€ä¸ªå…·ä½“çš„äº§å“å¯¹è±¡ã€‚</p><p><strong>Builderï¼ˆæŠ½è±¡å»ºé€ è€…ï¼‰ï¼š</strong> åˆ›å»ºä¸€ä¸ªProductå¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šçš„æŠ½è±¡æ¥å£ã€‚</p><p><strong>ConcreteBuilderï¼ˆå…·ä½“å»ºé€ è€…ï¼‰ï¼š</strong> å®ç°æŠ½è±¡æ¥å£ï¼Œæ„å»ºå’Œè£…é…å„ä¸ªéƒ¨ä»¶ã€‚</p><p><strong>Directorï¼ˆæŒ‡æŒ¥è€…ï¼‰ï¼š</strong> æ„å»ºä¸€ä¸ªä½¿ç”¨Builderæ¥å£çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ˜¯ï¼šéš”ç¦»äº†å®¢æˆ·ä¸å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ï¼ŒäºŒæ˜¯ï¼šè´Ÿè´£æ§åˆ¶äº§å“å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ã€‚</p><blockquote><p>æ‹¿å…¶ä¸­ä¸¤ä¸ªå¥—é¤ä¸¾ä¾‹</p><p>å¥—é¤A:æ±‰å ¡ï¼Œè–¯æ¡ï¼Œå¤§é¸¡è…¿<br>å¥—é¤B:æ±‰å ¡ï¼Œè–¯æ¡ï¼Œå°é¸¡è…¿ï¼Œå°å¯ä¹ï¼Œå°æŠ«è¨</p><p>å…¶ä¸­è–¯æ¡å’Œæ±‰å ¡å¯å¤§å¯å°ï¼Œå¹¶ä¸”å¿…é¡»æœ‰ï¼Œ<br>å…¶å®ƒçš„éƒ½ä¸ºå›ºå®šå¤§å°ï¼Œä½†æ˜¯ä½ å¯ä»¥é€‰æ‹©æœ‰æˆ–æ²¡æœ‰</p></blockquote><h1 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h1><blockquote><p><strong>å½“ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°å‚æ•°ä¸ªæ•°è¶…è¿‡4ä¸ªï¼Œè€Œä¸”è¿™äº›å‚æ•°æœ‰äº›æ˜¯å¯é€‰çš„å‚æ•°ï¼Œè€ƒè™‘ä½¿ç”¨æ„é€ è€…æ¨¡å¼</strong></p></blockquote><p>è¿™ä¸ªå°±éå¸¸é‡è¦äº†ï¼Œå› ä¸ºå¦‚æœä½ å­¦äº†ä¸ªä¸œè¥¿ï¼Œéƒ½ä¸çŸ¥é“ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œä½ è¯´æœ‰ä»€ä¹ˆç”¨ï¼Ÿç†è§£ä½¿ç”¨åœºæ™¯çš„çš„é‡è¦æ€§è¦è¿œé«˜äºä½ æ˜¯ä¸æ˜¯ä¼šå®ç°è¿™ä¸ªæ¨¡å¼ï¼Œå› ä¸ºåªè¦ä½ çŸ¥é“ä»€ä¹ˆé—®é¢˜å¯ä»¥ä½¿ç”¨builderæ¨¡å¼æ¥è§£å†³ï¼Œé‚£ä½ å³ä½¿ä¸ä¼šå†™ï¼Œä¹Ÿå¯ä»¥åœ¨è°ƒæŸ¥ç›¸å…³èµ„æ–™åå®Œæˆã€‚<br>æˆ‘ä¸æƒ³è¯´ä¸€äº›å¤§è€Œæ­£ç¡®çš„æœ¯è¯­æ¥æŠŠä½ æè’™ï¼Œæˆ‘ä»¬åªé’ˆå¯¹å…·ä½“çš„é—®é¢˜ï¼Œè‡³äºå»¶å±•æ€§çš„æ€è€ƒï¼Œéšç€ä½ çŸ¥è¯†çš„å¢é•¿ï¼Œé€æ¸ä¼šæ˜ç™½çš„ã€‚</p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>KFCå¥—é¤æ¡ˆä¾‹ï¼šå‡å¦‚ç›®å‰KFCé‡Œé¢æœ‰å¾ˆå¤šä¸ªå¥—é¤</p><ul><li>åœ¨å¥—é¤é‡Œé¢æœ‰å¿…ç‚¹ï¼Œä¹Ÿæœ‰é€‰ç‚¹ï¼Œç„¶åæ¯ä¸ªå•å“åˆæœ‰å¤§å°ä¹‹åˆ†</li><li>å¿…ç‚¹ï¼šæ±‰å ¡ï¼ˆhamburgerï¼‰ï¼Œè–¯æ¡ï¼ˆchipsï¼‰</li><li>é€‰ç‚¹ï¼šé¸¡è…¿ï¼ˆchickenï¼‰ï¼Œå¯ä¹ï¼ˆcolaï¼‰ï¼ŒæŠ«è¨ï¼ˆpizzaï¼‰</li></ul><p>æˆ‘ä»¬å¦‚ä½•æ„æˆè¿™ä¹ˆå¤šå¥—é¤å®ä¾‹å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ä¸ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ä¹Ÿèƒ½æ„å»ºä»£ç ï¼Œä½†æ˜¯å»ºé€ è€…æ¨¡å¼ä¼šè®©ä»£ç çœ‹ä¸Šå»æ›´è£…é€¼ï¼Œä»£ç åˆ°åæœŸæ›´ç»“æ„åŒ–æ›´å®¹æ˜“ç»´æŠ¤å’Œæ‹“å±•</p><p>é¦–å…ˆæ„å»ºè¿™ä¸ªå®ä½“ç±»`KFC</p><h2 id="å®ä½“ç±»KFC"><a href="#å®ä½“ç±»KFC" class="headerlink" title="å®ä½“ç±»KFC"></a>å®ä½“ç±»KFC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ä½“ç±»`KFC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KFC</span> &#123;</span><br><span class="line">    <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String hamburger;</span><br><span class="line">    <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String chicken;</span><br><span class="line">    <span class="keyword">private</span> String cola;</span><br><span class="line">    <span class="keyword">private</span> String pizza;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="éå»ºé€ è€…æ¨¡å¼ä»£ç "><a href="#éå»ºé€ è€…æ¨¡å¼ä»£ç " class="headerlink" title="éå»ºé€ è€…æ¨¡å¼ä»£ç "></a>éå»ºé€ è€…æ¨¡å¼ä»£ç </h2><p>æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ä¸æ˜¯æŠ˜å æ„é€ å‡½æ•°æ¥åˆ›å»ºå®ä¾‹ï¼Œä¸‹é¢æ¥å°è¯•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ä½“ç±»`KFC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KFC</span> &#123;</span><br><span class="line">    <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String hamburger;</span><br><span class="line">    <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String chicken;</span><br><span class="line">    <span class="keyword">private</span> String cola;</span><br><span class="line">    <span class="keyword">private</span> String pizza;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¿…ç‚¹å¥—é¤A</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger, String chips)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(hamburger, chips, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤B</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger, String chips, String chicken)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(hamburger, chips, chicken, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤C</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger, String chips, String chicken, String cola)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(hamburger, chips, chicken, cola, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//......è¿˜æœ‰å¥½å¤šç§ç»„åˆæ–¹å¼ï¼Œä½ ä¼šå‘ç°ä½¿ç”¨æŠ˜å æ„é€ å‡½æ•°çš„æ–¹æ³•ååˆ†å¤æ‚</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…¨é€‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger, String chips, String chicken, String cola, String pizza)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hamburger = hamburger;</span><br><span class="line">        <span class="built_in">this</span>.chips = chips;</span><br><span class="line">        <span class="built_in">this</span>.chicken = chicken;</span><br><span class="line">        <span class="built_in">this</span>.cola = cola;</span><br><span class="line">        <span class="built_in">this</span>.pizza = pizza;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°ä½¿ç”¨æŠ˜å æ„é€ å‡½æ•°çš„æ–¹å¼å¾ˆå¤æ‚ï¼Œå¾ˆæ¶å¿ƒï¼Œä»£ç çœ‹éƒ½ä¸æƒ³çœ‹</p><p>é‚£ä¹ˆæœ‰äººä¼šæƒ³ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨<code>set</code>æ–¹æ³•æ¥åˆ›å»ºï¼Œæˆ‘åªè¦ä¸€ä¸ªå¿…ç‚¹æ„é€ å°±å¥½äº†ï¼Œé‚£ç»§ç»­æ¨¡æ‹Ÿå’¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ä½“ç±»`KFC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KFC</span> &#123;</span><br><span class="line">    <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String hamburger;</span><br><span class="line">    <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String chicken;</span><br><span class="line">    <span class="keyword">private</span> String cola;</span><br><span class="line">    <span class="keyword">private</span> String pizza;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger, String chips)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hamburger = hamburger;</span><br><span class="line">        <span class="built_in">this</span>.chips = chips;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//setæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">(String chicken)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.chicken = chicken;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">(String cola)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cola = cola;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">(String pizza)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pizza = pizza;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–å¯¹è±¡ï¼Œä½ ä¼šå‘ç°è¿™ç§æ–¹å¼å°±å‹å¥½å¾ˆå¤š</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">KFC</span> <span class="variable">kfc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KFC</span>(<span class="string">&quot;å¤§æ±‰å ¡&quot;</span>, <span class="string">&quot;å¤§è–¯æ¡&quot;</span>);</span><br><span class="line">        <span class="comment">//åŠ å°ä»½å¯ä¹</span></span><br><span class="line">        kfc.setCola(<span class="string">&quot;å°å¯ä¹&quot;</span>);</span><br><span class="line">        <span class="comment">//åŠ ä¸ªé¸¡è…¿</span></span><br><span class="line">        kfc.setChicken(<span class="string">&quot;å¤§é¸¡è…¿&quot;</span>);</span><br><span class="line">        System.out.println(kfc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°ä½¿ç”¨<code>set</code>æ–¹å¼å°±å‹å¥½äº†å¾ˆå¤š</p><p>è¿™ä¸ªè™½ç„¶å‹å¥½äº†å¾ˆå¤šï¼Œä½†æ˜¯ä¹Ÿæœ‰ç‚¹å°æ¯›ç—…ï¼Œå°±æ˜¯ä½ <strong>setå¤ªéšæ„äº†ï¼Œæˆ‘å¯èƒ½è¿™ä¸ªå¥—é¤é‡Œé¢æ²¡æœ‰è¿™ä¸ªå•å“ï¼Œè€Œä½¿ç”¨setçš„äººå´ä¸çŸ¥é“</strong>ï¼Œé€ æˆé”™è¯¯çš„å¥—é¤å‡ºç°ï¼ã€‚</p><p>ä¸ºäº†è§£å†³ä¸Šé¢çš„ä¸¤ç§é—®é¢˜ï¼šä¸€ç§è®¾è®¡æ¨¡å¼è§£å†³ä¸€ç±»é—®é¢˜ï¼Œæ‰€ä»¥<strong>å»ºé€ è€…æ¨¡å¼</strong>å°±å‡ºç°äº†</p><h2 id="å»ºé€ è€…æ¨¡å¼ä»£ç "><a href="#å»ºé€ è€…æ¨¡å¼ä»£ç " class="headerlink" title="å»ºé€ è€…æ¨¡å¼ä»£ç "></a>å»ºé€ è€…æ¨¡å¼ä»£ç </h2><h3 id="äº§å“"><a href="#äº§å“" class="headerlink" title="äº§å“"></a>äº§å“</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * KFCäº§å“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KFC</span> &#123;</span><br><span class="line">    <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String hamburger;</span><br><span class="line">    <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String chicken;</span><br><span class="line">    <span class="keyword">private</span> String cola;</span><br><span class="line">    <span class="keyword">private</span> String pizza;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger, String chips)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hamburger = hamburger;</span><br><span class="line">        <span class="built_in">this</span>.chips = chips;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//setæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">(String chicken)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.chicken = chicken;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">(String cola)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cola = cola;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">(String pizza)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pizza = pizza;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;KFC&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;hamburger=&#x27;&quot;</span> + hamburger + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, chips=&#x27;&quot;</span> + chips + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, chicken=&#x27;&quot;</span> + chicken + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, cola=&#x27;&quot;</span> + cola + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, pizza=&#x27;&quot;</span> + pizza + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Builder"><a href="#Builder" class="headerlink" title="Builder"></a>Builder</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè¡¨æ˜éœ€è¦å»ºé€ ä»€ä¹ˆï¼Œå¾—åˆ°ä»€ä¹ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    KFC <span class="title function_">getKFC</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¥—é¤A"><a href="#å¥—é¤A" class="headerlink" title="å¥—é¤A"></a>å¥—é¤A</h3><p>æ­¤æ—¶åº”è¯¥æ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™è¿˜æ²¡æœ‰ç”Ÿäº§å¥—é¤ï¼Œåªæ˜¯å®šä¹‰å¥—é¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¥—é¤A</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteBuilder1</span> <span class="keyword">implements</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> KFC kfc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™ä¸€æ­¥éå¸¸é‡è¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConcreteBuilder1</span><span class="params">(String hamburger, String chips)</span> &#123;</span><br><span class="line">        kfc = <span class="keyword">new</span> <span class="title class_">KFC</span>(hamburger, chips);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setChicken(<span class="string">&quot;å¤§é¸¡è…¿&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setCola(<span class="literal">null</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥—é¤Aé‡Œé¢æ²¡æœ‰å¯ä¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setPizza(<span class="literal">null</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥—é¤Aé‡Œé¢æ²¡æœ‰æŠ«è¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> KFC <span class="title function_">getKFC</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> kfc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¥—é¤B"><a href="#å¥—é¤B" class="headerlink" title="å¥—é¤B"></a>å¥—é¤B</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¥—é¤B</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteBuilder2</span> <span class="keyword">implements</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> KFC kfc;</span><br><span class="line">    <span class="comment">//è¿™ä¸€æ­¥éå¸¸é‡è¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConcreteBuilder2</span><span class="params">(String hamburger,String chips)</span>&#123;</span><br><span class="line">        kfc = <span class="keyword">new</span> <span class="title class_">KFC</span>(hamburger,chips);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setChicken(<span class="string">&quot;å°é¸¡è…¿&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setCola(<span class="string">&quot;å°å¯ä¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setPizza(<span class="string">&quot;å°æŠ«è¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> KFC <span class="title function_">getKFC</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> kfc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Director"><a href="#Director" class="headerlink" title="Director"></a>Director</h3><blockquote><p><strong>çœŸæ­£çš„æ‰§è¡Œè€…ï¼Œè¿™é‡ŒæŠŠä»–å½“ä½œæœåŠ¡å‘˜ï¼Œæ­¤æ—¶ä½ åƒæœåŠ¡å‘˜ç‚¹é¤</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè¡¨æ˜éœ€è¦å»ºé€ ä»€ä¹ˆï¼Œå¾—åˆ°ä»€ä¹ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    KFC <span class="title function_">getKFC</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuilderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//å¥—é¤A</span></span><br><span class="line">        System.out.println(<span class="string">&quot;======å¥—é¤A======&quot;</span>);</span><br><span class="line">        <span class="type">Builder</span> <span class="variable">concreteBuilder1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteBuilder1</span>(<span class="string">&quot;å¤§æ±‰å ¡&quot;</span>, <span class="string">&quot;å°è–¯æ¡&quot;</span>);</span><br><span class="line">        <span class="type">KFC</span> <span class="variable">kfc1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Director</span>().build(concreteBuilder1);</span><br><span class="line">        System.out.println(kfc1);</span><br><span class="line">        <span class="comment">//å¥—é¤B</span></span><br><span class="line">        System.out.println(<span class="string">&quot;======å¥—é¤B======&quot;</span>);</span><br><span class="line">        <span class="type">Builder</span> <span class="variable">concreteBuilder2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteBuilder2</span>(<span class="string">&quot;å°æ±‰å ¡&quot;</span>, <span class="string">&quot;å°è–¯æ¡&quot;</span>);</span><br><span class="line">        <span class="type">KFC</span> <span class="variable">kfc2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Director</span>().build(concreteBuilder2);</span><br><span class="line">        System.out.println(kfc2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230608210618559.png" alt="image-20230608210618559"></p><p>åˆ°äº†è¿™é‡Œä½ è¿˜æ˜¯ä¼šè§‰å¾—æœ‰ç‚¹éº»çƒ¦ï¼Œä½ ä¼šå‘ç°ï¼Œå•å“å¯æœ‰å¯æ— çš„é€‰æ‹©ä¸Šé¢ä½ ååˆ†çš„è¢«åŠ¨ï¼Œä»£ç çœ‹ä¸Šå»ä¹Ÿå¾ˆæ€ªï¼Œå¦‚æœä½ ä¸‹æ¬¡æƒ³å…¨éƒ¨å•å“å…ˆé€‰ä¸Šï¼Œå†å»é€‰å¥—é¤çš„æ—¶å€™ï¼Œä½ åˆè¦æ–°å»ºä¸€ä¸ªæ–°çš„æŒ‡å¯¼è€…ã€‚</p><p>æˆ‘è§‰å¾—æ™®é€šçš„å»ºé€ è€…æ¨¡å¼ä¸é€‚åˆå‚æ•°çš„å¯æœ‰å¯æ— çš„é€‰æ‹©ï¼Œ<strong>æ™®é€šçš„å»ºé€ è€…æ¨¡å¼æ›´ä¾§é‡è°ƒæ§æ¬¡åº</strong>ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹éœ€è¦ç®€åŒ–ç³»ç»Ÿç»“æ„</p><h2 id="ç®€åŒ–ç‰ˆçš„å»ºé€ è€…æ¨¡å¼"><a href="#ç®€åŒ–ç‰ˆçš„å»ºé€ è€…æ¨¡å¼" class="headerlink" title="ç®€åŒ–ç‰ˆçš„å»ºé€ è€…æ¨¡å¼"></a>ç®€åŒ–ç‰ˆçš„å»ºé€ è€…æ¨¡å¼</h2><h3 id="é‡‡ç”¨é“¾å¼ç¼–ç¨‹çš„æ–¹å¼"><a href="#é‡‡ç”¨é“¾å¼ç¼–ç¨‹çš„æ–¹å¼" class="headerlink" title="é‡‡ç”¨é“¾å¼ç¼–ç¨‹çš„æ–¹å¼"></a>é‡‡ç”¨é“¾å¼ç¼–ç¨‹çš„æ–¹å¼</h3><p>è¿™ç§æ¨¡å¼æ›´åŠ çµæ´»ï¼Œæ›´åŠ ç¬¦åˆå®šä¹‰</p><p>æ—¢ç„¶Directoræ˜¯å˜åŒ–çš„ï¼Œå¹¶ä¸”å…¶å®åœ¨ç”Ÿæ´»ä¸­æˆ‘ä»¬è‡ªå·±æœ¬èº«å°±æ˜¯Director,æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥<strong>æŠŠDirectorè¿™ä¸ªè§’è‰²å»æ‰</strong>ï¼Œå› ä¸ºæˆ‘ä»¬è‡ªèº«å°±æ˜¯æŒ‡å¯¼è€…</p><h3 id="äº§å“-1"><a href="#äº§å“-1" class="headerlink" title="äº§å“"></a>äº§å“</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ä½“ç±»`KFC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KFC</span> &#123;</span><br><span class="line">    <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String hamburger;</span><br><span class="line">    <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String chicken;</span><br><span class="line">    <span class="keyword">private</span> String cola;</span><br><span class="line">    <span class="keyword">private</span> String pizza;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KFC</span><span class="params">(String hamburger,String chips)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.hamburger = hamburger;</span><br><span class="line">        <span class="built_in">this</span>.hamburger = chips;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChicken</span><span class="params">(String chicken)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.chicken = chicken;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCola</span><span class="params">(String cola)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cola = cola;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPizza</span><span class="params">(String pizza)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pizza = pizza;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;KFC&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;hamburger=&#x27;&quot;</span> + hamburger + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, chips=&#x27;&quot;</span> + chips + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, chicken=&#x27;&quot;</span> + chicken + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, cola=&#x27;&quot;</span> + cola + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, pizza=&#x27;&quot;</span> + pizza + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŠ½è±¡å»ºé€ è€…ï¼ˆBuilderï¼‰"><a href="#æŠ½è±¡å»ºé€ è€…ï¼ˆBuilderï¼‰" class="headerlink" title="æŠ½è±¡å»ºé€ è€…ï¼ˆBuilderï¼‰"></a>æŠ½è±¡å»ºé€ è€…ï¼ˆBuilderï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè¡¨æ˜éœ€è¦å»ºé€ ä»€ä¹ˆï¼Œå¾—åˆ°ä»€ä¹ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="keyword">abstract</span> Builder <span class="title function_">setChicken</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> Builder <span class="title function_">setCola</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> Builder <span class="title function_">setPizza</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> KFC <span class="title function_">getKFC</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…·ä½“å»ºé€ è€…-ConcreteBuilder"><a href="#å…·ä½“å»ºé€ è€…-ConcreteBuilder" class="headerlink" title="å…·ä½“å»ºé€ è€…(ConcreteBuilder)"></a>å…·ä½“å»ºé€ è€…(ConcreteBuilder)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteBuilder</span> <span class="keyword">extends</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    KFC kfc;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConcreteBuilder</span><span class="params">(String hamburger,String chips)</span>&#123;</span><br><span class="line">        kfc = <span class="keyword">new</span> <span class="title class_">KFC</span>(hamburger,chips);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    Builder <span class="title function_">setChicken</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setChicken(<span class="string">&quot;é¸¡è…¿&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    Builder <span class="title function_">setCola</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setCola(<span class="string">&quot;å¯ä¹&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    Builder <span class="title function_">setPizza</span><span class="params">()</span> &#123;</span><br><span class="line">        kfc.setPizza(<span class="string">&quot;æŠ«è¨&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    KFC <span class="title function_">getKFC</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> kfc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuilderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">KFC</span> <span class="variable">kfc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteBuilder</span>(<span class="string">&quot;æ±‰å ¡&quot;</span>, <span class="string">&quot;è–¯æ¡&quot;</span>).setChicken().setCola().getKFC();</span><br><span class="line">        System.out.println(kfc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230608211039517.png" alt="image-20230608211039517"></p><p>å¦‚æœä¸éœ€è¦æŠ½è±¡å»ºé€ è€…çš„è§’è‰²æ¥è§„å®šç”Ÿäº§å†…å®¹ï¼Œé‚£ä¹ˆä»£ç åˆ°è¿™é‡Œå…¶å®è¿˜æœ‰è¿›ä¸€æ­¥çš„ç®€åŒ–ç©ºé—´ã€‚</p><h2 id="ä½¿ç”¨é™æ€å†…éƒ¨ç±»çš„æ–¹å¼"><a href="#ä½¿ç”¨é™æ€å†…éƒ¨ç±»çš„æ–¹å¼" class="headerlink" title="ä½¿ç”¨é™æ€å†…éƒ¨ç±»çš„æ–¹å¼"></a>ä½¿ç”¨é™æ€å†…éƒ¨ç±»çš„æ–¹å¼</h2><blockquote><p><strong>è¿›ä¸€æ­¥ç®€åŒ–</strong></p></blockquote><h3 id="äº§å“-2"><a href="#äº§å“-2" class="headerlink" title="äº§å“"></a>äº§å“</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ä½“ç±»`KFC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KFC</span> &#123;</span><br><span class="line">    <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String hamburger;</span><br><span class="line">    <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> String chicken;</span><br><span class="line">    <span class="keyword">private</span> String cola;</span><br><span class="line">    <span class="keyword">private</span> String pizza;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸€å®šè¦æœ‰ä¸€ä¸ªå¸¦æœ‰Builderå‚æ•°çš„å»ºé€ è€…</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">KFC</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hamburger = builder.hamburger;</span><br><span class="line">        <span class="built_in">this</span>.chips = builder.chips;</span><br><span class="line">        <span class="built_in">this</span>.chicken = builder.chicken;</span><br><span class="line">        <span class="built_in">this</span>.cola = builder.cola;</span><br><span class="line">        <span class="built_in">this</span>.pizza = builder.pizza;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨æ„å¿…é¡»ä¸ºé™æ€å†…éƒ¨ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">        <span class="comment">//å¥—é¤å¿…ç‚¹</span></span><br><span class="line">        <span class="keyword">private</span> String hamburger;</span><br><span class="line">        <span class="keyword">private</span> String chips;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¥—é¤é€‰ç‚¹</span></span><br><span class="line">        <span class="keyword">private</span> String chicken;</span><br><span class="line">        <span class="keyword">private</span> String cola;</span><br><span class="line">        <span class="keyword">private</span> String pizza;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Builder</span><span class="params">(String hamburger, String chips)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.hamburger = hamburger;</span><br><span class="line">            <span class="built_in">this</span>.chips = chips;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">setChicken</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.chicken = <span class="string">&quot;å°é¸¡è…¿&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">setCola</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.cola = <span class="string">&quot;å°å¯ä¹&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">setPizza</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.pizza = <span class="string">&quot;å°æŠ«è¨&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç”Ÿæˆä¸€ä¸ªäº§å“</span></span><br><span class="line">        <span class="keyword">public</span> KFC <span class="title function_">getKFC</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">KFC</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;KFC&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;hamburger=&#x27;&quot;</span> + hamburger + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, chips=&#x27;&quot;</span> + chips + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, chicken=&#x27;&quot;</span> + chicken + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, cola=&#x27;&quot;</span> + cola + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, pizza=&#x27;&quot;</span> + pizza + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuilderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">KFC</span> <span class="variable">kfc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KFC</span>.Builder(<span class="string">&quot;å¤§æ±‰å ¡&quot;</span>, <span class="string">&quot;å°è–¯æ¡&quot;</span>).setChicken().setCola().getKFC();</span><br><span class="line">        System.out.println(kfc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230608211250487.png" alt="image-20230608211250487"></p><h1 id="å»ºé€ è€…æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„åŒºåˆ«"><a href="#å»ºé€ è€…æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="å»ºé€ è€…æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„åŒºåˆ«"></a>å»ºé€ è€…æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„åŒºåˆ«</h1><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œä½ å‘ç°æ™®é€šçš„å»ºé€ è€…æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çœŸçš„å¾ˆåƒï¼Œåœ¨å»ºé€ è€…æ¨¡å¼ä¸­çš„builderè§’è‰²å¾ˆåƒè¶…çº§å·¥å‚ï¼Œç„¶åcontracterBuilderå¾ˆåƒå…·ä½“çš„å·¥å‚ï¼Œéƒ½æ˜¯è§„å®šäº†å»ºé€ çš„å†…å®¹</p><p>é‚£ä¹ˆå®ƒä»¬ä¹‹é—´ æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢</p><ul><li>å»ºé€ è€…æ¨¡å¼æœ‰æŒ‡å¯¼è€…è¿™ä¸ªè§’è‰²ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªç»„è£…å¥½çš„äº§å“ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼è¿”å›ä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ï¼Œè¿™äº›äº§å“ä½äºä¸åŒçš„äº§å“ç­‰çº§ç»“æ„ï¼Œæ„æˆäº†ä¸€ä¸ªäº§å“æ—</li><li>å»ºé€ è€…æ¨¡å¼æ›´é€‚åˆå¤æ‚çš„äº§å“æ„å»º</li><li>å¯ä»¥å°†æŠ½è±¡å·¥å‚æ¨¡å¼ç†è§£æˆæ±½è½¦é›¶ä»¶ç”Ÿäº§å·¥å‚ï¼Œè€Œå»ºé€ è€…æ¨¡å¼çœ‹å‡ºç»„è£…å·¥å‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å­¦ä¹ ä¸€ç±»æŠ€å·§æ˜¯ä¸ºäº†è§£å†³ä¸€ç±»é—®é¢˜ï¼Œå­¦ä¹ è®¾è®¡æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†ç†è§£å®ƒçš„æ€æƒ³ï¼Œå°†æ¥é‡åˆ°ä»£ç çš„ç¼–å†™ï¼Œä½¿ç”¨è¿™ç§æ¨¡å¼ä¼šæ›´åŠ çš„æ–¹å¼ï¼Œè€Œæ²¡æœ‰å¿…è¦åˆ»æ„çš„å»ä½¿ç”¨ï¼Œä½†æ˜¯éœ€è¦åˆ»æ„çš„å»ç»ƒä¹ ï¼Œå½¢æˆè¿™ç§æ€æƒ³</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¤æ‚äº§å“çš„åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥è°ƒç”¨é¡ºåºä¸åŒï¼Œç»“æœä¸åŒï¼Œåˆ›å»ºç»“æœå¾ˆæ¸…æ™°</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¦‚æœäº§å“çš„å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´éœ€è¦å®šä¹‰å¾ˆå¤šå…·ä½“å»ºé€ è€…æ¥å®ç°è¿™ç§å˜åŒ–ã€‚</li></ul>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/1776793711.html"/>
    <id>https://www.naste.top:1024/posts/1776793711.html</id>
    <published>2023-06-07T06:24:15.000Z</published>
    <updated>2023-06-07T07:15:00.427Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼</h1><p>å•ä¾‹è®¾è®¡æ¨¡å¼(Singleton Pattern)æ˜¯ä¸€ç§å¸¸ç”¨çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚è¿™ç§æ¨¡å¼åœ¨éœ€è¦ç¡®ä¿æŸä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹çš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œå¸¸ç”¨äºç®¡ç†å…±äº«èµ„æºæˆ–é™åˆ¶å¯¹è±¡çš„åˆ›å»ºã€‚</p><h1 id="å•ä¾‹æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#å•ä¾‹æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="å•ä¾‹æ¨¡å¼åº”ç”¨åœºæ™¯"></a>å•ä¾‹æ¨¡å¼åº”ç”¨åœºæ™¯</h1><ol><li>é…ç½®ç®¡ç†ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸€äº›å…¨å±€çš„é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ã€æ—¥å¿—çº§åˆ«ç­‰ã€‚è¿™äº›é…ç½®ä¿¡æ¯é€šå¸¸åªéœ€è¦ä¸€ä»½ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥å®ç°ã€‚é€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å®ä¾‹ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«è¿™ä¸ªå®ä¾‹ã€‚è¿™æ ·å¯ä»¥é¿å…å¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹é…ç½®ä¿¡æ¯ï¼Œä»è€Œä¿è¯äº†é…ç½®ä¿¡æ¯çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li><li>æ—¥å¿—è®°å½•ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„æ—¥å¿—è®°å½•å™¨ï¼Œç”¨äºè®°å½•åº”ç”¨ç¨‹åºçš„è¿è¡Œæƒ…å†µå’Œé”™è¯¯ä¿¡æ¯ã€‚åŒæ ·åœ°ï¼Œåªéœ€è¦ä¸€ä»½æ—¥å¿—è®°å½•å™¨å³å¯ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥å®ç°ã€‚é€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å®ä¾‹ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«è¿™ä¸ªå®ä¾‹ã€‚è¿™æ ·å¯ä»¥é¿å…å¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹æ—¥å¿—è®°å½•å™¨ï¼Œä»è€Œä¿è¯äº†æ—¥å¿—è®°å½•çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li><li>ç¼“å­˜ç®¡ç†ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„ç¼“å­˜ç³»ç»Ÿï¼Œç”¨äºç¼“å­˜ä¸€äº›æ•°æ®ä»¥æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚åŒæ ·åœ°ï¼Œåªéœ€è¦ä¸€ä»½ç¼“å­˜ç³»ç»Ÿå³å¯ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥å®ç°ã€‚é€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å®ä¾‹ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«è¿™ä¸ªå®ä¾‹ã€‚è¿™æ ·å¯ä»¥é¿å…å¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹ç¼“å­˜ç³»ç»Ÿï¼Œä»è€Œä¿è¯äº†ç¼“å­˜ç³»ç»Ÿçš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li><li>èµ„æºç®¡ç†ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸€äº›å…¨å±€çš„èµ„æºï¼Œä¾‹å¦‚æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ç­‰ã€‚è¿™äº›èµ„æºé€šå¸¸åªéœ€è¦ä¸€ä»½ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥å®ç°ã€‚é€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å®ä¾‹ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«è¿™ä¸ªå®ä¾‹ã€‚è¿™æ ·å¯ä»¥é¿å…å¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹èµ„æºï¼Œä»è€Œä¿è¯äº†èµ„æºçš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li></ol><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><h2 id="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰"><a href="#æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰" class="headerlink" title="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰"></a>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazySingleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºä¸€ä¸ªç§æœ‰é™æ€å˜é‡instance,ç”¨äºå­˜å‚¨å•ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰ï¼Œé˜²æ­¢å¤–éƒ¨åˆ›å»ºæ–°çš„å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å•ä¾‹å®ä¾‹çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå®ä¾‹è¿˜æœªåˆ›å»ºï¼Œåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">LazySingleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"><a href="#æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰" class="headerlink" title="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"></a>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SafeLazySingleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºä¸€ä¸ªç§æœ‰é™æ€å˜é‡instance,ç”¨äºå­˜å‚¨å•ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SafeLazySingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰ï¼Œé˜²æ­¢å¤–éƒ¨åˆ›å»ºæ–°çš„å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">SafeLazySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å•ä¾‹å®ä¾‹çš„æ–¹æ³•ï¼Œä½¿ç”¨ synchronized ä¿®é¥°ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> SafeLazySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå®ä¾‹è¿˜æœªåˆ›å»ºï¼Œåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">SafeLazySingleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"></a>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HungrySingleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç±»åŠ è½½æ—¶å°±åˆ›å»ºå•ä¾‹å®ä¾‹ï¼Œä½¿ç”¨ final ä¿®é¥°ä»¥ä¿è¯å®ä¾‹å”¯ä¸€æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">HungrySingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HungrySingleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰ï¼Œé˜²æ­¢å¤–éƒ¨åˆ›å»ºæ–°çš„å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">HungrySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å•ä¾‹å®ä¾‹çš„æ–¹æ³•ï¼Œç›´æ¥è¿”å›é¢„å…ˆåˆ›å»ºçš„å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HungrySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼"><a href="#åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼" class="headerlink" title="åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼"></a>åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DoubleCheckSingleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€æŸ¥å®ä¾‹æ˜¯å¦å·²åˆ›å»ºçš„ volatile å˜é‡ï¼Œå¯è§æ€§ä¿è¯çº¿ç¨‹å®‰å…¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> DoubleCheckSingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰ï¼Œé˜²æ­¢å¤–éƒ¨åˆ›å»ºæ–°çš„å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">DoubleCheckSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å•ä¾‹å®ä¾‹çš„æ–¹æ³•ï¼Œä½¿ç”¨åŒé‡æ£€æŸ¥é”ä¿è¯çº¿ç¨‹å®‰å…¨å’Œæ€§èƒ½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DoubleCheckSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (DoubleCheckSingleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœå®ä¾‹è¿˜æœªåˆ›å»ºï¼Œåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹è¿”å›</span></span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">DoubleCheckSingleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"><a href="#é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼" class="headerlink" title="é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"></a>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StaticInnerClassSingleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§æœ‰æ„é€ å‡½æ•°ï¼Œé¿å…ç±»åœ¨å¤–éƒ¨è¢«å®ä¾‹åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">StaticInnerClassSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é™æ€å†…éƒ¨ç±»æŒæœ‰å•ä¾‹å®ä¾‹ï¼Œç±»åŠ è½½æ—¶ä¸ä¼šè¿›è¡Œåˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     * ç›´åˆ°ç¬¬ä¸€æ¬¡è·å–å®ä¾‹æ—¶æ‰åˆ›å»ºï¼Œå¹¶ç¡®ä¿å®ä¾‹åªè¢«åˆå§‹åŒ–ä¸€æ¬¡ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">StaticInnerClassSingleton</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StaticInnerClassSingleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å”¯ä¸€å®ä¾‹çš„æ–¹æ³•ï¼Œä½¿ç”¨é™æ€å†…éƒ¨ç±»ä¸­çš„INSTANCEè¿›è¡Œå®ä¾‹çš„è·å–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StaticInnerClassSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Singleton.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æšä¸¾å•ä¾‹æ¨¡å¼"><a href="#æšä¸¾å•ä¾‹æ¨¡å¼" class="headerlink" title="æšä¸¾å•ä¾‹æ¨¡å¼"></a>æšä¸¾å•ä¾‹æ¨¡å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æšä¸¾å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EnumSingleton</span> &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EnumSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        value = <span class="number">1</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;INSTANCE now created!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.singleton;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•ä¾‹æ¨¡å¼æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lazySingletonTest</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰&quot;</span>);</span><br><span class="line">        <span class="type">LazySingleton</span> <span class="variable">instance</span> <span class="operator">=</span> LazySingleton.getInstance();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">safeLazySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰&quot;</span>);</span><br><span class="line">        <span class="type">SafeLazySingleton</span> <span class="variable">instance</span> <span class="operator">=</span> SafeLazySingleton.getInstance();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hungrySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼&quot;</span>);</span><br><span class="line">        <span class="type">HungrySingleton</span> <span class="variable">instance</span> <span class="operator">=</span> HungrySingleton.getInstance();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(<span class="string">&quot;é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doubleCheckSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼&quot;</span>);</span><br><span class="line">        <span class="type">DoubleCheckSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> DoubleCheckSingleton.getInstance();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(<span class="string">&quot;åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">staticInnerClassSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼&quot;</span>);</span><br><span class="line">        <span class="type">StaticInnerClassSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> StaticInnerClassSingleton.getInstance();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(<span class="string">&quot;é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">enumSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æšä¸¾å•ä¾‹æ¨¡å¼&quot;</span>);</span><br><span class="line">        <span class="type">EnumSingleton</span> <span class="variable">singleton</span> <span class="operator">=</span> EnumSingleton.INSTANCE;</span><br><span class="line">        System.out.println(singleton.getValue());</span><br><span class="line">        singleton.setValue(<span class="number">2</span>);</span><br><span class="line">        System.out.println(singleton.getValue());</span><br><span class="line">        System.out.println(<span class="string">&quot;æšä¸¾å•ä¾‹æ¨¡å¼\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230607151223998.png" alt="image-20230607151223998"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼(çº¿ç¨‹ä¸å®‰å…¨): <ul><li>ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œæ€§èƒ½å¥½ã€‚ </li><li>ç¼ºç‚¹ï¼šçº¿ç¨‹ä¸å®‰å…¨ï¼Œéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¿›è¡ŒåŒæ­¥å¤„ç†ã€‚</li></ul></li><li>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼(çº¿ç¨‹å®‰å…¨): <ul><li>ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œä¸éœ€è¦é¢å¤–çš„åŒæ­¥å¤„ç†ã€‚</li><li>ç¼ºç‚¹ï¼šå®ç°ç›¸å¯¹å¤æ‚ï¼Œæ€§èƒ½ç•¥å·®äºé¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ã€‚</li></ul></li><li>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ï¼š <ul><li>ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½å¥½ã€‚ </li><li>ç¼ºç‚¹ï¼šåˆ›å»ºå®ä¾‹æ—¶ä¼šè€—è´¹ä¸€å®šçš„æ—¶é—´å’Œèµ„æºã€‚</li></ul></li><li>åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡ï¼š <ul><li>ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½å¥½ã€‚ </li><li>ç¼ºç‚¹ï¼šå®ç°ç›¸å¯¹å¤æ‚ã€‚</li></ul></li><li>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ï¼š <ul><li>ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½å¥½ã€‚ </li><li>ç¼ºç‚¹ï¼šå®ç°ç›¸å¯¹å¤æ‚ã€‚</li></ul></li><li>æšä¸¾å•ä¾‹æ¨¡å¼ï¼š <ul><li>ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½å¥½ã€‚ </li><li>ç¼ºç‚¹ï¼šæšä¸¾ç±»å‹æœ¬èº«ä¸èƒ½è¢«ä¿®æ”¹ï¼Œå› æ­¤å¦‚æœéœ€è¦æ‰©å±•åŠŸèƒ½åˆ™éœ€è¦ä¿®æ”¹æšä¸¾ç±»å‹ã€‚</li></ul></li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼Œä¸åŒçš„å•ä¾‹æ¨¡å¼é€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚æ ¹æ®å®é™…çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜ç¨‹åºçš„æ•ˆç‡ï¼Œå¹¶ä¿è¯å•ä¾‹å®ä¾‹çš„å”¯ä¸€æ€§ã€‚</p>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-ä»£ç†æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/3822496321.html"/>
    <id>https://www.naste.top:1024/posts/3822496321.html</id>
    <published>2023-06-05T07:06:05.000Z</published>
    <updated>2023-06-06T08:57:28.492Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼</h1><p>ä»£ç†è®¾è®¡æ¨¡å¼æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸ä½ æ§åˆ¶å¯¹ä¸€ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚è¯¥æ¨¡å¼é€šè¿‡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´åˆ›å»ºä¸€ä¸ªä»£ç†æ¥å®ç°è¿™ä¸€ç›®çš„ã€‚ä»£ç†å¯ä»¥æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å®‰å…¨æ€§ã€ç¼“å­˜ã€æ—¥å¿—è®°å½•ç­‰ã€‚ä»£ç†å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æ·»åŠ æˆ–åˆ é™¤åŠŸèƒ½ï¼Œä»è€Œä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ã€‚</p><p>ä»£ç†æ¨¡å¼é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼š</p><ol><li>æŠ½è±¡è§’è‰²ï¼šå®šä¹‰äº†ä»£ç†æ¥å£ï¼Œå¹¶æä¾›äº†ä¸€äº›åŸºæœ¬çš„æ–¹æ³•ã€‚</li><li>å§”æ‰˜è§’è‰²ï¼šå®ç°äº†æŠ½è±¡è§’è‰²ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†ä¸ç›®æ ‡å¯¹è±¡ç›¸åŒçš„æ¥å£ã€‚</li><li>ç›®æ ‡è§’è‰²ï¼šè¢«ä»£ç†çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è¢«ä¿æŠ¤æˆ–è€…æ§åˆ¶è®¿é—®çš„å¯¹è±¡ã€‚</li></ol><p>ä»£ç†æ¨¡å¼å¯ä»¥åˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ä¸¤ç§ç±»å‹ã€‚é™æ€ä»£ç†æ˜¯åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆä»£ç†ç±»ï¼Œè€ŒåŠ¨æ€ä»£ç†æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ã€‚</p><h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><ol><li>è¿œç¨‹æ–¹æ³•è°ƒç”¨(Remote Method Invocation,RMI):åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä»£ç†å¯¹è±¡æ¥è°ƒç”¨è¿œç¨‹å¯¹è±¡çš„æ–¹æ³•ã€‚</li><li>åŠ¨æ€ä»£ç†ï¼šåŠ¨æ€ä»£ç†å¯ä»¥åœ¨è¿è¡Œæ—¶ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œä»è€Œå®ç°æ›´çµæ´»çš„ä»£ç é‡ç”¨å’Œæ‰©å±•ã€‚</li><li>ç¼“å­˜ï¼šä»£ç†å¯ä»¥ç”¨äºç¼“å­˜æ•°æ®ï¼Œä»¥æé«˜æ€§èƒ½å¹¶å‡å°‘å¯¹æ•°æ®åº“æˆ–å…¶ä»–å­˜å‚¨ç³»ç»Ÿçš„è®¿é—®ã€‚</li><li>å®‰å…¨æ§åˆ¶ï¼šä»£ç†å¯ä»¥ç”¨äºå®ç°å®‰å…¨æ§åˆ¶ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªä»£ç†æœåŠ¡å™¨å¯ä»¥æ£€æŸ¥å®¢æˆ·ç«¯çš„èº«ä»½éªŒè¯ä¿¡æ¯ï¼Œä»¥ç¡®ä¿åªæœ‰æˆæƒçš„ç”¨æˆ·æ‰èƒ½è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚</li><li>æ—¥å¿—è®°å½•ï¼šä»£ç†å¯ä»¥ç”¨äºè®°å½•ç³»ç»Ÿçš„è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œä»£ç†æœåŠ¡å™¨å¯ä»¥è®°å½•æ‰€æœ‰è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ã€‚</li><li>å¯¹è±¡æ± ï¼šä»£ç†å¯ä»¥ç”¨äºç®¡ç†å¯¹è±¡æ± ï¼Œä¾‹å¦‚ï¼Œä»£ç†æœåŠ¡å™¨å¯ä»¥ç»´æŠ¤ä¸€ç»„å¯¹è±¡çš„æ± ï¼Œå¹¶åœ¨éœ€è¦æ—¶ä»æ± ä¸­è·å–å¯¹è±¡è€Œä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</li><li>å»¶è¿ŸåŠ è½½ï¼šä»£ç†å¯ä»¥ç”¨äºå»¶è¿ŸåŠ è½½èµ„æºï¼Œä¾‹å¦‚ï¼Œå½“éœ€è¦ä½¿ç”¨æŸä¸ªèµ„æºæ—¶æ‰åŠ è½½å®ƒï¼Œè€Œä¸æ˜¯åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±åŠ è½½ã€‚</li><li>å‘½ä»¤æ³¨å…¥ï¼šä»£ç†å¯ä»¥ç”¨äºæ³¨å…¥å‘½ä»¤ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä»£ç†å¯¹è±¡æ¥æ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ã€‚</li><li>æ™ºèƒ½æŒ‡é’ˆï¼šæ™ºèƒ½æŒ‡é’ˆæ˜¯ä¸€ç§åŸºäºä»£ç†æ¨¡å¼å®ç°çš„æŒ‡é’ˆç±»å‹ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¹¶é¿å…å†…å­˜æ³„æ¼ã€‚</li><li>è£…é¥°å™¨æ¨¡å¼ï¼šè£…é¥°å™¨æ¨¡å¼ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç†æ¥å®ç°ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªè£…é¥°å™¨å¯ä»¥åŒ…è£…ä¸€ä¸ªå¯¹è±¡å¹¶æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚</li><li>ä¹°ç«è½¦ç¥¨ä¸ä¸€å®šåˆ°ç«è½¦ç«™ä¹°ï¼Œä¹Ÿå¯ä»¥å»ä»£å”®ç‚¹ã€‚</li><li>é“¶è¡Œå¡å’Œæ”¯ç¥¨éƒ½æ˜¯çœŸå®é’±çš„ä»£ç†å¯¹è±¡ã€‚</li></ol><h1 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h1><p>é™æ€ä»£ç†æ˜¯ä¸€ç§åœ¨<code>ä»£ç ç¼–å†™æœŸ</code>è¿›è¡Œä»£ç†ç±»å’Œè¢«ä»£ç†ç±»çš„å…³è”çš„ä»£ç†æ–¹å¼ã€‚</p><p>å…·ä½“å®ç°æ˜¯åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ï¼Œé€šå¸¸éœ€è¦å®ç°ä¸è¢«ä»£ç†ç±»ç›¸åŒçš„æ¥å£æˆ–ç»§æ‰¿è¢«ä»£ç†ç±»ã€‚</p><p>æˆ¿ä¸œæ¥å£ç±»ï¼šLandlord1Serviceï¼Œæ³¨æ„ï¼Œé™æ€ä»£ç†å®ç°å®ƒçš„çœŸå®å¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªï¼Œå¤šä¸ªçš„è¯ï¼Œä»£ç†å¯¹è±¡ä¸èƒ½ç¡®å®šå“ªä¸ªå¯¹è±¡éœ€è¦è¢«ä»£ç†ï¼Œä¼šå¯¼è‡´æŠ¥é”™ï¼ŒJDKåŠ¨æ€ä»£ç†æ²¡è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="ä»£ç ç»“æ„"><a href="#ä»£ç ç»“æ„" class="headerlink" title="ä»£ç ç»“æ„"></a>ä»£ç ç»“æ„</h2><p><img src="https://www.naste.top:9000/images/image-20230606163813219.png" alt="image-20230606163813219"></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h3 id="æˆ¿ä¸œæ¥å£"><a href="#æˆ¿ä¸œæ¥å£" class="headerlink" title="æˆ¿ä¸œæ¥å£"></a>æˆ¿ä¸œæ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Landlord1Service</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºç§Ÿ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç§Ÿå®¢"><a href="#ç§Ÿå®¢" class="headerlink" title="ç§Ÿå®¢"></a>ç§Ÿå®¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç§Ÿå®¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TenantImpl</span> <span class="keyword">implements</span> <span class="title class_">Landlord1Service</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç§Ÿä¸‹&quot;</span> + money + <span class="string">&quot;å…ƒä¸€ä¸ªæœˆçš„æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸­ä»‹"><a href="#ä¸­ä»‹" class="headerlink" title="ä¸­ä»‹"></a>ä¸­ä»‹</h3><blockquote><p><strong>ä¸­ä»‹è¿™ä¸ªæ—¶å€™å°±ç›¸å½“äºä»£ç†</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸­ä»‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Created by njy on 2023/5/30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyImpl</span> <span class="keyword">implements</span> <span class="title class_">Landlord1Service</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆ¿ä¸œæœ‰å¾ˆå¤šå¥—æˆ¿å­ï¼Œä¸æƒ³äº²è‡ªå‡ºé©¬äº†ï¼Œäºæ˜¯æ‰¾æ¥äº†ä¸­ä»‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Landlord1Service target;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼˜ç‚¹å°±æ˜¯åœ¨ä¸æ”¹å˜åŸæ¥çš„å®ç°ç±»çš„æƒ…å†µä¸‹å¯¹æ–¹æ³•å®ç°äº†å¢å¼º</span></span><br><span class="line"><span class="comment">     * ç¼ºç‚¹æ˜¯å¦‚æœåŸæ¥çš„æ¥å£æ–°å¢äº†æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™é‡Œä¹Ÿè¦å¯¹åº”å®ç°æ–°çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money é‡‘é¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[é™æ€ä»£ç†]äº¤ä¸­ä»‹è´¹&quot;</span>);</span><br><span class="line">        target.rent(money);</span><br><span class="line">        System.out.println(<span class="string">&quot;[é™æ€ä»£ç†]ä¸­ä»‹è´Ÿè´£ç»´ä¿®ç®¡ç†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestProxy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§Ÿå®¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TenantImpl tenant;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸­ä»‹-ä»£ç†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ProxyImpl proxy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.é™æ€ä»£ç†</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">TestStatic</span><span class="params">()</span> &#123;</span><br><span class="line">        tenant.rent(<span class="number">1000</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        proxy.rent(<span class="number">2000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230606163616461.png" alt="image-20230606163616461"></p><h3 id="é™æ€ä»£ç†åº”ç”¨åœºæ™¯"><a href="#é™æ€ä»£ç†åº”ç”¨åœºæ™¯" class="headerlink" title="é™æ€ä»£ç†åº”ç”¨åœºæ™¯"></a>é™æ€ä»£ç†åº”ç”¨åœºæ™¯</h3><p>é€‚ç”¨åœºæ™¯ï¼š</p><ol><li>å½“ä»£ç†å¯¹è±¡åªæœ‰ä¸€ä¸ªæ—¶ï¼Œå¯ä»¥ä½¿ç”¨é™æ€ä»£ç†</li><li>å½“è¢«ä»£ç†çš„ç±»çš„æ¥å£æ¯”è¾ƒç¨³å®šæ—¶ï¼Œå¯ä»¥ä½¿ç”¨é™æ€ä»£ç†</li><li>å½“éœ€è¦ä¸ºå¤šä¸ªè¢«ä»£ç†çš„ç±»æä¾›ä»£ç†æ—¶ï¼Œä¼šå¯¼è‡´ä»£ç†ç±»è¿‡å¤šï¼Œä¸æ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨é™æ€ä»£ç†ã€‚</li></ol><h1 id="JDKåŠ¨æ€ä»£ç†"><a href="#JDKåŠ¨æ€ä»£ç†" class="headerlink" title="JDKåŠ¨æ€ä»£ç†"></a>JDKåŠ¨æ€ä»£ç†</h1><p>JDKåŠ¨æ€ä»£ç†æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„ä»£ç†æ–¹å¼ï¼Œå®ƒæ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶å¹¶ä¸çŸ¥é“å…·ä½“ä»£ç†çš„æ˜¯ä»€ä¹ˆç±»ï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆã€‚</p><h2 id="ä»£ç ç»“æ„-1"><a href="#ä»£ç ç»“æ„-1" class="headerlink" title="ä»£ç ç»“æ„"></a>ä»£ç ç»“æ„</h2><p><img src="https://www.naste.top:9000/images/image-20230606164651902.png" alt="image-20230606164651902"></p><h2 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h3 id="æˆ¿ä¸œæ¥å£-1"><a href="#æˆ¿ä¸œæ¥å£-1" class="headerlink" title="æˆ¿ä¸œæ¥å£"></a>æˆ¿ä¸œæ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Landlord2Service</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºç§Ÿ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç§Ÿå®¢1"><a href="#ç§Ÿå®¢1" class="headerlink" title="ç§Ÿå®¢1"></a>ç§Ÿå®¢1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç§Ÿå®¢1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Teant1Impl</span> <span class="keyword">implements</span> <span class="title class_">Landlord2Service</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;tenant1ç§Ÿä¸‹&quot;</span> + money + <span class="string">&quot;å…ƒä¸€ä¸ªæœˆçš„æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç§Ÿå®¢2"><a href="#ç§Ÿå®¢2" class="headerlink" title="ç§Ÿå®¢2"></a>ç§Ÿå®¢2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç§Ÿå®¢2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tenant2Impl</span> <span class="keyword">implements</span> <span class="title class_">Landlord2Service</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;tenant2ç§Ÿä¸‹&quot;</span> + money + <span class="string">&quot;å…ƒä¸€ä¸ªæœˆçš„æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸­ä»‹-1"><a href="#ä¸­ä»‹-1" class="headerlink" title="ä¸­ä»‹"></a>ä¸­ä»‹</h3><blockquote><p><strong>ä¸­ä»‹â€”åŠ¨æ€ä»£ç†ç±»</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JDKåŠ¨æ€ä»£ç†ï¼šå°±æ˜¯æŠŠä»£ç†æŠ½è±¡äº†ä¸€ä¸‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDKProxy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JDKProxy</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»™ç›®æ ‡å¯¹è±¡ç”Ÿæˆä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä»£ç†ç”Ÿæˆçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxyInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(),</span><br><span class="line">                target.getClass().getInterfaces(),</span><br><span class="line">                <span class="comment">//è¿™é‡Œæ˜¯è¦å®ç°jdkä»£ç†InvocationHandlerçš„æ¥å£ï¼Œlambdaè¡¨è¾¾å¼</span></span><br><span class="line">                (proxy, method, args) -&gt; &#123;</span><br><span class="line">                    <span class="comment">//æ‰§è¡Œå¯¹è±¡æ–¹æ³•</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;[JDKåŠ¨æ€ä»£ç†]äº¤ä¸­ä»‹è´¹&quot;</span>);</span><br><span class="line">                    method.invoke(target, args);</span><br><span class="line">                    System.out.println(<span class="string">&quot;[JDKåŠ¨æ€ä»£ç†]ä¸­ä»‹è´Ÿè´£ç»´ä¿®ç®¡ç†&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.xiaofei.proxy.jdkProxy.JDKProxy;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.proxy.jdkProxy.Landlord2Service;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.proxy.jdkProxy.Teant1Impl;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.proxy.jdkProxy.Tenant2Impl;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JDKåŠ¨æ€ä»£ç†æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDKProxyTest</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Teant1Impl teant1;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Tenant2Impl tenant2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.JDKåŠ¨æ€ä»£ç†</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">TestJDK</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Landlord2Service</span> <span class="variable">proxyInstance1</span> <span class="operator">=</span> (Landlord2Service) <span class="keyword">new</span> <span class="title class_">JDKProxy</span>(teant1).getProxyInstance();</span><br><span class="line">        proxyInstance1.rent(<span class="number">2500</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="type">Landlord2Service</span> <span class="variable">proxyInstance2</span> <span class="operator">=</span> (Landlord2Service) <span class="keyword">new</span> <span class="title class_">JDKProxy</span>(tenant2).getProxyInstance();</span><br><span class="line">        proxyInstance2.rent(<span class="number">2500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230606164538352.png" alt="image-20230606164538352"></p><h3 id="JDKåŠ¨æ€ä»£ç†åº”ç”¨åœºæ™¯"><a href="#JDKåŠ¨æ€ä»£ç†åº”ç”¨åœºæ™¯" class="headerlink" title="JDKåŠ¨æ€ä»£ç†åº”ç”¨åœºæ™¯"></a>JDKåŠ¨æ€ä»£ç†åº”ç”¨åœºæ™¯</h3><ol><li>å¯¹è±¡å¿…é¡»å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£</li><li>ä»£ç†ç±»çš„ä»£ç†æ–¹æ³•ä¸éœ€è¦é¢å¤–çš„é€»è¾‘</li></ol><h1 id="Cglibä»£ç†"><a href="#Cglibä»£ç†" class="headerlink" title="Cglibä»£ç†"></a>Cglibä»£ç†</h1><p>CGLIBä»£ç†æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»çš„æ–¹å¼ï¼Œå®ƒä½¿ç”¨çš„åº“æ˜¯cglibï¼Œå’ŒJDKä»£ç†ç›¸æ¯”ï¼Œå®ƒä¸æ˜¯åŠ¨æ€çš„ç”Ÿæˆä¸€ä¸ªå®ç°äº†æ¥å£çš„ä»£ç†ç±»ï¼Œè€Œæ˜¯ç›´æ¥åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªè¢«ä»£ç†ç±»çš„å­ç±»ï¼Œå¹¶é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ¥è¿›è¡Œä»£ç†ã€‚</p><h2 id="ä»£ç ç»“æ„-2"><a href="#ä»£ç ç»“æ„-2" class="headerlink" title="ä»£ç ç»“æ„"></a>ä»£ç ç»“æ„</h2><h2 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h3 id="æˆ¿ä¸œ"><a href="#æˆ¿ä¸œ" class="headerlink" title="æˆ¿ä¸œ"></a>æˆ¿ä¸œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Landlord3Service</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºç§Ÿæˆ¿å±‹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">(Integer money)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç§Ÿä¸‹&quot;</span> + money + <span class="string">&quot;å…ƒä¸€ä¸ªæœˆçš„æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Cglibä»£ç†-1"><a href="#Cglibä»£ç†-1" class="headerlink" title="Cglibä»£ç†"></a>Cglibä»£ç†</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cglib.proxy.MethodProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JDKProxyï¼šcglibå­ç±»ä»£ç†å·¥å‚</span></span><br><span class="line"><span class="comment"> * 1.ä»£ç†çš„ç±»ä¸èƒ½ä¸ºfinal</span></span><br><span class="line"><span class="comment"> * 2.ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•å¦‚æœä¸ºfinal/staticï¼Œé‚£ä¹ˆå°±ä¸ä¼šè¢«æ‹¦æˆªï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œç›®æ ‡å¯¹è±¡çš„ä¸šåŠ¡æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CglibProxy</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›®æ ‡å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CglibProxy</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxyInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//1.å·¥å…·ç±»</span></span><br><span class="line">        <span class="type">Enhancer</span> <span class="variable">en</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line">        <span class="comment">//2.è®¾ç½®çˆ¶ç±»</span></span><br><span class="line">        en.setSuperclass(target.getClass());</span><br><span class="line">        <span class="comment">//3.è®¾ç½®å›è°ƒå‡½æ•°</span></span><br><span class="line">        en.setCallback(<span class="built_in">this</span>);</span><br><span class="line">        <span class="comment">//4.åˆ›å»ºå­ç±»ï¼ˆä»£ç†å¯¹è±¡ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> en.create();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Cglibä»£ç†]äº¤ä¸­ä»‹è´¹&quot;</span>);</span><br><span class="line">        method.invoke(target, objects);</span><br><span class="line">        System.out.println(<span class="string">&quot;[Cglibä»£ç†]ä¸­ä»‹è´Ÿè´£ç»´ä¿®ç®¡ç†&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.xiaofei.proxy.cglib.CglibProxy;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.proxy.cglib.Landlord3Service;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * CglibProxyæµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CglibProxyTest</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Landlord3Service landlord3Service;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Cglibä»£ç†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">TestCglib</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Landlord3Service</span> <span class="variable">proxyInstance</span> <span class="operator">=</span> (Landlord3Service) <span class="keyword">new</span> <span class="title class_">CglibProxy</span>(landlord3Service).getProxyInstance();</span><br><span class="line">        proxyInstance.rent(<span class="number">3000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230606165551152.png" alt="image-20230606165551152"></p><h2 id="Cglibä»£ç†åº”ç”¨åœºæ™¯"><a href="#Cglibä»£ç†åº”ç”¨åœºæ™¯" class="headerlink" title="Cglibä»£ç†åº”ç”¨åœºæ™¯"></a>Cglibä»£ç†åº”ç”¨åœºæ™¯</h2><ol><li>è¢«ä»£ç†çš„ç±»æ²¡æœ‰å®ç°æ¥å£æˆ–è€…æ— æ³•å®ç°æ¥å£</li><li>ä»£ç†ç±»çš„ä»£ç†æ–¹æ³•éœ€è¦è¿›è¡Œé¢å¤–çš„é€»è¾‘ï¼Œå¦‚äº‹åŠ¡å¤„ç†ç­‰ã€‚</li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ol><li>ä»£ç†æ¨¡å¼å¯ä»¥éšè—çœŸæ˜¯å¯¹è±¡çš„å®ç°ç»†èŠ‚ï¼Œä½¿å®¢æˆ·ç«¯æ— éœ€çŸ¥æ™“çœŸå®å¯¹è±¡çš„å·¥ä½œæ–¹å¼å’Œç»“æ„ã€‚</li><li>é€šè¿‡ä»£ç†ç±»æ¥é—´æ¥è®¿é—®çœŸå®ç±»ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹çœŸå®ç±»çš„æƒ…å†µä¸‹ï¼Œå¯¹å…¶è¿›è¡Œæ‰©å±•ã€ä¼˜åŒ–æˆ–æ·»åŠ å®‰å…¨æªæ–½ã€‚</li><li>ä»£ç†æ¨¡å¼å®ç°èµ·æ¥ç®€å•ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤ï¼Œç¬¦åˆé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ä¸­çš„å¼€é—­åŸåˆ™ã€‚</li></ol><p><strong>ç¼ºç‚¹ï¼š</strong></p><ol><li>ä»£ç†æ¨¡å¼å¯èƒ½ä¼šå¼•å…¥é¢å¤–çš„å¤æ‚æ€§å’Œé—´æ¥æ€§ï¼Œå¢åŠ ç¨‹åºè®¾è®¡å’Œç»´æŠ¤çš„éš¾åº¦ã€‚</li><li>å¯¹è±¡ä»£ç†å¯èƒ½ä¼šé™ä½ç³»ç»Ÿæ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§æ•°æ®é‡æˆ–é¢‘ç¹è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºä»£ç†éœ€è¦é¢å¤–çš„è®¡ç®—å’Œç½‘ç»œé€šä¿¡å¼€é”€ã€‚</li></ol>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-ä»£ç†æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ä»£ç†æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/3439274786.html"/>
    <id>https://www.naste.top:1024/posts/3439274786.html</id>
    <published>2023-05-31T03:40:08.000Z</published>
    <updated>2023-06-07T07:54:42.405Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><h2 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h2><p>å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ï¼š<a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1281319170474017">https://www.liaoxuefeng.com/wiki/1252599548343744/1281319170474017</a></p><p>åšå®¢æ–‡æ¡£ï¼š</p><ul><li><a href="https://blog.csdn.net/weixin_45433817/article/details/130934548">https://blog.csdn.net/weixin_45433817/article/details/130934548</a></li></ul><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p><a href="https://gitee.com/xiao-i-fei/xiaofei-design-mode">https://gitee.com/xiao-i-fei/xiaofei-design-mode</a></p><p><a href="https://github.com/xiao-i-fei/xiaofei-design-mode">https://github.com/xiao-i-fei/xiaofei-design-mode</a></p><h1 id="ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼</h1><blockquote><p><strong>å·¥å‚è®¾è®¡æ¨¡å¼çš„ç›®çš„æ˜¯ä½¿å¾—åˆ›å»ºå¯¹è±¡å’Œä½¿ç”¨å¯¹è±¡æ˜¯åˆ†ç¦»çš„ï¼Œè°ƒç”¨è€…åªç®¡è·å–å¯¹è±¡è·å–å¯¹è±¡ï¼Œæ— éœ€çŸ¥é“å¯¹è±¡æ˜¯æ€ä¹ˆåˆ›å»ºçš„,å·¥å‚æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒç”¨äºè§£è€¦å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ›å»ºå¯¹è±¡æ—¶éœ€è¦ä½¿ç”¨<code>newæ“ä½œç¬¦</code>ï¼Œä½†æ˜¯ä½¿ç”¨newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡ä¼šä½¿ä»£ç å…·æœ‰<code>è€¦åˆæ€§</code>ã€‚å·¥å‚æ¨¡å¼é€šè¿‡æä¾›ä¸€ä¸ªå…¬å…±çš„æ¥å£ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨<code>ä¸æš´éœ²å¯¹è±¡åˆ›å»ºé€»è¾‘çš„æƒ…å†µä¸‹</code>åˆ›å»ºå¯¹è±¡ã€‚</strong></p></blockquote><h1 id="å·¥å‚æ¨¡å¼çš„åˆ†ç±»"><a href="#å·¥å‚æ¨¡å¼çš„åˆ†ç±»" class="headerlink" title="å·¥å‚æ¨¡å¼çš„åˆ†ç±»"></a>å·¥å‚æ¨¡å¼çš„åˆ†ç±»</h1><p>å·¥å‚æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š</p><ul><li>ç®€å•å·¥å‚</li><li>æ–¹æ³•å·¥å‚</li><li>æŠ½è±¡å·¥å‚</li></ul><p>å…¶æœ¬è´¨å°±æ˜¯å¯¹è·å–å¯¹è±¡è¿‡ç¨‹çš„æŠ½è±¡</p><h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><h2 id="åº”ç”¨å®ä¾‹"><a href="#åº”ç”¨å®ä¾‹" class="headerlink" title="åº”ç”¨å®ä¾‹"></a>åº”ç”¨å®ä¾‹</h2><blockquote><p>ä½ éœ€è¦ä¸€è¾†æ±½è½¦ï¼Œå¯ä»¥ç›´æ¥ä»å·¥å‚é‡Œæè´§ï¼Œè€Œä¸ç”¨å…³å¿ƒå®ƒå…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„</p><p>Hibernateæ¢æ•°æ®åº“åªéœ€è¦æ¢æ–¹è¨€å’Œé©±åŠ¨å°±å¯ä»¥</p></blockquote><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><blockquote><p>æ—¥å¿—è®°å½•å™¨ï¼šè®°å½•å¯èƒ½è®°å½•åˆ°æœ¬åœ°ç¡¬ç›˜ã€ç³»ç»Ÿäº‹ä»¶ã€è¿œç¨‹æœåŠ¡å™¨ç­‰ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©è®°å½•æ—¥å¿—åˆ°ä»€ä¹ˆåœ°æ–¹ã€‚</p><p>æ•°æ®åº“è®¿é—®ï¼Œå½“ç”¨æˆ·ä¸çŸ¥é“æœ€åç³»ç»Ÿé‡‡ç”¨å“ªä¸€ç±»æ•°æ®åº“ï¼Œä»¥åŠæ•°æ®åº“å¯èƒ½æœ‰å˜åŒ–æ—¶ã€‚</p><p>è®¾è®¡ä¸€ä¸ªè¿æ¥æœåŠ¡å™¨çš„æ¡†æ¶ï¼Œéœ€è¦ä¸‰ä¸ªåè®®ï¼Œâ€POP3â€ã€â€IMAPâ€ã€â€HTTPâ€ï¼Œå¯ä»¥æŠŠè¿™ä¸‰ä¸ªä½œä¸ºäº§å“ç±»ï¼Œå…±åŒå®ç°ä¸€ä¸ªæ¥å£</p></blockquote><h1 id="å·¥å‚æ¨¡å¼å®ç°"><a href="#å·¥å‚æ¨¡å¼å®ç°" class="headerlink" title="å·¥å‚æ¨¡å¼å®ç°"></a>å·¥å‚æ¨¡å¼å®ç°</h1><h2 id="ä¼ ç»Ÿæ¨¡å¼"><a href="#ä¼ ç»Ÿæ¨¡å¼" class="headerlink" title="ä¼ ç»Ÿæ¨¡å¼"></a>ä¼ ç»Ÿæ¨¡å¼</h2><p>åœ¨ä»‹ç»å·¥å‚æ¨¡å¼ä¹‹å‰å…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿæ¨¡å¼ï¼Œä»¥å–åŒ…å­ä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç®€å•çš„åˆ¶ä½œæµç¨‹</span></span><br><span class="line"><span class="keyword">public</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">BaoZi</span> <span class="variable">baozi</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaoZiImpl</span>();</span><br><span class="line">    <span class="comment">//å‡†å¤‡ææ–™</span></span><br><span class="line">    baozi.prepare();</span><br><span class="line">    <span class="comment">//åˆ¶ä½œåŒ…å­</span></span><br><span class="line">    baozi.make();</span><br><span class="line">    <span class="comment">//è’¸åŒ…å­</span></span><br><span class="line">    baozi.braise();</span><br><span class="line">    <span class="keyword">return</span> baozi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ…å­è‚¯å®šæœ‰å¾ˆå¤šç§ç±»å§ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ä¸Šè¿°ä»£ç ä¸­æ·»åŠ æ ¹æ®åŒ…å­çš„ç§ç±»ç”Ÿæˆä¸åŒç±»å‹çš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒ…å­è‚¯å®šæœ‰ä¸åŒçš„é¦…ï¼šé…¸èœã€è±†æ²™ã€çŒªè‚‰ï¼Œé‚£ä¹ˆä»–çš„ææ–™ã€å”®ä»·ç­‰æ–¹å¼ä¹Ÿä¸åŒ</span></span><br><span class="line"><span class="comment"> * æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæ·»åŠ æ ¹æ®åŒ…å­çš„ä¸åŒç§ç±»ç”Ÿæˆä¸åŒçš„å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">(String type)</span> &#123;</span><br><span class="line">    <span class="type">BaoZi</span> <span class="variable">baoZi</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;suancai&quot;</span>:</span><br><span class="line">            baoZi = <span class="keyword">new</span> <span class="title class_">SuanCaiBaoZi</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;dousha&quot;</span>:</span><br><span class="line">            baoZi = <span class="keyword">new</span> <span class="title class_">DouShaBaoZi</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;pork&quot;</span>:</span><br><span class="line">            baoZi = <span class="keyword">new</span> <span class="title class_">PorkBaoZi</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Invalid BaoZi Type&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å‡†å¤‡ææ–™</span></span><br><span class="line">    baoZi.prepare();</span><br><span class="line">    <span class="comment">//åˆ¶ä½œåŒ…å­</span></span><br><span class="line">    baoZi.make();</span><br><span class="line">    <span class="comment">//è’¸åŒ…å­</span></span><br><span class="line">    baoZi.braise();</span><br><span class="line">    <span class="keyword">return</span> baoZi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230531172315922.png" alt="image-20230531172315922"></p><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.ä¼ ç»Ÿæ¨¡å¼</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">traditonal</span><span class="params">()</span>&#123;</span><br><span class="line">    SaleBaoZi saleBaoZi=<span class="keyword">new</span> <span class="title class_">SaleBaoZi</span>();</span><br><span class="line">    <span class="comment">//ä»¥çŒªè‚‰åŒ…ä¸ºä¾‹</span></span><br><span class="line">    saleBaoZi.createBaoZi(<span class="string">&quot;pork&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h2><blockquote><p><strong>ç®€å•å·¥ç¨‹æ ¹æ®å®¢æˆ·ç«¯çš„éœ€æ±‚åˆ›å»ºå…·ä½“çš„å®ä¾‹ï¼Œè¿™ç§æ¨¡å¼å¯¹è°ƒç”¨è€…<code>éšè—äº†å®ä¾‹åˆ›å»ºçš„è¿‡ç¨‹</code>ï¼Œä¹Ÿä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ å®¹æ˜“ç»´æŠ¤ã€‚</strong></p></blockquote><p>è¿˜æ˜¯ä»¥å–åŒ…å­ä¸ºä¾‹ï¼Œç®€å•å·¥å‚æ¨¡å¼å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2.ç®€å•å·¥å‚æ–¹æ³•:å¸Œæœ›èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä½†åˆ›å»ºè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¸Œæœ›å¯¹å¤–éšè—è¿™äº›ç»†èŠ‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleFactory</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">(String type)</span>&#123;</span><br><span class="line"> </span><br><span class="line">        BaoZi baoZi=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (type)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;suancai&quot;</span>:</span><br><span class="line">                baoZi=<span class="keyword">new</span> <span class="title class_">SuanCaiBaoZi</span>(<span class="string">&quot;é…¸èœåŒ…&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;dousha&quot;</span>:</span><br><span class="line">                baoZi=<span class="keyword">new</span> <span class="title class_">DouShaBaoZi</span>(<span class="string">&quot;è±†æ²™åŒ…&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;lajioa&quot;</span>:</span><br><span class="line">                baoZi=<span class="keyword">new</span> <span class="title class_">PorkBaoZi</span>(<span class="string">&quot;çŒªè‚‰åŒ…&quot;</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;beef&quot;</span>:</span><br><span class="line">                <span class="comment">//è€æ¿æ‹“å±•ä¸šåŠ¡äº†ï¼Œæ–°åŠ äº†ä¸€ä¸ªç‰›è‚‰åŒ…ç±»å‹çš„åŒ…å­ï¼Œé‚£å¯¹äºç®€å•å·¥å‚æ¨¡å¼è€Œè¨€ï¼Œ</span></span><br><span class="line">                <span class="comment">//äºæ˜¯å°±å¾—ä¿®æ”¹æºä»£ç ï¼Œé‚£ä¹ˆå°±è¿åäº†ocpåŸåˆ™ï¼Œå‡å¦‚æ–°å¢100ä¸ªï¼Ÿ</span></span><br><span class="line">                baoZi=<span class="keyword">new</span> <span class="title class_">BeefBaoZi</span>(<span class="string">&quot;ç‰›è‚‰åŒ…&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Invalid BaoZi Type&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> baoZi;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://www.naste.top:9000/images/image-20230531172545428.png" alt="image-20230531172545428"></p><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.ç®€å•å·¥å‚æ¨¡å¼</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">simpleFactory</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//ä»¥çŒªè‚‰åŒ…ä¸ºä¾‹</span></span><br><span class="line">    <span class="type">BaoZi</span> <span class="variable">pork</span> <span class="operator">=</span> SimpleFactory.createBaoZi(<span class="string">&quot;pork&quot;</span>);</span><br><span class="line">    pork.prepare();</span><br><span class="line">    pork.make();</span><br><span class="line">    pork.braise();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> ç›¸æ¯”ä¼ ç»Ÿæ¨¡å¼ï¼Œä»ç±»å›¾ä¸Šå°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨saleå’Œbaoziä¸­é—´åˆ<code>åŠ äº†ä¸€å±‚</code></p><p> é€šè¿‡å°è£…SimpleFactoryè¿™ä¸ªç±»ï¼Œæˆ‘ä»¬å°†saleå’Œbaoziè¿›è¡Œäº†è§£è€¦åˆã€‚</p></blockquote><h2 id="æ–¹æ³•å·¥å‚æ¨¡å¼"><a href="#æ–¹æ³•å·¥å‚æ¨¡å¼" class="headerlink" title="æ–¹æ³•å·¥å‚æ¨¡å¼"></a>æ–¹æ³•å·¥å‚æ¨¡å¼</h2><p>ç®€å•å·¥å‚æ¨¡å¼ä¸‹ï¼Œå¦‚æœè€æ¿æ‹“å±•ä¸šåŠ¡äº†ï¼ŒåŠ äº†ä¸€ä¸ªç‰›è‚‰ç§ç±»çš„åŒ…å­ï¼Œå°±å¾—åœ¨æºç åŸºç¡€ä¸Šä¿®æ”¹ï¼Œé‚£ä¹ˆè¿™å°±è¿èƒŒäº†<code>å¼€é—­åŸåˆ™ï¼ˆocpï¼‰</code>ï¼Œå³å¯¹<code>æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</code>ã€‚äºæ˜¯ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±åˆäº†å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚</p><blockquote><p><strong>å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§æ›´åŠ æŠ½è±¡çš„å·¥å‚æ¨¡å¼ï¼Œå®ƒå°†å·¥å‚çš„èŒè´£æŠ½è±¡ä¸ºæ¥å£ï¼Œç”±å…·ä½“çš„å·¥å‚å®ç°åˆ›å»ºå…·ä½“çš„å¯¹è±¡ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å¼±åŒ–äº†å·¥å‚çš„å®ç°ï¼Œä½¿å¾—<code>æ¯ä¸ªå·¥å‚åªè´Ÿè´£ä¸€ä¸ªäº§å“çš„åˆ›å»ºã€‚</code></strong></p></blockquote><p>æŠ½è±¡å·¥å‚MeAbStractFactoryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MeAbstractFactory</span> &#123;</span><br><span class="line">    BaoZi <span class="title function_">createBaoZi</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DouShaFactoryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DouShaFactory</span> <span class="keyword">implements</span> <span class="title class_">MeAbstractFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DouShaBaoZi</span>(<span class="string">&quot;è±†æ²™åŒ…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SuanCaiFactoryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuanCaiFactory</span> <span class="keyword">implements</span> <span class="title class_">MeAbstractFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PorkBaoZi</span>(<span class="string">&quot;é…¸èœåŒ…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>LaJiaoFactoryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuanCaiFactory</span> <span class="keyword">implements</span> <span class="title class_">MeAbstractFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PorkBaoZi</span>(<span class="string">&quot;è¾£æ¤’åŒ…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶çš„ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://www.naste.top:9000/images/image-20230531173424995.png" alt="image-20230531173424995"></p><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">methodFactory</span><span class="params">()</span>&#123;</span><br><span class="line">    MeAbstractFactory factory=<span class="keyword">new</span> <span class="title class_">PorkFactory</span>();</span><br><span class="line">    <span class="type">BaoZi</span> <span class="variable">pork</span> <span class="operator">=</span> factory.createBaoZi();</span><br><span class="line">    pork.prepare();</span><br><span class="line">    pork.make();</span><br><span class="line">    pork.braise();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¹‹å‰çš„SimpleFactoryåœ¨createBaoZiä¸­ç›´æ¥å°±newå‡ºæ¥äº†ï¼Œä½†åœ¨æ–¹æ³•å·¥å‚ä¸­ï¼Œæˆ‘ä»¬å°†createBaoZiè¿™ä¸ªåŠ¨ä½œæ¨è¿Ÿåˆ°äº†MeAbStactFactoryçš„å­ç±»ï¼ˆXXFactoryï¼‰ä¸­æ‰å®Œæˆã€‚å¥½å¤„å°±æ˜¯ï¼Œæ¯”å¦‚åæœŸè¦å–ä¸ªç¾Šè‚‰åŒ…ï¼Œæˆ‘ä»¬ç›´æ¥ç¼–å†™ä¸ªç¾Šè‚‰åŒ…ç±»ï¼Œç„¶åå®ç°MeAbstractFactoryç±»å°±ï¼Œå®ç°å®ƒè‡ªå·±çš„åŠŸèƒ½ï¼Œè¿™æ ·å®Œå…¨ä¸ç”¨ä¿®æ”¹åŸæ¥çš„ä»£ç äº†ï¼Œä¹Ÿå°±è§£å†³äº†è¿åOCPåŸåˆ™çš„é—®é¢˜ã€‚</p></blockquote><h2 id="æŠ½è±¡å·¥å‚"><a href="#æŠ½è±¡å·¥å‚" class="headerlink" title="æŠ½è±¡å·¥å‚"></a>æŠ½è±¡å·¥å‚</h2><blockquote><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯åŸºäºå·¥å‚æ–¹æ³•æ¨¡å¼çš„åŸºç¡€ä¸Šè¿›è¡Œçš„ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œæ¯ä¸€ä¸ªå·¥å‚ä¸å†åªè´Ÿè´£ä¸€ä¸ªäº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯è´Ÿè´£<code>ä¸€ç»„äº§å“çš„</code>åˆ›å»ºã€‚æŠ½è±¡å·¥å‚æ¨¡å¼å°†æ¯ä¸ªäº§å“ç»„éƒ½æå–ä¸ºä¸€ä¸ªæ¥å£ï¼Œæ¯ä¸ªå·¥å‚éƒ½è´Ÿè´£ä¸€ä¸ªäº§å“ç»„ã€‚</p></blockquote><p>å‡å¦‚è€æ¿çš„ç”Ÿæ„åšå¤§äº†ï¼Œåœ¨åŒ—äº¬å¼€äº†ä¸ªåˆ†åº—ï¼Œå¹¶ä¸”ä¸æ­¢å–åŒ…å­ï¼Œè¿˜å–è›‹ç³•ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆæ‹“å±•å‘¢ï¼Œå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨æŠ½è±¡å·¥å‚ç±»ä¸­æ–°å¢åˆ›å»ºè›‹ç³•çš„æŠ½è±¡æ–¹æ³•å°±è¡Œï¼Œå¦‚ä¸‹ï¼š</p><p>AbstractFactoryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AbstractFactory</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ¶ä½œåŒ…å­</span></span><br><span class="line">    BaoZi <span class="title function_">createBaoZi</span><span class="params">(String type)</span>;</span><br><span class="line">    <span class="comment">//åˆ¶ä½œè›‹ç³•</span></span><br><span class="line">    Cake <span class="title function_">createCake</span><span class="params">(String type)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>BJFactoryï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//åŒ—äº¬åˆ†åº—</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BJFactory</span> <span class="keyword">implements</span> <span class="title class_">AbstractFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> BaoZi <span class="title function_">createBaoZi</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        BaoZi baoZi=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (type)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;suancai&quot;</span>:</span><br><span class="line">                baoZi=<span class="keyword">new</span> <span class="title class_">BJSuanCaiBao</span>(<span class="string">&quot;åŒ—äº¬é…¸èœåŒ…&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;lajioa&quot;</span>:</span><br><span class="line">                baoZi=<span class="keyword">new</span> <span class="title class_">BJLaJiaoBao</span>(<span class="string">&quot;åŒ—äº¬è¾£æ¤’åŒ…&quot;</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> baoZi;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Cake <span class="title function_">createCake</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        Cake cake=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (type)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;apple&quot;</span>:</span><br><span class="line">                cake=<span class="keyword">new</span> <span class="title class_">BJAppleCake</span>(<span class="string">&quot;åŒ—äº¬è‹¹æœè›‹ç³•&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;pear&quot;</span>:</span><br><span class="line">                cake=<span class="keyword">new</span> <span class="title class_">BJPearCake</span>(<span class="string">&quot;åŒ—äº¬æ¢¨å‘³è›‹ç³•&quot;</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cake;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥çœ‹åˆ°ï¼ŒæŠ½è±¡å·¥å‚ä»…ä»…æ˜¯åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸‹æ–°å¢äº†ä¸€äº›æ¥å£ï¼Œåªæ˜¯å·¥å‚æ¨¡å¼çš„ä¸€ä¸ªæ‹“å±•ï¼Œå½“æŠ½è±¡å·¥å‚åªæœ‰ä¸€ä¸ªäº§å“ä½“ç³»çš„è¯å°±ä¼šé€€åŒ–æˆå·¥å‚æ¨¡å¼ï¼Œæ‰€ä»¥ä¸¤è€…æœ¬è´¨ä¸Šæ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ã€‚</p></blockquote><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">abstractFactory</span><span class="params">()</span>&#123;</span><br><span class="line">    AbstractFactory factory=<span class="keyword">new</span> <span class="title class_">BJFactory</span>();</span><br><span class="line">    <span class="type">Cake</span> <span class="variable">apple</span> <span class="operator">=</span> factory.createCake(<span class="string">&quot;apple&quot;</span>);</span><br><span class="line">    <span class="type">BaoZi</span> <span class="variable">pork</span> <span class="operator">=</span> factory.createBaoZi(<span class="string">&quot;pork&quot;</span>);</span><br><span class="line"></span><br><span class="line">    apple.prepare();</span><br><span class="line">    apple.make();</span><br><span class="line">    apple.bake();</span><br><span class="line">    apple.sale();</span><br><span class="line"></span><br><span class="line">    pork.prepare();</span><br><span class="line">    pork.make();</span><br><span class="line">    pork.braise();</span><br><span class="line">    pork.sale();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="ç®€å•å·¥å‚æ¨¡å¼-1"><a href="#ç®€å•å·¥å‚æ¨¡å¼-1" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h2><ul><li><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç®€å•å·¥å‚æ¨¡å¼å®ç°ç®€å•ï¼Œæ˜“äºç†è§£å’Œä½¿ç”¨ï¼›</li><li>å¯ä»¥å¯¹å¯¹è±¡çš„åˆ›å»ºè¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œå®¢æˆ·ç«¯å’Œå…·ä½“å®ç°è§£è€¦ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>å·¥å‚ç±»è´Ÿè´£åˆ›å»ºæ‰€æœ‰å¯¹è±¡ï¼Œå¦‚æœéœ€è¦æ·»åŠ æ–°ç±»å‹çš„äº§å“ï¼Œåˆ™éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç ï¼Œè¿™è¿åäº†å¼€é—­åŸåˆ™ï¼›</li><li>å·¥å‚ç±»èŒè´£è¿‡é‡ï¼Œå¯¼è‡´å•ä¸€èŒè´£åŸåˆ™è¢«ç ´åã€‚</li></ul></li><li>é€‚ç”¨åœºæ™¯ï¼š<ul><li>å·¥å‚ç±»è´Ÿè´£åˆ›å»ºçš„å¯¹è±¡è¾ƒå°‘ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼›</li><li>å®¢æˆ·ç«¯éœ€è¦æ ¹æ®ä¼ é€’çš„å‚æ•°æ¥è·å–å¯¹åº”çš„å¯¹è±¡ã€‚</li></ul></li></ul><h2 id="æ–¹æ³•å·¥å‚æ¨¡å¼-1"><a href="#æ–¹æ³•å·¥å‚æ¨¡å¼-1" class="headerlink" title="æ–¹æ³•å·¥å‚æ¨¡å¼"></a>æ–¹æ³•å·¥å‚æ¨¡å¼</h2><ul><li><p>ä¼˜ç‚¹ï¼š </p><ul><li>æ–¹æ³•å·¥å‚æ¨¡å¼å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼Œå¦‚æœéœ€è¦æ·»åŠ æ–°ç±»å‹çš„äº§å“ï¼Œåªéœ€è¦æ·»åŠ å¯¹åº”çš„å·¥å‚æ–¹æ³•å³å¯ï¼›</li><li>ä¸ç®€å•å·¥å‚æ¨¡å¼ç›¸æ¯”ï¼Œæ–¹æ³•å·¥å‚æ¨¡å¼æ›´ç¬¦åˆå¼€é—­åŸåˆ™å’Œå•ä¸€èŒè´£åŸåˆ™ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>éœ€è¦å®¢æˆ·ç«¯è‡ªè¡Œé€‰æ‹©ä½¿ç”¨å“ªä¸ªå·¥å‚æ–¹æ³•ï¼Œä¸èƒ½åƒç®€å•å·¥å‚æ¨¡å¼é‚£æ ·ç›´æ¥ä¼ å‚è·å–å¯¹åº”å¯¹è±¡ï¼Œå› æ­¤å¯¹å®¢æˆ·ç«¯çš„ç¼–å†™æœ‰ä¸€å®šè¦æ±‚ã€‚</li></ul></li><li>é€‚ç”¨åœºæ™¯ï¼š<ul><li>åº”ç”¨ä¸­éœ€è¦åˆ›å»ºçš„å¯¹è±¡è¾ƒå°‘ï¼Œä½†æ˜¯éœ€è¦å…·å¤‡è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼›</li><li>å®¢æˆ·ç«¯å¯ä»¥è‡ªè¡Œé€‰æ‹©åˆ›å»ºå“ªç§å¯¹è±¡ã€‚</li></ul></li></ul><h2 id="æŠ½è±¡å·¥å‚-1"><a href="#æŠ½è±¡å·¥å‚-1" class="headerlink" title="æŠ½è±¡å·¥å‚"></a>æŠ½è±¡å·¥å‚</h2><ul><li><p>ä¼˜ç‚¹ï¼š</p><ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥åˆ›å»ºå¤šä¸ªäº§å“æ—çš„äº§å“ï¼Œè¿™äº›äº§å“ä¹‹é—´æœ‰ç›¸äº’ä¾èµ–æˆ–çº¦æŸå…³ç³»ï¼Œæœ‰åŠ©äºä¿æŒç³»ç»Ÿçš„ä¸€è‡´æ€§å’Œç¨³å®šæ€§ï¼›</li><li>å®¢æˆ·ç«¯ä¸å…·ä½“äº§å“è§£è€¦ï¼Œé€šè¿‡äº§å“æ—çš„æ–¹å¼è¿›è¡Œç®¡ç†ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼å¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦ï¼Œä¸æ˜“äºç†è§£å’Œä¿®æ”¹ï¼›</li><li>æ–°å¢äº§å“æ—æ—¶éœ€è¦ä¿®æ”¹å·¥å‚æ¥å£ã€å·¥å‚å®ç°ç±»å’Œäº§å“ç±»ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li></ul></li><li>é€‚ç”¨åœºæ™¯ï¼š<ul><li>ç³»ç»Ÿéœ€è¦ä¸€ç³»åˆ—ç›¸äº’ä¾èµ–æˆ–çº¦æŸçš„äº§å“ï¼›</li><li>å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“å…·ä½“äº§å“çš„åˆ›å»ºè¿‡ç¨‹ï¼Œåªéœ€è¦çŸ¥é“äº§å“æ—å³å¯ã€‚</li></ul></li></ul>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼</summary>
    
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å·¥å‚æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-ç­–ç•¥æ¨¡å¼</title>
    <link href="https://www.naste.top:1024/posts/3353504920.html"/>
    <id>https://www.naste.top:1024/posts/3353504920.html</id>
    <published>2023-05-30T12:01:02.000Z</published>
    <updated>2023-06-18T06:06:56.439Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><h2 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h2><p>å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ï¼š<a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1281319170474017">https://www.liaoxuefeng.com/wiki/1252599548343744/1281319170474017</a></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p><a href="https://gitee.com/xiao-i-fei/xiaofei-design-mode">https://gitee.com/xiao-i-fei/xiaofei-design-mode</a></p><p><a href="https://github.com/xiao-i-fei/xiaofei-design-mode">https://github.com/xiao-i-fei/xiaofei-design-mode</a></p><h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><ul><li>é£Ÿè°±ä¸­çš„ä¸åŒçƒ¹é¥ªæ–¹æ³•ï¼šåœ¨åšèœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„çƒ¹é¥ªæ–¹æ³•æ¥åˆ¶ä½œç¾é£Ÿã€‚æ¯”å¦‚ç…®ã€ç‚’ã€çƒ¤ã€è’¸ç­‰ã€‚è¿™äº›çƒ¹é¥ªæ–¹æ³•å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„çƒ¹é¥ªæ–¹æ³•æ¥åˆ¶ä½œä¸åŒçš„èœå“ã€‚</li><li>è´­ç‰©æ¸…å•ä¸­çš„ä¸åŒè´­ä¹°ç­–ç•¥ï¼šåœ¨è´­ç‰©æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„è´­ä¹°ç­–ç•¥æ¥è·å–æ›´å¥½çš„ä¼˜æƒ å’Œå•†å“ã€‚æ¯”å¦‚æ‰“æŠ˜ã€æ»¡å‡ã€å›¢è´­ç­‰ã€‚è¿™äº›è´­ä¹°ç­–ç•¥å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„è´­ä¹°ç­–ç•¥æ¥è·å–æ›´å¥½çš„è´­ç‰©ä½“éªŒã€‚</li><li>æ—…æ¸¸è·¯çº¿è§„åˆ’ä¸­çš„ä¸åŒäº¤é€šæ–¹å¼ï¼šåœ¨æ—…æ¸¸æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¸åŒçš„äº¤é€šæ–¹å¼ï¼Œæ¯”å¦‚é£æœºã€ç«è½¦ã€æ±½è½¦ã€è‡ªé©¾ç­‰ã€‚è¿™äº›äº¤é€šæ–¹å¼å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„äº¤é€šæ–¹å¼æ¥è§„åˆ’æ—…æ¸¸è·¯çº¿ã€‚</li><li>å¥èº«è®¡åˆ’ä¸­çš„ä¸åŒè®­ç»ƒæ–¹å¼ï¼šåœ¨å¥èº«æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¸åŒçš„è®­ç»ƒæ–¹å¼æ¥è¾¾åˆ°é”»ç‚¼æ•ˆæœã€‚æ¯”å¦‚æœ‰æ°§è¿åŠ¨ã€åŠ›é‡è®­ç»ƒã€ç‘œä¼½ç­‰ã€‚è¿™äº›è®­ç»ƒæ–¹å¼å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„è®­ç»ƒæ–¹å¼æ¥åˆ¶å®šè‡ªå·±çš„å¥èº«è®¡åˆ’ã€‚</li><li>éŸ³ä¹æ¨èç³»ç»Ÿä¸­çš„ä¸åŒæ­Œæ›²æ¨èç­–ç•¥ï¼šåœ¨å¬æ­Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ­Œæ›²æ¨èç­–ç•¥æ¥å‘ç°æ–°çš„éŸ³ä¹ã€‚æ¯”å¦‚åŸºäºç›¸ä¼¼åº¦ã€åŸºäºçƒ­åº¦ã€åŸºäºæ—¶é—´ç­‰ã€‚è¿™äº›æ¨èç­–ç•¥å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„æ­Œæ›²æ¨èç­–ç•¥æ¥å‘ç°æ›´å¤šçš„å¥½æ­Œã€‚</li><li>ç¤¾äº¤ç½‘ç»œä¸­çš„ä¸åŒå¥½å‹æ¨èç®—æ³•ï¼šåœ¨ç¤¾äº¤ç½‘ç»œä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å¥½å‹æ¨èç®—æ³•æ¥å‘ç°æ–°çš„æœ‹å‹ã€‚æ¯”å¦‚åŸºäºå…´è¶£ã€åŸºäºå…±åŒå¥½å‹ã€åŸºäºåœ°ç†ä½ç½®ç­‰ã€‚è¿™äº›æ¨èç®—æ³•å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„å¥½å‹æ¨èç®—æ³•æ¥æ‰©å¤§è‡ªå·±çš„ç¤¾äº¤åœˆã€‚</li><li>äººè„¸è¯†åˆ«ä¸­çš„ä¸åŒç‰¹å¾æå–ç®—æ³•ï¼šåœ¨äººè„¸è¯†åˆ«ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ç‰¹å¾æå–ç®—æ³•æ¥è¯†åˆ«äººè„¸ã€‚æ¯”å¦‚LBPã€HOGã€Eigenfaceç­‰ã€‚è¿™äº›ç‰¹å¾æå–ç®—æ³•å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç³»ç»Ÿé€‰æ‹©ä¸åŒçš„ç‰¹å¾æå–ç®—æ³•æ¥æé«˜äººè„¸è¯†åˆ«çš„å‡†ç¡®æ€§ã€‚</li><li>è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„ä¸åŒæ–‡æœ¬æ¸…æ´—ç®—æ³•ï¼šåœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ–‡æœ¬æ¸…æ´—ç®—æ³•æ¥å¤„ç†æ–‡æœ¬æ•°æ®ã€‚æ¯”å¦‚å»é™¤HTMLæ ‡ç­¾ã€å»é™¤ç‰¹æ®Šå­—ç¬¦ã€åˆ†è¯ç­‰ã€‚è¿™äº›æ–‡æœ¬æ¸…æ´—ç®—æ³•å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç³»ç»Ÿé€‰æ‹©ä¸åŒçš„æ–‡æœ¬æ¸…æ´—ç®—æ³•æ¥æé«˜è‡ªç„¶è¯­è¨€å¤„ç†çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚</li><li>èµ„æºç®¡ç†ä¸­çš„ä¸åŒæƒé™æ§åˆ¶ç­–ç•¥ï¼šåœ¨èµ„æºç®¡ç†ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æƒé™æ§åˆ¶ç­–ç•¥æ¥é™åˆ¶ä¸åŒç”¨æˆ·çš„æ“ä½œæƒé™ã€‚æ¯”å¦‚ç®¡ç†å‘˜æ‹¥æœ‰æœ€é«˜æƒé™ï¼Œæ™®é€šç”¨æˆ·åªæœ‰éƒ¨åˆ†æƒé™ã€‚è¿™äº›æƒé™æ§åˆ¶ç­–ç•¥å¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç³»ç»Ÿé€‰æ‹©ä¸åŒçš„æƒé™æ§åˆ¶ç­–ç•¥æ¥ä¿æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚</li><li>æ¸¸æˆAIä¸­çš„ä¸åŒè¡Œä¸ºç­–ç•¥ï¼šåœ¨æ¸¸æˆä¸­ï¼Œè§’è‰²çš„è¡Œä¸ºå¯ä»¥çœ‹ä½œæ˜¯ä¸åŒçš„ç®—æ³•ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©æ¸¸æˆå¼€å‘è€…å°è£…ä¸åŒçš„è¡Œä¸ºç­–ç•¥ï¼Œè®©ç©å®¶å¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„è§’è‰²è¡Œä¸ºã€‚</li><li>æ¸¸æˆå¼€å‘ä¸­çš„ä¸åŒæ¸¸æˆéš¾åº¦è®¾ç½®ï¼šç­–ç•¥æ¨¡å¼å¯ä»¥ç”¨äºå®šä¹‰ä¸€ç³»åˆ—çš„æ¸¸æˆéš¾åº¦é€‰é¡¹ï¼Œæ¯”å¦‚ç®€å•ã€æ™®é€šã€å›°éš¾ç­‰ã€‚æ¯ä¸ªéš¾åº¦é€‰é¡¹éƒ½æœ‰ä¸åŒçš„æ¸¸æˆè§„åˆ™å’Œæ“ä½œæ–¹å¼ï¼Œç©å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©ä¸åŒçš„éš¾åº¦ç­‰çº§æ¥ä½“éªŒæ¸¸æˆã€‚</li><li>æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥ï¼šåœ¨å¤§å‹æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…ä¸åŒçš„æŸ¥è¯¢ç®—æ³•ï¼Œæ¯”å¦‚å…¨è¡¨æ‰«æã€ç´¢å¼•æ‰«æã€åˆ†åŒºæŸ¥è¯¢ç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯ä»£ç ä¸å…·ä½“çš„æŸ¥è¯¢ç®—æ³•è§£è€¦ï¼ŒåŒæ—¶æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</li><li>å›¾åƒå¤„ç†ä¸­çš„ä¸åŒæ»¤é•œæ•ˆæœï¼šæ»¤é•œæ˜¯å›¾åƒå¤„ç†ä¸­å¸¸ç”¨çš„ä¸€ç§æ•ˆæœï¼Œæ¯”å¦‚æ¨¡ç³Šã€é”åŒ–ã€è‰²å½©è°ƒæ•´ç­‰ã€‚ç­–ç•¥æ¨¡å¼å¯ä»¥å°†è¿™äº›æ»¤é•œç®—æ³•å°è£…èµ·æ¥ï¼Œè®©å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä¸åŒçš„æ»¤é•œæ•ˆæœï¼Œè€Œä¸ç”¨å…³å¿ƒå…·ä½“çš„å®ç°ç»†èŠ‚ã€‚</li><li>ç½‘ç»œé€šä¿¡ä¸­çš„æ•°æ®å‹ç¼©ç®—æ³•ï¼šåœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼Œæ•°æ®ä¼ è¾“çš„æ•ˆç‡éå¸¸é‡è¦ã€‚å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…ä¸åŒçš„å‹ç¼©ç®—æ³•ï¼Œæ¯”å¦‚gzipã€deflateç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„å‹ç¼©ç®—æ³•æ¥æé«˜ä¼ è¾“æ•ˆç‡ã€‚</li><li>æœºå™¨å­¦ä¹ ä¸­çš„ä¸åŒåˆ†ç±»å™¨ç®—æ³•ï¼šåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œåˆ†ç±»å™¨æ˜¯ä¸€ç§å¸¸ç”¨çš„æ¨¡å‹ã€‚å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…ä¸åŒçš„åˆ†ç±»å™¨ç®—æ³•ï¼Œæ¯”å¦‚å†³ç­–æ ‘ã€æ”¯æŒå‘é‡æœºã€ç¥ç»ç½‘ç»œç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯é€‰æ‹©ä¸åŒçš„åˆ†ç±»å™¨ç®—æ³•æ¥é€‚åº”ä¸åŒçš„æ•°æ®é›†å’Œä»»åŠ¡éœ€æ±‚ã€‚</li><li>è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„ä¸åŒæ–‡æœ¬è§£æç®—æ³•ï¼šè‡ªç„¶è¯­è¨€å¤„ç†æ˜¯ä¸€é¡¹å¤æ‚çš„ä»»åŠ¡ï¼Œéœ€è¦ä½¿ç”¨å¤šç§æ–‡æœ¬è§£æç®—æ³•æ¥å®ç°ã€‚å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…è¿™äº›ç®—æ³•ï¼Œå¦‚æ­£åˆ™è¡¨è¾¾å¼ã€è¯æ€§æ ‡æ³¨ã€å‘½åå®ä½“è¯†åˆ«ç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯é€‰æ‹©ä¸åŒçš„è§£æç®—æ³•æ¥é€‚åº”ä¸åŒçš„æ–‡æœ¬æ ¼å¼å’Œä»»åŠ¡éœ€æ±‚ã€‚</li><li>æ“ä½œç³»ç»Ÿä¸­çš„è¿›ç¨‹è°ƒåº¦ç­–ç•¥ï¼šåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹è°ƒåº¦æ˜¯ä¸€ä¸ªé‡è¦çš„ä»»åŠ¡ã€‚å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…ä¸åŒçš„è°ƒåº¦ç®—æ³•ï¼Œå¦‚å…ˆæ¥å…ˆæœåŠ¡(FCFS)ã€æœ€çŸ­ä½œä¸šä¼˜å…ˆ(SJF)ã€ä¼˜å…ˆçº§è°ƒåº¦ç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯é€‰æ‹©ä¸åŒçš„è°ƒåº¦ç­–ç•¥æ¥é€‚åº”ä¸åŒçš„ç³»ç»Ÿè´Ÿè½½å’Œä»»åŠ¡éœ€æ±‚ã€‚</li><li>å®‰å…¨åŠ å¯†ä¸­çš„ä¸åŒåŠ å¯†ç®—æ³•ï¼šåœ¨å®‰å…¨åŠ å¯†ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„åŠ å¯†ç®—æ³•æ¥ä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§ã€‚å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…è¿™äº›ç®—æ³•ï¼Œå¦‚å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ã€å“ˆå¸Œç®—æ³•ç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯é€‰æ‹©ä¸åŒçš„åŠ å¯†ç®—æ³•æ¥é€‚åº”ä¸åŒçš„å®‰å…¨éœ€æ±‚ã€‚</li><li>èµ„æºç®¡ç†ä¸­çš„ä¸åŒåˆ†é…ç­–ç•¥ï¼šåœ¨èµ„æºç®¡ç†ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…ä¸åŒçš„åˆ†é…ç®—æ³•ï¼Œå¦‚å…¬å¹³åˆ†é…ã€è½®æµåˆ†é…ã€ä¼˜å…ˆçº§åˆ†é…ç­‰ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯é€‰æ‹©ä¸åŒçš„åˆ†é…ç­–ç•¥æ¥é€‚åº”ä¸åŒçš„åœºæ™¯éœ€æ±‚ã€‚</li><li>å†³ç­–æ ‘ç®—æ³•ä¸­ä¸åŒçš„åˆ’åˆ†ç­–ç•¥ï¼šåœ¨å†³ç­–æ ‘ç®—æ³•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„åˆ’åˆ†ç­–ç•¥æ¥ç¡®å®šæ ‘çš„ç»“æ„å’Œå¶å­èŠ‚ç‚¹çš„ä½ç½®ã€‚å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…è¿™äº›ç­–ç•¥ï¼Œå¦‚ID3ã€C4.5ç­‰å¸¸è§çš„å†³ç­–æ ‘ç®—æ³•ã€‚è¿™æ ·å¯ä»¥è®©å®¢æˆ·ç«¯é€‰æ‹©ä¸åŒçš„åˆ’åˆ†ç­–ç•¥æ¥é€‚åº”ä¸åŒçš„æ•°æ®é›†å’Œä»»åŠ¡éœ€æ±‚ã€‚</li></ul><h1 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h1><blockquote><p><strong>Spring Bootä¸­ä½¿ç”¨ç­–ç•¥æ¨¡å¼</strong></p></blockquote><p><img src="https://www.naste.top:9000/webp/image-20221127223516181.webp" alt="image-20221127223516181"></p><h2 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨é…ç½®æ–‡ä»¶ä¸­é€‰æ‹©</span></span><br><span class="line"><span class="attr">strategy:</span></span><br><span class="line">  <span class="attr">upload:</span> <span class="string">ali-yun-oss</span></span><br></pre></td></tr></table></figure><h2 id="autoconfigure"><a href="#autoconfigure" class="headerlink" title="autoconfigure"></a>autoconfigure</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;strategy&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrategyModelProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ æ‰§è¡Œç­–åˆ—é€‰æ‹©</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String upload;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="enums"><a href="#enums" class="headerlink" title="enums"></a>enums</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">UploadModeEnum</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜¿é‡Œäº‘oss</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    OSS(<span class="string">&quot;ali-yun-oss&quot;</span>, <span class="string">&quot;aliYunOssUploadStrategyImpl&quot;</span>),</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ¬åœ°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    LOCAL(<span class="string">&quot;local&quot;</span>, <span class="string">&quot;localUploadStrategyImpl&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¨¡å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­–ç•¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String strategy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç­–ç•¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mode æ¨¡å¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125; æ–‡ä»¶ä¸Šä¼ æ‰§è¡Œç­–ç•¥ç­–ç•¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getStrategy</span><span class="params">(String mode)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (UploadModeEnum value : UploadModeEnum.values()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (value.getMode().equals(mode)) &#123;</span><br><span class="line">                <span class="keyword">return</span> value.getStrategy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="context"><a href="#context" class="headerlink" title="context"></a>context</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.policy.strategy.context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xiaofei.policy.autoconfigure.StrategyModelProperties;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.policy.strategy.UploadStrategy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.xiaofei.policy.enums.UploadModeEnum.getStrategy;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UploadStrategyContext</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ¨¡å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StrategyModelProperties modelProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, UploadStrategy&gt; uploadStrategyMap;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125; æ–‡ä»¶åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">executeUploadStrategy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uploadStrategyMap.get(getStrategy(modelProperties.getUpload())).uploadFile();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="strategy-interface"><a href="#strategy-interface" class="headerlink" title="strategy-interface"></a>strategy-interface</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UploadStrategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125; æ–‡ä»¶åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">uploadFile</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="strategy-interface-impl"><a href="#strategy-interface-impl" class="headerlink" title="strategy-interface-impl"></a>strategy-interface-impl</h2><blockquote><p>OSSImpl</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.xiaofei.policy.strategy.UploadStrategy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliYunOssUploadStrategyImpl</span> <span class="keyword">implements</span> <span class="title class_">UploadStrategy</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ¬åœ°æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">uploadFile</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;é˜¿é‡Œäº‘æ–‡ä»¶ä¸Šä¼ &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>LocalImpl</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalUploadStrategyImpl</span> <span class="keyword">implements</span> <span class="title class_">UploadStrategy</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ¬åœ°æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">uploadFile</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æœ¬åœ°æ–‡ä»¶ä¸Šä¼ &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="TestController"><a href="#TestController" class="headerlink" title="TestController"></a>TestController</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.xiaofei.policy.strategy.context.UploadStrategyContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UploadStrategyContext uploadStrategyContext;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uploadStrategyContext.executeUploadStrategy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå…è®¸åœ¨è¿è¡Œæ—¶é€‰æ‹©ç®—æ³•çš„è¡Œä¸ºæ–¹å¼ã€‚ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹åŒ…æ‹¬ï¼š</p><ul><li>å¯æ‰©å±•æ€§ï¼šç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°å¢åŠ ã€ä¿®æ”¹å’Œåˆ é™¤ä¸åŒç®—æ³•çš„å®ç°ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ã€‚è¿™æ ·å¯ä»¥ä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚</li><li>é«˜å†…èšæ€§ï¼šç­–ç•¥æ¨¡å¼å°†ç®—æ³•å°è£…æˆç‹¬ç«‹çš„ç­–ç•¥ç±»ï¼Œæ¯ä¸ªç®—æ³•ç±»éƒ½æœ‰è‡ªå·±çš„èŒè´£å’ŒåŠŸèƒ½ï¼Œä»è€Œæé«˜äº†ä»£ç çš„å†…èšæ€§ã€‚</li><li>å¯å¤ç”¨æ€§ï¼šç­–ç•¥æ¨¡å¼å¯ä»¥å°†ä¸åŒçš„ç®—æ³•å°è£…æˆç‹¬ç«‹çš„ç­–ç•¥ç±»ï¼Œä»è€Œå¯ä»¥åœ¨ä¸åŒçš„ç³»ç»Ÿä¸­é‡ç”¨è¿™äº›ç®—æ³•ã€‚è¿™æ ·å¯ä»¥å‡å°‘ä»£ç çš„é‡å¤æ€§ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ã€‚</li><li>æ˜“æ‰©å±•æ€§ï¼šç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„ç®—æ³•æ¥é€‚åº”ä¸åŒçš„åœºæ™¯éœ€æ±‚ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚</li><li>æ¾è€¦åˆæ€§ï¼šç­–ç•¥æ¨¡å¼å°†ç®—æ³•ä¸å®¢æˆ·ç«¯è§£è€¦ï¼Œä»è€Œå®ç°äº†ç®—æ³•ä¸å®¢æˆ·ç«¯çš„æ¾è€¦åˆã€‚è¿™æ ·å¯ä»¥æé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li></ul><p>ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹åŒ…æ‹¬ï¼š</p><ul><li>å®ç°å¤æ‚åº¦ï¼šç­–ç•¥æ¨¡å¼éœ€è¦å®ç°å¤šä¸ªç‹¬ç«‹çš„ç­–ç•¥ç±»æ¥å°è£…ä¸åŒçš„ç®—æ³•ï¼Œä»è€Œå¢åŠ äº†ç³»ç»Ÿçš„å®ç°å¤æ‚åº¦ã€‚</li><li>æ€§èƒ½æŸå¤±ï¼šç”±äºç­–ç•¥æ¨¡å¼éœ€è¦åœ¨è¿è¡Œæ—¶é€‰æ‹©ç®—æ³•çš„è¡Œä¸ºæ–¹å¼ï¼Œå› æ­¤å¯èƒ½ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½æŸå¤±ã€‚</li><li>é™åˆ¶è¾ƒå¤šï¼šç­–ç•¥æ¨¡å¼è¦æ±‚ç³»ç»Ÿä¸­å¿…é¡»æœ‰å¤šç§ç®—æ³•å¯ä¾›é€‰æ‹©ï¼Œå¦åˆ™æ— æ³•å‘æŒ¥å…¶ä¼˜åŠ¿ã€‚</li><li>éš¾ä»¥è°ƒè¯•ï¼šç”±äºç­–ç•¥æ¨¡å¼å°†ç®—æ³•å°è£…æˆäº†ç‹¬ç«‹çš„ç­–ç•¥ç±»ï¼Œå› æ­¤åœ¨å‡ºç°é—®é¢˜æ—¶å¾ˆéš¾å®šä½é—®é¢˜æ‰€åœ¨ã€‚</li></ul>]]></content>
    
    
    <summary type="html">è®¾è®¡æ¨¡å¼-ç­–ç•¥æ¨¡å¼</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ç­–ç•¥æ¨¡å¼" scheme="https://www.naste.top:1024/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>RabbitMQ</title>
    <link href="https://www.naste.top:1024/posts/3041119952.html"/>
    <id>https://www.naste.top:1024/posts/3041119952.html</id>
    <published>2023-05-21T10:36:36.000Z</published>
    <updated>2023-05-30T13:20:40.712Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[toc]</p><h1 id="å¿…è¯»"><a href="#å¿…è¯»" class="headerlink" title="å¿…è¯»"></a>å¿…è¯»</h1><blockquote><p><strong>æœ¬æ–‡æ¡£RabbitMQç‰ˆæœ¬ï¼š3.8.8</strong></p><p><strong>ç¼–ç¨‹è¯­è¨€ï¼šJava</strong></p><p><strong>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://frxcat.fun/pages/e645d9/">https://frxcat.fun/pages/e645d9/</a></strong></p><p><strong>å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1cb4y1o7zz/">https://www.bilibili.com/video/BV1cb4y1o7zz/</a></strong></p></blockquote><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><h2 id="Dockerå®‰è£…"><a href="#Dockerå®‰è£…" class="headerlink" title="Dockerå®‰è£…"></a>Dockerå®‰è£…</h2><h3 id="å•æœºéƒ¨ç½²"><a href="#å•æœºéƒ¨ç½²" class="headerlink" title="å•æœºéƒ¨ç½²"></a>å•æœºéƒ¨ç½²</h3><blockquote><p><strong>ä½¿ç”¨dockerå•æœºéƒ¨ç½²çš„RabbitMQï¼Œç”¨æˆ·åå’Œå¯†ç é»˜è®¤éƒ½ä¸º<code>guest</code>ï¼Œwebè®¿é—®åœ°å€ä¸º<code>ip+15672</code></strong></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --restart=always --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3.8.8-management</span><br></pre></td></tr></table></figure><h1 id="MQæ¦‚å¿µ"><a href="#MQæ¦‚å¿µ" class="headerlink" title="MQæ¦‚å¿µ"></a>MQæ¦‚å¿µ</h1><h2 id="ä»€ä¹ˆæ˜¯MQ"><a href="#ä»€ä¹ˆæ˜¯MQ" class="headerlink" title="ä»€ä¹ˆæ˜¯MQ"></a>ä»€ä¹ˆæ˜¯MQ</h2><p>MQ( æ¶ˆæ¯é˜Ÿåˆ— message queue )ï¼Œä»å­—é¢æ„æ€ä¸Šçœ‹ï¼Œæœ¬è´¨æ˜¯ä¸ªé˜Ÿåˆ—ï¼ŒFIFO å…ˆè¿›çš„æ•°æ®å…ˆå‡º ï¼Œåè¿›çš„æ•°æ®åå‡ºï¼Œåªä¸è¿‡é˜Ÿåˆ—ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯message è€Œå·²ï¼Œè¿˜æ˜¯</p><p>ä¸€ç§è·¨è¿›ç¨‹çš„é€šä¿¡æœºåˆ¶ï¼Œç”¨äºä¸Šä¸‹æ¸¸ä¼ é€’æ¶ˆæ¯ã€‚åœ¨äº’è”ç½‘æ¶æ„ä¸­ï¼ŒMQ æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„ä¸Šä¸‹æ¸¸<code>é€»è¾‘è§£è€¦ + ç‰©ç†è§£è€¦</code>çš„æ¶ˆæ¯é€šä¿¡æœåŠ¡ã€‚ä½¿ç”¨äº† MQ ä¹‹åï¼Œæ¶ˆæ¯å‘</p><p>é€ä¸Šæ¸¸åªéœ€è¦ä¾èµ– MQï¼Œä¸ç”¨ä¾èµ–å…¶ä»–æœåŠ¡ã€‚ </p><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨MQ"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨MQ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨MQ"></a>ä¸ºä»€ä¹ˆè¦ç”¨MQ</h2><ol><li><p>æµé‡æ¶ˆå³°</p><p> ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè®¢å•ç³»ç»Ÿæœ€å¤šèƒ½å¤„ç†ä¸€ä¸‡æ¬¡è®¢å•ï¼Œè¿™ä¸ªå¤„ç†èƒ½åŠ›åº”ä»˜æ­£å¸¸æ—¶æ®µçš„ä¸‹å•æ—¶ç»°ç»°æœ‰ä½™ï¼Œæ­£å¸¸æ—¶æ®µæˆ‘ä»¬ä¸‹å•ä¸€ç§’åå°±èƒ½è¿”å›ç»“æœã€‚ä½†æ˜¯åœ¨é«˜å³°æœŸï¼Œå¦‚æœæœ‰ä¸¤ä¸‡æ¬¡ä¸‹å•æ“ä½œç³»ç»Ÿæ˜¯å¤„ç†ä¸äº†çš„ï¼Œåªèƒ½é™åˆ¶è®¢å•è¶…è¿‡ä¸€ä¸‡åä¸å…è®¸ç”¨æˆ·ä¸‹å•ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—åšç¼“å†²ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆè¿™ä¸ªé™åˆ¶ï¼ŒæŠŠä¸€ç§’å†…ä¸‹çš„è®¢å•åˆ† æ•£æˆä¸€æ®µæ—¶é—´æ¥å¤„ç†ï¼Œè¿™æ—¶æœ‰äº›ç”¨æˆ·å¯èƒ½åœ¨ä¸‹å•åå‡ ç§’åæ‰èƒ½æ”¶åˆ°ä¸‹å•æˆåŠŸçš„æ“ä½œï¼Œä½†æ˜¯æ¯”ä¸èƒ½ä¸‹å•çš„ä½“éªŒè¦å¥½ã€‚</p></li><li><p>åº”ç”¨è§£è€¦</p><p> ä»¥ç”µå•†åº”ç”¨ä¸ºä¾‹ï¼Œåº”ç”¨ä¸­æœ‰è®¢å•ç³»ç»Ÿã€åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿã€‚ç”¨æˆ·åˆ›å»ºè®¢å•åï¼Œå¦‚æœè€¦åˆè°ƒç”¨åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªå­ç³»ç»Ÿå‡ºäº†æ•…éšœï¼Œéƒ½ä¼šé€ æˆä¸‹å•æ“ä½œå¼‚å¸¸ã€‚å½“è½¬å˜æˆåŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼åï¼Œç³»ç»Ÿé—´è°ƒç”¨çš„é—®é¢˜ä¼šå‡å°‘å¾ˆå¤šï¼Œæ¯”å¦‚ç‰©æµç³»ç»Ÿå› ä¸ºå‘ç”Ÿæ•…éšœï¼Œéœ€è¦å‡ åˆ†é’Ÿæ¥ä¿®å¤ã€‚åœ¨è¿™å‡ åˆ†é’Ÿçš„æ—¶é—´é‡Œï¼Œç‰©æµç³»ç»Ÿè¦å¤„ç†çš„å†…å­˜è¢«ç¼“å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç”¨æˆ·çš„ä¸‹å•æ“ä½œå¯ä»¥æ­£å¸¸å®Œæˆã€‚å½“ç‰©æµç³»ç»Ÿæ¢å¤åï¼Œç»§ç»­å¤„ç†è®¢å•ä¿¡æ¯å³å¯ï¼Œä¸­å•ç”¨æˆ·æ„Ÿå—ä¸åˆ°ç‰©æµç³»ç»Ÿçš„æ•…éšœï¼Œæå‡ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</p><p> <img src="https://www.naste.top:9000/images/image-20230524101404096.png" alt="image-20230524101404096"></p></li><li><p>å¼‚æ­¥å¤„ç†</p><p> æœ‰äº›æœåŠ¡é—´è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œä¾‹å¦‚ A è°ƒç”¨ Bï¼ŒBéœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰§è¡Œï¼Œä½†æ˜¯ A éœ€è¦çŸ¥é“ B ä»€ä¹ˆæ—¶å€™å¯ ä»¥æ‰§è¡Œå®Œï¼Œä»¥å‰ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼ŒAè¿‡ä¸€æ®µæ—¶é—´å»è°ƒç”¨ B çš„æŸ¥è¯¢ api æŸ¥è¯¢ã€‚æˆ–è€… A æä¾›ä¸€ä¸ª callback apiï¼Œ B æ‰§è¡Œå®Œä¹‹åè°ƒç”¨ api é€šçŸ¥ A æœåŠ¡ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œä½¿ç”¨æ¶ˆæ¯æ€»çº¿ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ A è°ƒç”¨ B æœåŠ¡åï¼Œåªéœ€è¦ç›‘å¬ B å¤„ç†å®Œæˆçš„æ¶ˆæ¯ï¼Œå½“ B å¤„ç†å®Œæˆåï¼Œä¼šå‘é€ä¸€æ¡æ¶ˆæ¯ç»™MQï¼ŒMQä¼šå°†æ­¤ æ¶ˆæ¯è½¬å‘ç»™ A æœåŠ¡ã€‚è¿™æ · A æœåŠ¡æ—¢ä¸ç”¨å¾ªç¯è°ƒç”¨ B çš„æŸ¥è¯¢ apiï¼Œä¹Ÿä¸ç”¨æä¾› callback apiã€‚åŒæ · B æœåŠ¡ä¹Ÿä¸<br> ç”¨åšè¿™äº›æ“ä½œã€‚AæœåŠ¡è¿˜èƒ½åŠæ—¶çš„å¾—åˆ°å¼‚æ­¥å¤„ç†æˆåŠŸçš„æ¶ˆæ¯ã€‚</p><p> <img src="https://www.naste.top:9000/images/image-20230524101758274.png" alt="image-20230524101758274"></p></li></ol><h2 id="MQåˆ†ç±»"><a href="#MQåˆ†ç±»" class="headerlink" title="MQåˆ†ç±»"></a>MQåˆ†ç±»</h2><ul><li><p><strong>ActiveMQ</strong></p><p>  ä¼˜ç‚¹ï¼šå•æœºååé‡ä¸‡çº§ï¼Œæ—¶æ•ˆæ€§ ms çº§ï¼Œå¯ç”¨æ€§é«˜ï¼ŒåŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨æ€§ï¼Œæ¶ˆæ¯å¯é æ€§è¾ƒ ä½çš„æ¦‚ç‡ä¸¢å¤±æ•°æ®</p><p>  ç¼ºç‚¹ï¼šå®˜æ–¹ç¤¾åŒºç°åœ¨å¯¹ ActiveMQ 5.x ç»´æŠ¤è¶Šæ¥è¶Šå°‘ï¼Œé«˜ååé‡åœºæ™¯è¾ƒå°‘ä½¿ç”¨</p></li><li><p><strong>Kafka</strong></p><p>  å¤§æ•°æ®çš„æ€æ‰‹é”ï¼Œè°ˆåˆ°å¤§æ•°æ®é¢†åŸŸå†…çš„æ¶ˆæ¯ä¼ è¾“ï¼Œåˆ™ç»•ä¸å¼€ Kafkaï¼Œè¿™æ¬¾ä¸ºå¤§æ•°æ®è€Œç”Ÿçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä»¥å…¶ç™¾ä¸‡çº§ TPS çš„ååé‡åå£°å¤§å™ªï¼Œè¿…é€Ÿæˆä¸ºå¤§æ•°æ®é¢†åŸŸçš„å® å„¿ï¼Œåœ¨æ•°æ®é‡‡é›†ã€ä¼ è¾“ã€å­˜å‚¨çš„è¿‡ç¨‹ä¸­å‘æŒ¥ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ç›®å‰å·²ç»è¢« LinkedInï¼ŒUberï¼ŒTwitterï¼ŒNetflix ç­‰å¤§å…¬å¸æ‰€é‡‡çº³ã€‚</p><p>  ä¼˜ç‚¹: æ€§èƒ½å“è¶Šï¼Œå•æœºå†™å…¥ TPS çº¦åœ¨ç™¾ä¸‡æ¡/ç§’ï¼Œæœ€å¤§çš„ä¼˜ç‚¹ï¼Œå°±æ˜¯ååé‡é«˜ã€‚æ—¶æ•ˆæ€§ ms çº§å¯ç”¨æ€§éå¸¸é«˜ï¼Œkafka æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¸€ä¸ªæ•°æ®å¤šä¸ªå‰¯æœ¬ï¼Œå°‘æ•°æœºå™¨å®•æœºï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä¸ä¼šå¯¼è‡´ä¸å¯ç”¨,æ¶ˆè´¹è€…é‡‡ç”¨ Pull æ–¹å¼è·å–æ¶ˆæ¯ï¼Œæ¶ˆæ¯æœ‰åºï¼Œé€šè¿‡æ§åˆ¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰æ¶ˆæ¯è¢«æ¶ˆè´¹ä¸”ä»…è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼›æœ‰ä¼˜ç§€çš„ç¬¬ä¸‰æ–¹Kafka Web ç®¡ç†ç•Œé¢ Kafka-Managerï¼›åœ¨æ—¥å¿—é¢†åŸŸæ¯”è¾ƒæˆç†Ÿï¼Œè¢«å¤šå®¶å…¬å¸å’Œå¤šä¸ªå¼€æºé¡¹ç›®ä½¿ç”¨ï¼›åŠŸèƒ½æ”¯æŒï¼šåŠŸèƒ½ è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ”¯æŒç®€å•çš„ MQ åŠŸèƒ½ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ä»¥åŠæ—¥å¿—é‡‡é›†è¢«å¤§è§„æ¨¡ä½¿ç”¨</p><p>  ç¼ºç‚¹ï¼šKafka å•æœºè¶…è¿‡ 64 ä¸ªé˜Ÿåˆ—/åˆ†åŒºï¼ŒLoad ä¼šå‘ç”Ÿæ˜æ˜¾çš„é£™é«˜ç°è±¡ï¼Œé˜Ÿåˆ—è¶Šå¤šï¼Œload è¶Šé«˜ï¼Œå‘é€æ¶ˆæ¯å“åº”æ—¶é—´å˜é•¿ï¼Œä½¿ç”¨çŸ­è½®è¯¢æ–¹å¼ï¼Œå®æ—¶æ€§å–å†³äºè½®è¯¢é—´éš”æ—¶é—´ï¼Œæ¶ˆè´¹å¤±è´¥ä¸æ”¯æŒé‡è¯•ï¼›æ”¯æŒæ¶ˆæ¯é¡ºåºï¼Œä½†æ˜¯ä¸€å°ä»£ç†å®•æœºåï¼Œå°±ä¼šäº§ç”Ÿæ¶ˆæ¯ä¹±åºï¼Œç¤¾åŒºæ›´æ–°è¾ƒæ…¢</p></li><li><p><strong>RocketMQ</strong></p><p>  RocketMQ å‡ºè‡ªé˜¿é‡Œå·´å·´çš„å¼€æºäº§å“ï¼Œç”¨ Java è¯­è¨€å®ç°ï¼Œåœ¨è®¾è®¡æ—¶å‚è€ƒäº† Kafkaï¼Œå¹¶åšå‡ºäº†è‡ªå·±çš„ä¸€äº›æ”¹è¿›ã€‚è¢«é˜¿é‡Œå·´å·´å¹¿æ³›åº”ç”¨åœ¨è®¢å•ï¼Œäº¤æ˜“ï¼Œå……å€¼ï¼Œæµè®¡ç®—ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ—¥å¿—æµå¼å¤„ç†ï¼Œbinglog åˆ†å‘ç­‰åœºæ™¯ã€‚</p><p>  ä¼˜ç‚¹ï¼šå•æœºååé‡åä¸‡çº§ï¼Œå¯ç”¨æ€§éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„,æ¶ˆæ¯å¯ä»¥åšåˆ° 0 ä¸¢å¤±,MQ åŠŸèƒ½è¾ƒä¸ºå®Œå–„ï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ‰©å±•æ€§å¥½,æ”¯æŒ 10 äº¿çº§åˆ«çš„æ¶ˆæ¯å †ç§¯ï¼Œä¸ä¼šå› ä¸ºå †ç§¯å¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œæºç æ˜¯ java æˆ‘ä»¬å¯ä»¥è‡ªå·±é˜…è¯»æºç ï¼Œå®šåˆ¶è‡ªå·±å…¬å¸çš„ MQ</p><p>  ç¼ºç‚¹ï¼šæ”¯æŒçš„å®¢æˆ·ç«¯è¯­è¨€ä¸å¤šï¼Œç›®å‰æ˜¯ java åŠ c++ï¼Œå…¶ä¸­ c++ ä¸æˆç†Ÿï¼›ç¤¾åŒºæ´»è·ƒåº¦ä¸€èˆ¬,æ²¡æœ‰åœ¨ MQ æ ¸å¿ƒä¸­å»å®ç° JMS ç­‰æ¥å£,æœ‰äº›ç³»ç»Ÿè¦è¿ç§»éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç </p></li><li><p><strong>RabbitMQ</strong></p><p>  2007 å¹´å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ªåœ¨AMQP(é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)åŸºç¡€ä¸Šå®Œæˆçš„ï¼Œå¯å¤ç”¨çš„ä¼ä¸šæ¶ˆæ¯ç³»ç»Ÿï¼Œæ˜¯å½“å‰æœ€ä¸»æµçš„æ¶ˆæ¯ä¸­é—´ä»¶ä¹‹ä¸€ã€‚</p><p>  ä¼˜ç‚¹ï¼šç”±äº erlang è¯­è¨€çš„é«˜å¹¶å‘ç‰¹æ€§ï¼Œæ€§èƒ½è¾ƒå¥½ï¼›ååé‡åˆ°ä¸‡çº§ï¼ŒMQ åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡,å¥å£®ã€ç¨³å®šã€æ˜“ç”¨ã€è·¨å¹³å°ã€æ”¯æŒå¤šç§è¯­è¨€ å¦‚ï¼šPythonã€Rubyã€.NETã€Javaã€JMSã€Cã€PHPã€ActionScriptã€XMPPã€STOMP ç­‰ï¼Œæ”¯æŒ AJAX æ–‡æ¡£é½å…¨ï¼›å¼€æºæä¾›çš„ç®¡ç†ç•Œé¢éå¸¸æ£’ï¼Œç”¨èµ·æ¥å¾ˆå¥½ç”¨,ç¤¾åŒºæ´»è·ƒåº¦é«˜ï¼›æ›´æ–°é¢‘ç‡ç›¸å½“é«˜</p><p>  ç¼ºç‚¹ï¼šå•†ä¸šç‰ˆéœ€è¦æ”¶è´¹,å­¦ä¹ æˆæœ¬è¾ƒé«˜</p></li></ul><h2 id="MQé€‰æ‹©"><a href="#MQé€‰æ‹©" class="headerlink" title="MQé€‰æ‹©"></a>MQé€‰æ‹©</h2><ul><li><p><strong>Kafka</strong></p><p>  Kafka ä¸»è¦ç‰¹ç‚¹æ˜¯åŸºäº Pull çš„æ¨¡å¼æ¥å¤„ç†æ¶ˆæ¯æ¶ˆè´¹ï¼Œè¿½æ±‚é«˜ååé‡ï¼Œä¸€å¼€å§‹çš„ç›®çš„å°±æ˜¯ç”¨äºæ—¥å¿—æ”¶é›†å’Œä¼ è¾“ï¼Œé€‚åˆäº§ç”Ÿå¤§é‡æ•°æ®çš„äº’è”ç½‘æœåŠ¡çš„æ•°æ®æ”¶é›†ä¸šåŠ¡ã€‚å¤§å‹å…¬å¸å»ºè®®å¯ä»¥é€‰ç”¨ï¼Œå¦‚æœæœ‰æ—¥å¿—é‡‡é›†åŠŸèƒ½ï¼Œè‚¯å®šæ˜¯é¦–é€‰ kafka äº†</p></li><li><p><strong>RocketMQ</strong></p><p>  å¤©ç”Ÿä¸ºé‡‘èäº’è”ç½‘é¢†åŸŸè€Œç”Ÿï¼Œå¯¹äºå¯é æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯ç”µå•†é‡Œé¢çš„è®¢å•æ‰£æ¬¾ï¼Œä»¥åŠä¸šåŠ¡å‰Šå³°ï¼Œåœ¨å¤§é‡äº¤æ˜“æ¶Œå…¥æ—¶ï¼Œåç«¯å¯èƒ½æ— æ³•åŠæ—¶å¤„ç†çš„æƒ…å†µã€‚RoketMQ åœ¨ç¨³å®šæ€§ä¸Šå¯èƒ½æ›´å€¼å¾—ä¿¡èµ–ï¼Œè¿™äº›ä¸šåŠ¡åœºæ™¯åœ¨é˜¿é‡ŒåŒ 11 å·²ç»ç»å†äº†å¤šæ¬¡è€ƒéªŒï¼Œå¦‚æœä½ çš„ä¸šåŠ¡æœ‰ä¸Šè¿°å¹¶å‘åœºæ™¯ï¼Œå»ºè®®å¯ä»¥é€‰æ‹© RocketMQ</p></li><li><p><strong>RabbitMQ</strong></p><p>  ç»“åˆ erlang è¯­è¨€æœ¬èº«çš„å¹¶å‘ä¼˜åŠ¿ï¼Œæ€§èƒ½å¥½æ—¶æ•ˆæ€§å¾®ç§’çº§ï¼Œç¤¾åŒºæ´»è·ƒåº¦ä¹Ÿæ¯”è¾ƒé«˜ï¼Œç®¡ç†ç•Œé¢ç”¨èµ·æ¥ååˆ† æ–¹ä¾¿ï¼Œå¦‚æœä½ çš„æ•°æ®é‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä¸­å°å‹å…¬å¸ä¼˜å…ˆé€‰æ‹©åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡çš„ RabbitMQ</p></li></ul><h1 id="RabbitMQç›¸å…³æ¦‚å¿µ"><a href="#RabbitMQç›¸å…³æ¦‚å¿µ" class="headerlink" title="RabbitMQç›¸å…³æ¦‚å¿µ"></a>RabbitMQç›¸å…³æ¦‚å¿µ</h1><h2 id="RabbitMQæ¦‚å¿µ"><a href="#RabbitMQæ¦‚å¿µ" class="headerlink" title="RabbitMQæ¦‚å¿µ"></a>RabbitMQæ¦‚å¿µ</h2><p>RabbitMQ æ˜¯ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ï¼šå®ƒæ¥å—å¹¶è½¬å‘æ¶ˆæ¯ã€‚ä½ å¯ä»¥æŠŠå®ƒå½“åšä¸€ä¸ªå¿«é€’ç«™ç‚¹ï¼Œå½“ä½ è¦å‘é€ä¸€ä¸ªåŒ…è£¹æ—¶ï¼Œä½ æŠŠä½ çš„åŒ…è£¹æ”¾åˆ°å¿«é€’ç«™ï¼Œå¿«é€’å‘˜æœ€ç»ˆä¼šæŠŠä½ çš„å¿«é€’é€åˆ°æ”¶ä»¶äººé‚£é‡Œï¼ŒæŒ‰ç…§è¿™ç§é€»è¾‘ RabbitMQ æ˜¯ ä¸€ä¸ªå¿«é€’ç«™ï¼Œä¸€ä¸ªå¿«é€’å‘˜å¸®ä½ ä¼ é€’å¿«ä»¶ã€‚RabbitMQ ä¸å¿«é€’ç«™çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œå®ƒä¸å¤„ç†å¿«ä»¶è€Œæ˜¯æ¥æ”¶ï¼Œå­˜å‚¨å’Œè½¬å‘æ¶ˆæ¯æ•°æ®ã€‚</p><h2 id="RabbitMQå››å¤§æ ¸å¿ƒæ¦‚å¿µ"><a href="#RabbitMQå››å¤§æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="RabbitMQå››å¤§æ ¸å¿ƒæ¦‚å¿µ"></a>RabbitMQå››å¤§æ ¸å¿ƒæ¦‚å¿µ</h2><ul><li><p><code>ç”Ÿäº§è€…</code>ï¼š</p><p>  äº§ç”Ÿæ•°æ®å‘é€æ¶ˆæ¯çš„ç¨‹åº</p></li><li><p><code>äº¤æ¢æœº</code>ï¼š</p><p>  æ˜¯ RabbitMQ éå¸¸é‡è¦çš„ä¸€ä¸ªéƒ¨ä»¶ï¼Œä¸€æ–¹é¢å®ƒæ¥æ”¶æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹é¢å®ƒå°†æ¶ˆæ¯ æ¨é€åˆ°é˜Ÿåˆ—ä¸­ã€‚äº¤æ¢æœºå¿…é¡»ç¡®åˆ‡çŸ¥é“å¦‚ä½•å¤„ç†å®ƒæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œæ˜¯å°†è¿™äº›æ¶ˆæ¯æ¨é€åˆ°ç‰¹å®šé˜Ÿåˆ—è¿˜æ˜¯æ¨é€åˆ°å¤šä¸ªé˜Ÿåˆ—ï¼Œäº¦æˆ–è€…æ˜¯æŠŠæ¶ˆæ¯ä¸¢å¼ƒï¼Œè¿™ä¸ªå¾—æœ‰äº¤æ¢æœºç±»å‹å†³å®š</p></li><li><p><code>é˜Ÿåˆ—</code>ï¼š</p><p>  æ˜¯ RabbitMQ å†…éƒ¨ä½¿ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå°½ç®¡æ¶ˆæ¯æµç» RabbitMQ å’Œåº”ç”¨ç¨‹åºï¼Œä½†å®ƒä»¬åªèƒ½å­˜å‚¨åœ¨é˜Ÿåˆ—ä¸­ã€‚é˜Ÿåˆ—ä»…å—ä¸»æœºçš„å†…å­˜å’Œç£ç›˜é™åˆ¶çš„çº¦æŸï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¤§çš„æ¶ˆæ¯ç¼“å†²åŒºã€‚è®¸å¤šç”Ÿäº§è€…å¯ä»¥å°†æ¶ˆæ¯å‘é€åˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè®¸å¤šæ¶ˆè´¹è€…å¯ä»¥å°è¯•ä»ä¸€ä¸ªé˜Ÿåˆ—æ¥æ”¶æ•°æ®ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨é˜Ÿåˆ—çš„æ–¹å¼</p></li><li><p><code>æ¶ˆè´¹è€…</code>ï¼š</p><p>  æ¶ˆè´¹ä¸æ¥æ”¶å…·æœ‰ç›¸ä¼¼çš„å«ä¹‰ã€‚æ¶ˆè´¹è€…å¤§å¤šæ—¶å€™æ˜¯ä¸€ä¸ªç­‰å¾…æ¥æ”¶æ¶ˆæ¯çš„ç¨‹åºã€‚è¯·æ³¨æ„ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…å’Œæ¶ˆæ¯ä¸­é—´ä»¶å¾ˆå¤šæ—¶å€™å¹¶ä¸åœ¨åŒä¸€æœºå™¨ä¸Šã€‚åŒä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¢å¯ä»¥æ˜¯ç”Ÿäº§è€…åˆæ˜¯å¯ä»¥æ˜¯æ¶ˆè´¹è€…ã€‚</p></li></ul><h2 id="RabbitMQæ ¸å¿ƒéƒ¨åˆ†"><a href="#RabbitMQæ ¸å¿ƒéƒ¨åˆ†" class="headerlink" title="RabbitMQæ ¸å¿ƒéƒ¨åˆ†"></a>RabbitMQæ ¸å¿ƒéƒ¨åˆ†</h2><p><img src="https://www.naste.top:9000/images/202305241050001.png" alt="202305241050001"></p><h2 id="RabbitMQåè¯ä»‹ç»"><a href="#RabbitMQåè¯ä»‹ç»" class="headerlink" title="RabbitMQåè¯ä»‹ç»"></a>RabbitMQåè¯ä»‹ç»</h2><p><img src="https://www.naste.top:9000/images/image-20230524110356724.png" alt="image-20230524110356724"></p><ul><li><code>Producer</code>ï¼šæ¶ˆæ¯ç”Ÿäº§è€…ã€‚</li><li><code>Consumer</code>ï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ã€‚</li><li><code>Broker</code>ï¼šæ¥æ”¶å’Œåˆ†å‘æ¶ˆæ¯çš„åº”ç”¨ï¼ŒRabbitMQ Server å°±æ˜¯ Message Broker</li><li><code>Virtual host</code>ï¼šå‡ºäºå¤šç§Ÿæˆ·å’Œå®‰å…¨å› ç´ è®¾è®¡çš„ï¼ŒæŠŠ AMQP çš„åŸºæœ¬ç»„ä»¶åˆ’åˆ†åˆ°ä¸€ä¸ªè™šæ‹Ÿçš„åˆ†ç»„ä¸­ï¼Œç±»ä¼¼äºç½‘ç»œä¸­çš„ namespace æ¦‚å¿µã€‚å½“å¤šä¸ªä¸åŒçš„ç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ª RabbitMQ server æä¾›çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥åˆ’åˆ†å‡ºå¤šä¸ªvhostï¼Œæ¯ä¸ªç”¨æˆ·åœ¨è‡ªå·±çš„ vhost åˆ›å»º exchangeï¼queue ç­‰</li><li><code>Connection</code>ï¼špublisherï¼consumer å’Œ broker ä¹‹é—´çš„ TCP è¿æ¥åˆ° RabbitMQ Server</li><li><code>Channel</code>ï¼šå¦‚æœæ¯ä¸€æ¬¡è®¿é—® RabbitMQ éƒ½å»ºç«‹ä¸€ä¸ª Connectionï¼Œåœ¨æ¶ˆæ¯é‡å¤§çš„æ—¶å€™å»ºç«‹ TCP Connection çš„å¼€é”€å°†æ˜¯å·¨å¤§çš„ï¼Œæ•ˆç‡ä¹Ÿè¾ƒä½ã€‚Channel æ˜¯åœ¨ connection å†…éƒ¨å»ºç«‹çš„é€»è¾‘è¿æ¥ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ”¯æŒå¤šçº¿ç¨‹ï¼Œé€šå¸¸æ¯ä¸ª thread åˆ›å»ºå•ç‹¬çš„ channel è¿›è¡Œé€šè®¯ï¼ŒAMQP method åŒ…å«äº† channel id å¸®åŠ©å®¢ æˆ·ç«¯å’Œ message broker è¯†åˆ« channelï¼Œæ‰€ä»¥ channel ä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚Channel ä½œä¸ºè½»é‡çº§çš„ Connection æå¤§å‡å°‘äº†æ“ä½œç³»ç»Ÿå»ºç«‹ TCP connection çš„å¼€é”€</li><li><code>Exchange</code>ï¼šmessage åˆ°è¾¾ broker çš„ç¬¬ä¸€ç«™ï¼Œæ ¹æ®åˆ†å‘è§„åˆ™ï¼ŒåŒ¹é…æŸ¥è¯¢è¡¨ä¸­çš„ routing keyï¼Œåˆ†å‘ æ¶ˆæ¯åˆ° queue ä¸­å»ã€‚å¸¸ç”¨çš„ç±»å‹æœ‰ï¼šdirect (point-to-point)ï¼Œtopic (publish-subscribe) and fanout (multicast)</li><li><p><code>Queue</code>ï¼šæ¶ˆæ¯æœ€ç»ˆè¢«é€åˆ°è¿™é‡Œç­‰å¾… consumer å–èµ°</p></li><li><p><code>Binding</code>ï¼šexchange å’Œ queue ä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbinding ä¸­å¯ä»¥åŒ…å« routing keyï¼ŒBinding ä¿¡æ¯è¢«ä¿ å­˜åˆ° exchange ä¸­çš„æŸ¥è¯¢è¡¨ä¸­ï¼Œç”¨äº message çš„åˆ†å‘ä¾æ®</p></li><li><code>Routing Keyï¼ˆè·¯ç”±é”®ï¼‰</code>ï¼šæ¶ˆæ¯å‘é€ç»™ Exchangeï¼ˆäº¤æ¢å™¨ï¼‰æ—¶ï¼Œæ¶ˆæ¯å°†æ‹¥æœ‰ä¸€ä¸ªè·¯ç”±é”®ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰ï¼Œ Exchangeï¼ˆäº¤æ¢å™¨ï¼‰æ ¹æ®è¿™ä¸ªè·¯ç”±é”®å°†æ¶ˆæ¯å‘é€åˆ°åŒ¹é…çš„é˜Ÿåˆ—ä¸­</li><li><code>Binding Keyï¼ˆç»‘å®šé”®ï¼‰</code>ï¼šæŒ‡å®šå½“å‰ Exchangeï¼ˆäº¤æ¢å™¨ï¼‰ä¸‹ï¼Œä»€ä¹ˆæ ·çš„ Routing Keyï¼ˆè·¯ç”±é”®ï¼‰ä¼šè¢«ä¸‹æ´¾åˆ°å½“å‰ç»‘å®šçš„ Queue ä¸­</li><li><code>Direct</code>ï¼šå®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ¯è·¯ç”±åˆ°é‚£äº› Routing Key ä¸ Binding Key å®Œå…¨åŒ¹é…çš„ Queue ä¸­ã€‚æ¯”å¦‚ Routing Key ä¸º<code>cleint-key</code>ï¼Œåªä¼šè½¬å‘<code>cleint-key</code>ï¼Œä¸ä¼šè½¬å‘<code>cleint-key.1</code>ï¼Œä¹Ÿä¸ä¼šè½¬å‘<code>cleint-key.1.2</code></li><li>Topicï¼šæ¨¡å¼åŒ¹é…ï¼ŒExchange ä¼šæŠŠæ¶ˆæ¯å‘é€åˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ»¡è¶³é€šé…ç¬¦è§„åˆ™çš„ routing-key çš„ Queueã€‚å…¶ä¸­<em>è¡¨å·åŒ¹é…ä¸€ä¸ª wordï¼Œ#åŒ¹é…å¤šä¸ª word å’Œè·¯å¾„ï¼Œè·¯å¾„ä¹‹é—´é€šè¿‡.éš”å¼€ã€‚å¦‚æ»¡è¶³a.</em>.cçš„ routing-key æœ‰a.hello.cï¼›æ»¡è¶³#.helloçš„ routing-key æœ‰a.b.c.helo</li><li><code>Fanout</code>ï¼šå¿½ç•¥åŒ¹é…ï¼ŒæŠŠæ‰€æœ‰å‘é€åˆ°è¯¥ Exchange çš„æ¶ˆæ¯è·¯ç”±åˆ°æ‰€æœ‰ä¸å®ƒç»‘å®š çš„Queue ä¸­</li></ul><h1 id="ä»£ç å·¥å…·ç±»"><a href="#ä»£ç å·¥å…·ç±»" class="headerlink" title="ä»£ç å·¥å…·ç±»"></a>ä»£ç å·¥å…·ç±»</h1><h2 id="RabbitMQè¿æ¥ä¿¡é“å·¥å…·ç±»"><a href="#RabbitMQè¿æ¥ä¿¡é“å·¥å…·ç±»" class="headerlink" title="RabbitMQè¿æ¥ä¿¡é“å·¥å…·ç±»"></a>RabbitMQè¿æ¥ä¿¡é“å·¥å…·ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–RabbitMQè¿æ¥ä¿¡é“å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">HOST</span> <span class="operator">=</span> <span class="string">&quot;192.168.40.168&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;guest&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;guest&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–RabbitMQè¿æ¥ä¿¡é“</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Channel <span class="title function_">getChannel</span><span class="params">()</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        <span class="comment">//å·¥å‚IP è¿æ¥RabbitMQå¯¹åˆ—</span></span><br><span class="line">        factory.setHost(HOST);</span><br><span class="line">        <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">        factory.setUsername(USERNAME);</span><br><span class="line">        <span class="comment">//å¯†ç </span></span><br><span class="line">        factory.setPassword(PASSWORD);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºè¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="keyword">return</span> connection.createChannel();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¡çœ å·¥å…·ç±»"><a href="#ç¡çœ å·¥å…·ç±»" class="headerlink" title="ç¡çœ å·¥å…·ç±»"></a>ç¡çœ å·¥å…·ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¡çœ å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SleepUtils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">(<span class="type">int</span> second)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000L</span> * second);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h1><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>ç”¨ Java ç¼–å†™ä¸¤ä¸ªç¨‹åºã€‚å•ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…</p><p>åœ¨ä¸‹å›¾ä¸­ï¼Œâ€œ Pâ€ æ˜¯ç”Ÿäº§è€…ï¼Œâ€œ Câ€ æ˜¯æ¶ˆè´¹è€…ã€‚ä¸­é—´çš„æ¡†æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œ RabbitMQ ä»£è¡¨ä½¿ç”¨è€…ä¿ç•™çš„æ¶ˆæ¯ç¼“å†²åŒº</p><p><img src="https://www.naste.top:9000/images/image-20230524145429005.png" alt="image-20230524145429005"></p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><h4 id="mavenä¾èµ–"><a href="#mavenä¾èµ–" class="headerlink" title="mavenä¾èµ–"></a>mavenä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--rabbitmq ä¾èµ–å®¢æˆ·ç«¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.rabbitmq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>amqp-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ“ä½œæ–‡ä»¶æµçš„ä¸€ä¸ªä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="ç”Ÿäº§è€…"><a href="#ç”Ÿäº§è€…" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”Ÿäº§è€…ä»£ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//å¯¹åˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//éœ€è¦å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;Hello,world&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;&quot;</span>, QUEUE_NAME, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å®Œæ¯•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerOne</span> &#123;</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¨é€çš„æ¶ˆæ¯å¦‚ä½•è¿›è¡Œæ¶ˆè´¹çš„æ¥å£å›è°ƒï¼Œåœ¨è¯¥æ¥å£ä¸­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºDeliverCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶æ¶ˆæ¯äº†&quot;</span>);</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–æ¶ˆæ¶ˆè´¹çš„ä¸€ä¸ªå›è°ƒæ¥å£ å¦‚åœ¨æ¶ˆè´¹çš„æ—¶å€™é˜Ÿåˆ—è¢«åˆ é™¤æ‰äº†</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºCancelCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯æ¶ˆè´¹è¢«ä¸­æ–­&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸä¹‹åæ˜¯å¦è¦è‡ªåŠ¨åº”ç­”trueï¼šä»£è¡¨è‡ªåŠ¨åº”ç­”false:ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(QUEUE_NAME, <span class="literal">true</span>, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Work-Queues"><a href="#Work-Queues" class="headerlink" title="Work Queues"></a>Work Queues</h2><p>Work Queues æ˜¯å·¥ä½œé˜Ÿåˆ—ï¼ˆåˆç§°ä»»åŠ¡é˜Ÿåˆ—ï¼‰çš„ä¸»è¦æ€æƒ³æ˜¯é¿å…ç«‹å³æ‰§è¡Œèµ„æºå¯†é›†å‹ä»»åŠ¡ï¼Œè€Œä¸å¾—ä¸ç­‰å¾…å®ƒå®Œæˆã€‚ç›¸åæˆ‘ä»¬å®‰æ’ä»»åŠ¡åœ¨ä¹‹åæ‰§è¡Œã€‚æˆ‘ä»¬æŠŠä»»åŠ¡å°è£…ä¸ºæ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°é˜Ÿåˆ—ã€‚åœ¨åå°è¿è¡Œçš„å·¥ä½œè¿›ç¨‹å°†å¼¹å‡ºä»»åŠ¡å¹¶æœ€ç»ˆæ‰§è¡Œä½œä¸šã€‚å½“æœ‰å¤šä¸ªå·¥ä½œçº¿ç¨‹æ—¶ï¼Œè¿™äº›å·¥ä½œçº¿ç¨‹å°†ä¸€èµ·å¤„ç†è¿™äº›ä»»åŠ¡ã€‚<strong><code>ç›¸å½“äºè´Ÿè½½å‡è¡¡ï¼Œhello worldæ˜¯ä¸€ä¸ªé˜Ÿåˆ—ä¸€ä¸ªå·¥ä½œç°åœºï¼Œwork queuesæ˜¯å¤šä¸ªæ¶ˆè´¹è€…åŒæ—¶å¯¹æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹</code></strong></p><h3 id="è½®è¯¢æ¶ˆè´¹"><a href="#è½®è¯¢æ¶ˆè´¹" class="headerlink" title="è½®è¯¢æ¶ˆè´¹"></a>è½®è¯¢æ¶ˆè´¹</h3><blockquote><p><strong>ä»£ç è¿˜æ˜¯å‰é¢<code>Hello World</code>ä¸­çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä»£ç ï¼Œåªæ˜¯ä½¿ç”¨äº†ideaå¯åŠ¨äº†ä¸¤ä¸ªæ¶ˆè´¹è€…</strong></p></blockquote><p>è½®è¯¢æ¶ˆè´¹æ¶ˆæ¯æŒ‡çš„æ˜¯è½®æµæ¶ˆè´¹æ¶ˆæ¯ï¼Œå³æ¯ä¸ªå·¥ä½œé˜Ÿåˆ—éƒ½ä¼šè·å–ä¸€ä¸ªæ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ï¼Œå¹¶ä¸”è·å–çš„æ¬¡æ•°æŒ‰ç…§é¡ºåºä¾æ¬¡å¾€ä¸‹è½®æµã€‚</p><p>æ¡ˆä¾‹ä¸­ç”Ÿäº§è€…å«åš Taskï¼Œä¸€ä¸ªæ¶ˆè´¹è€…å°±æ˜¯ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ï¼Œå¯åŠ¨ä¸¤ä¸ªå·¥ä½œé˜Ÿåˆ—æ¶ˆè´¹æ¶ˆæ¯ï¼Œè¿™ä¸ªä¸¤ä¸ªå·¥ä½œé˜Ÿåˆ—ä¼šä»¥è½®è¯¢çš„æ–¹å¼æ¶ˆè´¹æ¶ˆæ¯ã€‚</p><p><img src="https://www.naste.top:9000/images/image-20230524160903040.png" alt="image-20230524160903040"></p><p><img src="https://www.naste.top:9000/images/image-20230524160935245.png" alt="image-20230524160935245"></p><h2 id="webé¡µé¢æ·»åŠ é˜Ÿåˆ—"><a href="#webé¡µé¢æ·»åŠ é˜Ÿåˆ—" class="headerlink" title="webé¡µé¢æ·»åŠ é˜Ÿåˆ—"></a>webé¡µé¢æ·»åŠ é˜Ÿåˆ—</h2><p><img src="https://www.naste.top:9000/images/image-20230524164535093.png" alt="image-20230524164535093"></p><ol><li>ç‚¹å‡» <code>Queues</code> èœå•</li><li>ç‚¹å‡» <code>Add a new queue</code>ï¼Œå¼¹å‡ºä¸‹æ‹‰èœå•</li><li>ä¸‹æ–¹çš„å¾ˆå¤šå‚æ•°å¯ä»¥è¿›è¡Œé€‰æ‹©ï¼ˆæ—è¾¹æœ‰ ï¼Ÿçš„å‚æ•°ï¼‰ï¼Œå¦‚ä¼˜å…ˆçº§ï¼ˆ<code>Lazy mode</code>ï¼‰ã€ç»‘å®šæ­»ä¿¡é˜Ÿåˆ—ï¼ˆ<code>Dead letter exchange/routing key</code>ï¼‰</li><li>æ‰§è¡Œæ­¥éª¤ 3 åï¼Œåœ¨ <code>Arguments</code> çš„ç¬¬ä¸€ä¸ªæ–‡æœ¬æ¡†å¼¹å‡ºå¯¹åº”çš„å‚æ•°ï¼Œç±»ä¼¼äº Map çš„ key</li><li>ç¬¬äºŒä¸ªæ–‡æœ¬æ¡†å¡«å†™å‚æ•°ï¼Œç±»ä¼¼äº Map çš„ value</li><li>ç¬¬ä¸‰ä¸ªæ˜¯ä¸‹æ‹‰èœå•ï¼Œé€‰æ‹© value ç±»å‹</li><li>ç‚¹å‡» <code>Add queue</code>ï¼Œæ·»åŠ é˜Ÿåˆ—</li></ol><p>æ—è¾¹æœ‰ ï¼Ÿçš„å‚æ•°ï¼Œå°±æ˜¯ <code>channel.queueDeclare(é˜Ÿåˆ—å/String, æŒä¹…åŒ–/boolean, å…±äº«æ¶ˆè´¹/boolean, è‡ªåŠ¨åˆ é™¤/boolean, é…ç½®å‚æ•°/Map);</code> æˆ–è€… <code>channel.basicPublish(äº¤æ¢æœºå/String, é˜Ÿåˆ—å/String, é…ç½®å‚æ•°/Map, æ¶ˆæ¯/String);</code> çš„å‚æ•°ï¼šé…ç½®å‚æ•°/Map çš„ key</p><h1 id="æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒ"><a href="#æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒ" class="headerlink" title="æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒ"></a>æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒ</h1><h2 id="æ¶ˆæ¯åº”ç­”"><a href="#æ¶ˆæ¯åº”ç­”" class="headerlink" title="æ¶ˆæ¯åº”ç­”"></a>æ¶ˆæ¯åº”ç­”</h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>æ¶ˆè´¹è€…å®Œæˆä¸€ä¸ªä»»åŠ¡å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ä¸€ä¸ªé•¿çš„ä»»åŠ¡å¹¶ä»…åªå®Œæˆäº†éƒ¨åˆ†çªç„¶å®ƒæŒ‚æ‰äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚RabbitMQ ä¸€æ—¦å‘æ¶ˆè´¹è€…ä¼ é€’äº†ä¸€æ¡æ¶ˆæ¯ï¼Œä¾¿ç«‹å³å°†è¯¥æ¶ˆæ¯æ ‡è®°ä¸ºåˆ é™¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçªç„¶æœ‰ä¸ªæ¶ˆè´¹è€…æŒ‚æ‰äº†ï¼Œæˆ‘ä»¬å°†ä¸¢å¤±æ­£åœ¨å¤„ç†çš„æ¶ˆæ¯ã€‚ä»¥åŠåç»­å‘é€ç»™è¯¥æ¶ˆè´¹è€…çš„æ¶ˆæ¯ï¼Œå› ä¸ºå®ƒæ— æ³•æ¥æ”¶åˆ°ã€‚</p><p>ä¸ºäº†ä¿è¯æ¶ˆæ¯åœ¨å‘é€è¿‡ç¨‹ä¸­ä¸ä¸¢å¤±ï¼Œå¼•å…¥æ¶ˆæ¯åº”ç­”æœºåˆ¶ï¼Œæ¶ˆæ¯åº”ç­”å°±æ˜¯ï¼š<mark><strong>æ¶ˆè´¹è€…åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯å¹¶ä¸”å¤„ç†è¯¥æ¶ˆæ¯ä¹‹åï¼Œå‘Šè¯‰ RabbitMQ å®ƒå·²ç»å¤„ç†äº†ï¼ŒRabbitMQ å¯ä»¥æŠŠè¯¥æ¶ˆæ¯åˆ é™¤äº†</strong></mark>ã€‚</p><h3 id="è‡ªåŠ¨åº”ç­”ï¼ˆæ— éœ€è®¾ç½®ï¼‰"><a href="#è‡ªåŠ¨åº”ç­”ï¼ˆæ— éœ€è®¾ç½®ï¼‰" class="headerlink" title="è‡ªåŠ¨åº”ç­”ï¼ˆæ— éœ€è®¾ç½®ï¼‰"></a>è‡ªåŠ¨åº”ç­”ï¼ˆæ— éœ€è®¾ç½®ï¼‰</h3><p>æ¶ˆæ¯å‘é€åç«‹å³è¢«è®¤ä¸ºå·²ç»ä¼ é€æˆåŠŸï¼Œè¿™ç§æ¨¡å¼éœ€è¦åœ¨<strong>é«˜ååé‡å’Œæ•°æ®ä¼ è¾“å®‰å…¨æ€§æ–¹é¢åšæƒè¡¡</strong>,å› ä¸ºè¿™ç§æ¨¡å¼å¦‚æœæ¶ˆæ¯åœ¨æ¥æ”¶åˆ°ä¹‹å‰ï¼Œæ¶ˆè´¹è€…é‚£è¾¹å‡ºç°è¿æ¥æˆ–è€… channel å…³é—­ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸¢å¤±äº†,å½“ç„¶å¦ä¸€æ–¹é¢è¿™ç§æ¨¡å¼æ¶ˆè´¹è€…é‚£è¾¹å¯ä»¥ä¼ é€’è¿‡è½½çš„æ¶ˆæ¯ï¼Œ<strong>æ²¡æœ‰å¯¹ä¼ é€’çš„æ¶ˆæ¯æ•°é‡è¿›è¡Œé™åˆ¶</strong>ï¼Œå½“ç„¶è¿™æ ·æœ‰å¯èƒ½ä½¿å¾—æ¶ˆè´¹è€…è¿™è¾¹ç”±äºæ¥æ”¶å¤ªå¤šè¿˜æ¥ä¸åŠå¤„ç†çš„æ¶ˆæ¯ï¼Œå¯¼è‡´è¿™äº›æ¶ˆæ¯çš„ç§¯å‹ï¼Œæœ€ç»ˆä½¿å¾—å†…å­˜è€—å°½ï¼Œæœ€ç»ˆè¿™äº›æ¶ˆè´¹è€…çº¿ç¨‹è¢«æ“ä½œç³»ç»Ÿæ€æ­»ï¼Œ<strong>æ‰€ä»¥è¿™ç§æ¨¡å¼ä»…é€‚ç”¨åœ¨æ¶ˆè´¹è€…å¯ä»¥é«˜æ•ˆå¹¶ä»¥ æŸç§é€Ÿç‡èƒ½å¤Ÿå¤„ç†è¿™äº›æ¶ˆæ¯çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚</strong></p><h3 id="æ‰‹åŠ¨åº”ç­”æ–¹æ³•åŠå‚æ•°è§£é‡Š"><a href="#æ‰‹åŠ¨åº”ç­”æ–¹æ³•åŠå‚æ•°è§£é‡Š" class="headerlink" title="æ‰‹åŠ¨åº”ç­”æ–¹æ³•åŠå‚æ•°è§£é‡Š"></a>æ‰‹åŠ¨åº”ç­”æ–¹æ³•åŠå‚æ•°è§£é‡Š</h3><ul><li><code>Channel.basicAck</code> (è‚¯å®šç¡®è®¤åº”ç­”)ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basicAck(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> multiple);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¶ˆæ¯çš„æ ‡è®°ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦åº”ç”¨äºå¤šæ¶ˆæ¯ï¼ŒRabbitMQ å·²çŸ¥é“è¯¥æ¶ˆæ¯å¹¶ä¸”æˆåŠŸçš„å¤„ç†æ¶ˆæ¯ï¼Œå¯ä»¥å°†å…¶ä¸¢å¼ƒäº†</p><ul><li><code>Channel.basicReject</code> (å¦å®šç¡®è®¤åº”ç­”)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basicReject(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> requeue);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ‹’ç» <code>deliveryTag</code> å¯¹åº”çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦ <code>requeue</code>ï¼štrue åˆ™é‡æ–°å…¥é˜Ÿåˆ—ï¼Œfalse åˆ™ä¸¢å¼ƒæˆ–è€…è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—ã€‚</p><p>è¯¥æ–¹æ³• reject åï¼Œè¯¥æ¶ˆè´¹è€…è¿˜æ˜¯ä¼šæ¶ˆè´¹åˆ°è¯¥æ¡è¢« reject çš„æ¶ˆæ¯ã€‚</p><ul><li><code>Channel.basicNack</code> (ç”¨äºå¦å®šç¡®è®¤)ï¼šç¤ºå·±æ‹’ç»å¤„ç†è¯¥æ¶ˆæ¯ï¼Œå¯ä»¥å°†å…¶ä¸¢å¼ƒäº†</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basicNack(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> multiple, <span class="type">boolean</span> requeue);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ‹’ç» <code>deliveryTag</code> å¯¹åº”çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¡¨ç¤ºå¦åº”ç”¨äºå¤šæ¶ˆæ¯ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦ <code>requeue</code>ï¼Œä¸ basicReject åŒºåˆ«å°±æ˜¯åŒæ—¶æ”¯æŒå¤šä¸ªæ¶ˆæ¯ï¼Œå¯ä»¥ æ‹’ç»ç­¾æ”¶ è¯¥æ¶ˆè´¹è€…å…ˆå‰æ¥æ”¶æœª ack çš„æ‰€æœ‰æ¶ˆæ¯ã€‚æ‹’ç»ç­¾æ”¶åçš„æ¶ˆæ¯ä¹Ÿä¼šè¢«è‡ªå·±æ¶ˆè´¹åˆ°ã€‚</p><ul><li><code>Channel.basicRecover</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basicRecover(<span class="type">boolean</span> requeue);</span><br></pre></td></tr></table></figure><p>æ˜¯å¦æ¢å¤æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œå‚æ•°æ˜¯æ˜¯å¦ <code>requeue</code>ï¼Œtrue åˆ™é‡æ–°å…¥é˜Ÿåˆ—ï¼Œå¹¶ä¸”å°½å¯èƒ½çš„å°†ä¹‹å‰ <code>recover</code> çš„æ¶ˆæ¯æŠ•é€’ç»™å…¶ä»–æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œè€Œä¸æ˜¯è‡ªå·±å†æ¬¡æ¶ˆè´¹ã€‚false åˆ™æ¶ˆæ¯ä¼šé‡æ–°è¢«æŠ•é€’ç»™è‡ªå·±ã€‚</p><p><strong>ä¸Šé¢æ‰‹åŠ¨åº”ç­”æ–¹æ³•ä¸­Multipleå‚æ•°çš„è§£é‡Šï¼š</strong></p><ul><li><p>trueï¼šä»£è¡¨æ‰¹é‡åº”ç­” channel ä¸Šæœªåº”ç­”çš„æ¶ˆæ¯ã€‚æ¯”å¦‚è¯´ channel ä¸Šæœ‰ä¼ é€ tag çš„æ¶ˆæ¯ 5,6,7,8 å½“å‰ tag æ˜¯ 8 é‚£ä¹ˆæ­¤æ—¶ 5-8 çš„è¿™äº›è¿˜æœªåº”ç­”çš„æ¶ˆæ¯éƒ½ä¼šè¢«ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åº”ç­”</p></li><li><p>falseï¼šåŒä¸Šé¢ç›¸æ¯”åªä¼šåº”ç­” tag=8 çš„æ¶ˆæ¯ 5,6,7 è¿™ä¸‰ä¸ªæ¶ˆæ¯ä¾ç„¶ä¸ä¼šè¢«ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åº”ç­”</p></li></ul><p><img src="https://www.naste.top:9000/images/image-20230524210837312.png" alt="image-20230524210837312"></p><h3 id="æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ"><a href="#æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ" class="headerlink" title="æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ"></a>æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ</h3><p>å¦‚æœæ¶ˆè´¹è€…ç”±äºæŸäº›åŸå› å¤±å»è¿æ¥(å…¶é€šé“å·²å…³é—­ï¼Œè¿æ¥å·²å…³é—­æˆ– TCP è¿æ¥ä¸¢å¤±)ï¼Œå¯¼è‡´æ¶ˆæ¯æœªå‘é€ ACK ç¡®è®¤ï¼ŒRabbitMQ å°†äº†è§£åˆ°æ¶ˆæ¯æœªå®Œå…¨å¤„ç†ï¼Œå¹¶å°†å¯¹å…¶é‡æ–°æ’é˜Ÿã€‚å¦‚æœæ­¤æ—¶å…¶ä»–æ¶ˆè´¹è€…å¯ä»¥å¤„ç†ï¼Œå®ƒå°†å¾ˆå¿«å°†å…¶é‡æ–°åˆ†å‘ç»™å¦ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚è¿™æ ·ï¼Œå³ä½¿æŸä¸ªæ¶ˆè´¹è€…å¶å°”æ­»äº¡ï¼Œä¹Ÿå¯ä»¥ç¡®ä¿ä¸ä¼šä¸¢å¤±ä»»ä½•æ¶ˆæ¯ã€‚</p><blockquote><p><strong>ä¸‹é¢å›¾ç‰‡é¡ºåºï¼Œä»å·¦è‡³å³ï¼Œä»ä¸Šè‡³ä¸‹çœ‹ï¼Œæ˜¯è¿ç»­å›¾ï¼Œä¸Šä¸‹ä¸¤å¼ å›¾ï¼ˆ1ï¼Œ2ï¼‰ï¼Œä¸‹é¢ä¸¤å¼ å›¾ï¼ˆ3ï¼Œ4ï¼‰</strong></p></blockquote><p><img src="https://www.naste.top:9000/images/image.4hplocbhsdk0.webp" alt="img"></p><h3 id="æ‰‹åŠ¨åº”ç­”æ¡ˆä¾‹"><a href="#æ‰‹åŠ¨åº”ç­”æ¡ˆä¾‹" class="headerlink" title="æ‰‹åŠ¨åº”ç­”æ¡ˆä¾‹"></a>æ‰‹åŠ¨åº”ç­”æ¡ˆä¾‹</h3><h4 id="ç”Ÿäº§è€…-1"><a href="#ç”Ÿäº§è€…-1" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTwo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;ACK_QUEUE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(TASK_QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸­è¾“å…¥éœ€è¦ç”Ÿäº§çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä¿¡æ¯ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">             * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">             * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, TASK_QUEUE_NAME, <span class="literal">null</span>, message.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…-1"><a href="#æ¶ˆè´¹è€…-1" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><blockquote><p><strong>æ²¡æœ‰åº”ç­”çš„æ¶ˆæ¯ä¼šåœ¨<code>Unacked</code>ä¸­è¿›è¡Œç»Ÿè®¡ï¼Œç­‰åç»­æ¶ˆè´¹è€…å¯¹è¯¥æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹</strong></p></blockquote><p><img src="https://www.naste.top:9000/images/image-20230525100622070.png" alt="image-20230525100622070"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.CancelCallback;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.SleepUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Channel.basicAck (è‚¯å®šç¡®è®¤åº”ç­”)å®ç°æ‰‹åŠ¨æ¶ˆæ¯åº”ç­”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTwo</span> &#123;</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;ACK_QUEUE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¥å—æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        System.out.println(<span class="string">&quot;C1ç­‰å¾…æ¥å—æ¶ˆæ¯å¤„ç†æ—¶é—´è¾ƒçŸ­&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¨é€çš„æ¶ˆæ¯å¦‚ä½•è¿›è¡Œæ¶ˆè´¹çš„æ¥å£å›è°ƒï¼Œåœ¨è¯¥æ¥å£ä¸­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºDeliverCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ²‰ç¡1S</span></span><br><span class="line">            SleepUtils.sleep(<span class="number">1</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥å—åˆ°çš„æ¶ˆæ¯:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">             * 1.æ¶ˆæ¯çš„æ ‡è®°Tag</span></span><br><span class="line"><span class="comment">             * 2.æ˜¯å¦æ‰¹é‡åº”ç­” falseè¡¨ç¤ºä¸æ‰¹é‡åº”ç­”ä¿¡é“ä¸­çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–æ¶ˆæ¶ˆè´¹çš„ä¸€ä¸ªå›è°ƒæ¥å£ å¦‚åœ¨æ¶ˆè´¹çš„æ—¶å€™é˜Ÿåˆ—è¢«åˆ é™¤æ‰äº†</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºCancelCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> (consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®å‚æ•°å€¼ä¸ºfalseï¼Œè®¾ç½®ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”çš„ä»£ç åœ¨DeliverCallbackæ¶ˆè´¹æ¥å£ä¸­è¿›è¡Œå®ç°</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">autoAck</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸä¹‹åæ˜¯å¦è¦è‡ªåŠ¨åº”ç­”trueï¼šä»£è¡¨è‡ªåŠ¨åº”ç­”false:ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(TASK_QUEUE_NAME, autoAck, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="RabbitMQæŒä¹…åŒ–"><a href="#RabbitMQæŒä¹…åŒ–" class="headerlink" title="RabbitMQæŒä¹…åŒ–"></a>RabbitMQæŒä¹…åŒ–</h2><p>å½“ RabbitMQ æœåŠ¡åœæ‰ä»¥åï¼Œæ¶ˆæ¯ç”Ÿäº§è€…å‘é€è¿‡æ¥çš„æ¶ˆæ¯ä¸ä¸¢å¤±è¦å¦‚ä½•ä¿éšœï¼Ÿé»˜è®¤æƒ…å†µä¸‹ RabbitMQ é€€å‡ºæˆ–ç”±äºæŸç§åŸå› å´©æºƒæ—¶ï¼Œå®ƒå¿½è§†é˜Ÿåˆ—å’Œæ¶ˆæ¯ï¼Œé™¤éå‘ŠçŸ¥å®ƒä¸è¦è¿™æ ·åšã€‚ç¡®ä¿æ¶ˆæ¯ä¸ä¼šä¸¢å¤±éœ€è¦åšä¸¤ä»¶äº‹ï¼š<strong>æˆ‘ä»¬éœ€è¦å°†é˜Ÿåˆ—å’Œæ¶ˆæ¯éƒ½æ ‡è®°ä¸ºæŒä¹…åŒ–ã€‚</strong></p><h3 id="é˜Ÿåˆ—æŒä¹…åŒ–å’Œæ¶ˆæ¯æŒä¹…åŒ–è§£é‡Š"><a href="#é˜Ÿåˆ—æŒä¹…åŒ–å’Œæ¶ˆæ¯æŒä¹…åŒ–è§£é‡Š" class="headerlink" title="é˜Ÿåˆ—æŒä¹…åŒ–å’Œæ¶ˆæ¯æŒä¹…åŒ–è§£é‡Š"></a>é˜Ÿåˆ—æŒä¹…åŒ–å’Œæ¶ˆæ¯æŒä¹…åŒ–è§£é‡Š</h3><ul><li>åœ¨ RabbitMQ ä¸­ï¼Œæ¶ˆæ¯æŒä¹…åŒ–å’Œé˜Ÿåˆ—æŒä¹…åŒ–æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ¦‚å¿µï¼Œå› æ­¤å¯ä»¥åˆ†åˆ«å¼€å¯å®ƒä»¬ï¼Œä¸éœ€è¦åŒæ—¶å¼€å¯é˜Ÿåˆ—æŒä¹…åŒ–æ¥å¯ç”¨æ¶ˆæ¯æŒä¹…åŒ–ã€‚</li><li>åœ¨ RabbitMQ ä¸­ï¼Œæ¶ˆæ¯æŒä¹…åŒ–å’Œé˜Ÿåˆ—æŒä¹…åŒ–å¯ä»¥ä¿è¯æ¶ˆæ¯åœ¨ RabbitMQ æœåŠ¡å™¨å‘ç”Ÿæ•…éšœæ—¶ä¸ä¼šä¸¢å¤±ï¼Œä½†å®ƒä»¬å¹¶ä¸ä¼šå½±å“æ¶ˆæ¯è¢«æ¶ˆè´¹åæ˜¯å¦è¢«åˆ é™¤çš„è¡Œä¸ºã€‚å½“ä¸€ä¸ªæ¶ˆè´¹è€…ä»ä¸€ä¸ªé˜Ÿåˆ—ä¸­è·å–ä¸€æ¡æ¶ˆæ¯å¹¶å¤„ç†å®Œæˆåï¼Œè¯¥æ¶ˆæ¯é»˜è®¤æƒ…å†µä¸‹ä¼šè¢«ä»é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿æ‚¨å¼€å¯äº†æ¶ˆæ¯æŒä¹…åŒ–å’Œé˜Ÿåˆ—æŒä¹…åŒ–ï¼Œä»é˜Ÿåˆ—ä¸­è·å–å¹¶å¤„ç†çš„æ¶ˆæ¯ä»ç„¶ä¼šè¢«åˆ é™¤ï¼Œä¸ä¼šè¢«ä¿å­˜åœ¨é˜Ÿåˆ—ä¸­ã€‚</li></ul><h3 id="é˜Ÿåˆ—æŒä¹…åŒ–"><a href="#é˜Ÿåˆ—æŒä¹…åŒ–" class="headerlink" title="é˜Ÿåˆ—æŒä¹…åŒ–"></a>é˜Ÿåˆ—æŒä¹…åŒ–</h3><p>ä¹‹å‰åˆ›å»ºçš„é˜Ÿåˆ—éƒ½æ˜¯éæŒä¹…åŒ–çš„ï¼ŒRabbitMQ å¦‚æœé‡å¯çš„åŒ–ï¼Œè¯¥é˜Ÿåˆ—å°±ä¼šè¢«åˆ é™¤æ‰ï¼Œå¦‚æœè¦é˜Ÿåˆ—å®ç°æŒä¹…åŒ–éœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—çš„æ—¶å€™æŠŠ durable å‚æ•°è®¾ç½®ä¸ºtrueï¼Œä»£è¡¨å¼€å¯æŒä¹…åŒ–</p><blockquote><p><strong>å·²ç»å¼€å¯æŒä¹…åŒ–çš„é˜Ÿåˆ—ï¼Œä¼šå†<code>Features</code>ä¸­æ ‡æ³¨<code>D</code></strong></p></blockquote><p><img src="https://www.naste.top:9000/images/image-20230525101558937.png" alt="image-20230525101558937"></p><h4 id="ç”Ÿäº§è€…-2"><a href="#ç”Ÿäº§è€…-2" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><blockquote><p><strong>å¦‚æœå³å°†åˆ›å»ºçš„é˜Ÿåˆ—åœ¨ä¹‹å‰æ˜¯éæŒä¹…åŒ–åˆ›å»ºçš„ï¼Œå¿…é¡»è¦å…ˆå°†åˆ›å»ºçš„éæŒä¹…åŒ–é˜Ÿåˆ—è¿›è¡Œåˆ é™¤ï¼Œç„¶åå†åˆ›å»ºæ–°çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œå†RabbitMQçš„webæ§åˆ¶å°ä¸Šè¿›è¡Œåˆ é™¤</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå¹¶ä¸”åœ¨åˆ›å»ºé˜Ÿåˆ—çš„æ—¶å€™ï¼Œè¿›è¡Œé˜Ÿåˆ—æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTwo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//å¼€å¯æŒä¹…åŒ–</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">durable</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(TASK_QUEUE_NAME, durable, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸­è¾“å…¥éœ€è¦ç”Ÿäº§çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä¿¡æ¯ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">             * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">             * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, TASK_QUEUE_NAME, <span class="literal">null</span>, message.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…-2"><a href="#æ¶ˆè´¹è€…-2" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.CancelCallback;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.SleepUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€…ä»£ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTwo</span> &#123;</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¥å—æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        System.out.println(<span class="string">&quot;C1ç­‰å¾…æ¥å—æ¶ˆæ¯å¤„ç†æ—¶é—´è¾ƒçŸ­&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¨é€çš„æ¶ˆæ¯å¦‚ä½•è¿›è¡Œæ¶ˆè´¹çš„æ¥å£å›è°ƒï¼Œåœ¨è¯¥æ¥å£ä¸­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºDeliverCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ²‰ç¡1S</span></span><br><span class="line">            SleepUtils.sleep(<span class="number">1</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥å—åˆ°çš„æ¶ˆæ¯:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 1.æ¶ˆæ¯çš„æ ‡è®°Tag</span></span><br><span class="line"><span class="comment">             * 2.æ˜¯å¦æ‰¹é‡åº”ç­” falseè¡¨ç¤ºä¸æ‰¹é‡åº”ç­”ä¿¡é“ä¸­çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–æ¶ˆæ¶ˆè´¹çš„ä¸€ä¸ªå›è°ƒæ¥å£ å¦‚åœ¨æ¶ˆè´¹çš„æ—¶å€™é˜Ÿåˆ—è¢«åˆ é™¤æ‰äº†</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºCancelCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> (consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®å‚æ•°å€¼ä¸ºfalseï¼Œè®¾ç½®ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”çš„ä»£ç åœ¨DeliverCallbackæ¶ˆè´¹æ¥å£ä¸­è¿›è¡Œå®ç°</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">autoAck</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸä¹‹åæ˜¯å¦è¦è‡ªåŠ¨åº”ç­”trueï¼šä»£è¡¨è‡ªåŠ¨åº”ç­”false:ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(TASK_QUEUE_NAME, autoAck, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆæ¯æŒä¹…åŒ–"><a href="#æ¶ˆæ¯æŒä¹…åŒ–" class="headerlink" title="æ¶ˆæ¯æŒä¹…åŒ–"></a>æ¶ˆæ¯æŒä¹…åŒ–</h3><h4 id="ç”Ÿäº§è€…-3"><a href="#ç”Ÿäº§è€…-3" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><blockquote><p><strong>éœ€è¦ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯çš„æ—¶å€™è¿›è¡Œæ¶ˆæ¯æŒä¹…åŒ–</strong></p><p><strong>åœ¨ basicPublish æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ·»åŠ è¿™ä¸ªå±æ€§ï¼š <code>MessageProperties.PERSISTENT_TEXT_PLAIN</code></strong></p></blockquote><p>å°†æ¶ˆæ¯æ ‡è®°ä¸ºæŒä¹…åŒ–å¹¶ä¸èƒ½å®Œå…¨ä¿è¯ä¸ä¼šä¸¢å¤±æ¶ˆæ¯ã€‚å°½ç®¡å®ƒå‘Šè¯‰ RabbitMQ å°†æ¶ˆæ¯ä¿å­˜åˆ°ç£ç›˜ï¼Œä½†æ˜¯è¿™é‡Œä¾ç„¶å­˜åœ¨å½“æ¶ˆæ¯åˆšå‡†å¤‡å­˜å‚¨åœ¨ç£ç›˜çš„æ—¶å€™ ä½†æ˜¯è¿˜æ²¡æœ‰å­˜å‚¨å®Œï¼Œæ¶ˆæ¯è¿˜åœ¨ç¼“å­˜çš„ä¸€ä¸ªé—´éš”ç‚¹ã€‚æ­¤æ—¶å¹¶æ²¡ æœ‰çœŸæ­£å†™å…¥ç£ç›˜ã€‚æŒä¹…æ€§ä¿è¯å¹¶ä¸å¼ºï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬çš„ç®€å•ä»»åŠ¡é˜Ÿåˆ—è€Œè¨€ï¼Œè¿™å·²ç»ç»°ç»°æœ‰ä½™äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.MessageProperties;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå¹¶ä¸”å†æ¶ˆæ¯ç”Ÿäº§çš„æ—¶å€™ï¼Œè¿›è¡Œæ¶ˆæ¯æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTwo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(TASK_QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸­è¾“å…¥éœ€è¦ç”Ÿäº§çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä¿¡æ¯ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">             * 3.å…¶ä»–å‚æ•°ä¿¡æ¯ï¼Œè¿™ä½¿ç”¨ã€MessageProperties.PERSISTENT_TEXT_PLAINã€‘å¼€å¯æ¶ˆæ¯æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">             * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, TASK_QUEUE_NAME, MessageProperties.PERSISTENT_TEXT_PLAIN, message.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…-3"><a href="#æ¶ˆè´¹è€…-3" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><blockquote><p><strong>å’Œé˜Ÿåˆ—æŒä¹…åŒ–ä¸­çš„æ¶ˆè´¹è€…ä»£ç ä¸€è‡´</strong></p></blockquote><h2 id="ä¸å…¬å¹³åˆ†å‘"><a href="#ä¸å…¬å¹³åˆ†å‘" class="headerlink" title="ä¸å…¬å¹³åˆ†å‘"></a>ä¸å…¬å¹³åˆ†å‘</h2><blockquote><p><strong>åŸæ¥å¤šä¸ªæ¶ˆè´¹è€…æ˜¯é‡‡ç”¨è½®è¯¢æ¶ˆè´¹ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…ä¸€ä¸ªã€‚ä½†æ˜¯å¯èƒ½ç”±äºæ¯ä¸ªæ¶ˆè´¹è€…çš„å¤„ç†æ¶ˆæ¯çš„èƒ½åŠ›ä¸åŒï¼Œæ‰€ä»¥æ‰‹åŠ¨å¹²é¢„æ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œ<code>å¤„ç†æ¶ˆæ¯å¿«çš„æ¶ˆè´¹è€…å¤šæ¶ˆè´¹æ¶ˆæ¯ï¼Œèƒ½è€…å¤šåŠ³</code></strong></p><p><strong>åœ¨æ¶ˆè´¹è€…ä¸­æ¶ˆè´¹æ¶ˆæ¯ä¹‹å‰ï¼Œæ‰€æœ‰çš„æ¶ˆè´¹è€…éƒ½è¦è®¾ç½®å‚æ•° <code>channel.basicQos(1);</code></strong></p><p><strong>ä¸å…¬å¹³åˆ†å‘å’Œé¢„å–å€¼åˆ†å‘éƒ½ç”¨åˆ° <code>basicQos</code> æ–¹æ³•ï¼Œå¦‚æœå–å€¼ä¸º 1ï¼Œä»£è¡¨ä¸å…¬å¹³åˆ†å‘ï¼Œå–å€¼ä¸ä¸º1ï¼Œä»£è¡¨é¢„å–å€¼åˆ†å‘</strong></p></blockquote><p>åœ¨æœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬å­¦ä¹ åˆ° RabbitMQ åˆ†å‘æ¶ˆæ¯é‡‡ç”¨çš„è½®è¯¢åˆ†å‘ï¼Œä½†æ˜¯åœ¨æŸç§åœºæ™¯ä¸‹è¿™ç§ç­–ç•¥å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯”æ–¹è¯´æœ‰ä¸¤ä¸ªæ¶ˆè´¹è€…åœ¨å¤„ç†ä»»åŠ¡ï¼Œå…¶ä¸­æœ‰ä¸ª<strong>æ¶ˆè´¹è€… 1</strong> å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦éå¸¸å¿«ï¼Œè€Œå¦å¤–ä¸€ä¸ª<strong>æ¶ˆè´¹è€… 2</strong> å¤„ç†é€Ÿåº¦å´å¾ˆæ…¢ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜æ˜¯é‡‡ç”¨è½®è¯¢åˆ†å‘çš„åŒ–å°±ä¼šåˆ°è¿™å¤„ç†é€Ÿåº¦å¿«çš„è¿™ä¸ªæ¶ˆè´¹è€…å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´å¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œå¤„ç†æ…¢çš„é‚£ä¸ªæ¶ˆè´¹è€…ä¸€ç›´åœ¨å¹²æ´»ï¼Œè¿™ç§åˆ†é…æ–¹å¼åœ¨è¿™ç§æƒ…å†µä¸‹å…¶å®å°±ä¸å¤ªå¥½ï¼Œä½†æ˜¯ RabbitMQ å¹¶ä¸çŸ¥é“è¿™ç§æƒ…å†µå®ƒä¾ç„¶å¾ˆå…¬å¹³çš„è¿›è¡Œåˆ†å‘ã€‚</p><h3 id="ç”Ÿäº§è€…-4"><a href="#ç”Ÿäº§è€…-4" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.MessageProperties;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTwo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(TASK_QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸­è¾“å…¥éœ€è¦ç”Ÿäº§çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä¿¡æ¯ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">             * 3.å…¶ä»–å‚æ•°ä¿¡æ¯ï¼Œè¿™ä½¿ç”¨ã€MessageProperties.PERSISTENT_TEXT_PLAINã€‘å¼€å¯æ¶ˆæ¯æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">             * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, TASK_QUEUE_NAME, MessageProperties.PERSISTENT_TEXT_PLAIN, message.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆè´¹è€…-4"><a href="#æ¶ˆè´¹è€…-4" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h3><blockquote><p><strong>æ¶ˆè´¹è€…ä»£ç ä¸­ï¼Œéƒ½éœ€è¦åŠ ä¸Š<code>channel.basicQos(1);</code></strong></p></blockquote><h4 id="æ¶ˆè´¹è€…1"><a href="#æ¶ˆè´¹è€…1" class="headerlink" title="æ¶ˆè´¹è€…1"></a>æ¶ˆè´¹è€…1</h4><blockquote><p><strong>æ¶ˆè´¹è€…1è¿˜åœ¨<code>DeliverCallback</code>å›è°ƒæ¥å£ä¸­åŠ å…¥äº†ç¡çœ çš„ä»£ç ï¼Œè¡¨ç¤ºä¸šåŠ¡å¤„ç†æ—¶é—´è¾ƒé•¿</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.CancelCallback;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.SleepUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Date: 2023/5/24</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XiaoFei</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTwo</span> &#123;</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¥å—æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¨é€çš„æ¶ˆæ¯å¦‚ä½•è¿›è¡Œæ¶ˆè´¹çš„æ¥å£å›è°ƒï¼Œåœ¨è¯¥æ¥å£ä¸­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºDeliverCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ²‰ç¡1S</span></span><br><span class="line">            SleepUtils.sleep(<span class="number">3</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥å—åˆ°çš„æ¶ˆæ¯:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 1.æ¶ˆæ¯çš„æ ‡è®°Tag</span></span><br><span class="line"><span class="comment">             * 2.æ˜¯å¦æ‰¹é‡åº”ç­” falseè¡¨ç¤ºä¸æ‰¹é‡åº”ç­”ä¿¡é“ä¸­çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–æ¶ˆæ¶ˆè´¹çš„ä¸€ä¸ªå›è°ƒæ¥å£ å¦‚åœ¨æ¶ˆè´¹çš„æ—¶å€™é˜Ÿåˆ—è¢«åˆ é™¤æ‰äº†</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºCancelCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> (consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®ä¸å…¬å¹³åˆ†å‘</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">prefetchCount</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        channel.basicQos(prefetchCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®å‚æ•°å€¼ä¸ºfalseï¼Œè®¾ç½®ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”çš„ä»£ç åœ¨DeliverCallbackæ¶ˆè´¹æ¥å£ä¸­è¿›è¡Œå®ç°</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">autoAck</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸä¹‹åæ˜¯å¦è¦è‡ªåŠ¨åº”ç­”trueï¼šä»£è¡¨è‡ªåŠ¨åº”ç­”false:ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(TASK_QUEUE_NAME, autoAck, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…2"><a href="#æ¶ˆè´¹è€…2" class="headerlink" title="æ¶ˆè´¹è€…2"></a>æ¶ˆè´¹è€…2</h4><blockquote><p><strong>æ¶ˆè´¹è€…2è¿˜åœ¨<code>DeliverCallback</code>å›è°ƒæ¥å£ä¸­æ²¡æœ‰åŠ å…¥äº†ç¡çœ çš„ä»£ç ï¼Œè¡¨ç¤ºä¸šåŠ¡å¤„ç†æ—¶é—´è¾ƒçŸ­ï¼Œå¯ä»¥å¤„ç†è¾ƒå¤šçš„æ¶ˆæ¯</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.CancelCallback;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerThree</span> &#123;</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¥å—æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¨é€çš„æ¶ˆæ¯å¦‚ä½•è¿›è¡Œæ¶ˆè´¹çš„æ¥å£å›è°ƒï¼Œåœ¨è¯¥æ¥å£ä¸­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºDeliverCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            </span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥å—åˆ°çš„æ¶ˆæ¯:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 1.æ¶ˆæ¯çš„æ ‡è®°Tag</span></span><br><span class="line"><span class="comment">             * 2.æ˜¯å¦æ‰¹é‡åº”ç­” falseè¡¨ç¤ºä¸æ‰¹é‡åº”ç­”ä¿¡é“ä¸­çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–æ¶ˆæ¶ˆè´¹çš„ä¸€ä¸ªå›è°ƒæ¥å£ å¦‚åœ¨æ¶ˆè´¹çš„æ—¶å€™é˜Ÿåˆ—è¢«åˆ é™¤æ‰äº†</span></span><br><span class="line">        <span class="comment">//TODO è¿™é‡Œç”±äºCancelCallbackæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†Java8æä¾›çš„Lambdaè¡¨è¾¾å¼å®ç°äº†ï¼Œæ²¡æœ‰å¦å¤–å†å†™ä¸€ä¸ªç±»å®ç°è¯¥æ¥å£</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> (consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®ä¸å…¬å¹³åˆ†å‘</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">prefetchCount</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        channel.basicQos(prefetchCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®å‚æ•°å€¼ä¸ºfalseï¼Œè®¾ç½®ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”çš„ä»£ç åœ¨DeliverCallbackæ¶ˆè´¹æ¥å£ä¸­è¿›è¡Œå®ç°</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">autoAck</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸä¹‹åæ˜¯å¦è¦è‡ªåŠ¨åº”ç­”trueï¼šä»£è¡¨è‡ªåŠ¨åº”ç­”false:ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(TASK_QUEUE_NAME, autoAck, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h4><p><img src="https://www.naste.top:9000/images/image-20230525150516234.png" alt="image-20230525150516234"></p><h2 id="é¢„å–å€¼åˆ†å‘"><a href="#é¢„å–å€¼åˆ†å‘" class="headerlink" title="é¢„å–å€¼åˆ†å‘"></a>é¢„å–å€¼åˆ†å‘</h2><p>RabbitMQ æ˜¯ä¸€ç§æµè¡Œçš„æ¶ˆæ¯ä»£ç†ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºä¹‹é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ã€‚é¢„å–å€¼ï¼ˆPrefetchï¼‰æ˜¯ RabbitMQ ä¸­ç”¨äºæ§åˆ¶æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æ•°é‡çš„æœºåˆ¶ä¹‹ä¸€ï¼Œå®ƒæŒ‡å®šä¸€ä¸ªæ¶ˆè´¹è€…å¯ä»¥ä»é˜Ÿåˆ—ä¸­é¢„å–çš„æœªç¡®è®¤æ¶ˆæ¯çš„æœ€å¤§æ•°é‡ã€‚</p><p><strong>é¢„å–å€¼ä¸º 1 æ˜¯æœ€ä¿å®ˆçš„ã€‚å½“ç„¶è¿™å°†ä½¿ååé‡å˜å¾—å¾ˆä½ï¼Œç‰¹åˆ«æ˜¯æ¶ˆè´¹è€…è¿æ¥å»¶è¿Ÿå¾ˆä¸¥é‡çš„æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶ˆè´¹è€…è¿æ¥ç­‰å¾…æ—¶é—´è¾ƒé•¿çš„ç¯å¢ƒ ä¸­ã€‚å¯¹äºå¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œç¨å¾®é«˜ä¸€ç‚¹çš„å€¼å°†æ˜¯æœ€ä½³çš„ã€‚</strong></p><blockquote><p><strong>æ­¤æ—¶æœ‰ä¸¤ä¸ªå‘æ¶ˆè´¹è€…ï¼Œå¦‚æœç”Ÿäº§è€…æ€»å…±å‘å¸ƒäº†äº”æ¡æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…1è®¾ç½®<code>basicQos(2)</code>ï¼Œé‚£æ¶ˆè´¹è€…åªèƒ½æ¶ˆè´¹<code>ä¸¤æ¡</code>æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…2è®¾ç½®<code>basicQos(3)</code>ï¼Œé‚£æ¶ˆè´¹è€…åªèƒ½æ¶ˆè´¹<code>ä¸‰æ¡</code>æ¶ˆæ¯ï¼ŒæŒ‰æ¯”ä¾‹è¿›è¡Œæ¶ˆè´¹</strong></p><p><strong>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä»£ç å’Œå‰é¢çš„ä¸å…¬å¹³åˆ†å‘ä¸­ç”Ÿäº§è€…ä»£ç ä¸€æ ·ï¼Œåªæ˜¯<code>channel.basicQos(æ­£æ•´æ•°);</code>è®¾ç½®çš„å€¼ä¸ä¸€è‡´ï¼Œæ¥å½±å“æ¯ä¸ªæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹çš„æ¶ˆæ¯æ¯”ä¾‹ï¼Œé¿å…æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–å¤ªå¤šçš„æ¶ˆæ¯è€Œæ— æ³•åŠæ—¶å¤„ç†å®ƒä»¬</strong></p></blockquote><p><img src="https://www.naste.top:9000/images/image-20230525161925342.png" alt="image-20230525161925342"></p><h2 id="å‘å¸ƒç¡®è®¤"><a href="#å‘å¸ƒç¡®è®¤" class="headerlink" title="å‘å¸ƒç¡®è®¤"></a>å‘å¸ƒç¡®è®¤</h2><blockquote><p><strong>ç¡®è®¤å‘å¸ƒæŒ‡çš„æ˜¯æˆåŠŸå‘é€åˆ°äº†é˜Ÿåˆ—ï¼Œå¹¶ä¸æ˜¯æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ¶ˆæ¯</strong></p></blockquote><p>ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åˆ° RabbitMQ åï¼Œéœ€è¦ RabbitMQ è¿”å›ã€ ACKï¼ˆå·²æ”¶åˆ°ï¼‰ã€‘ç»™ç”Ÿäº§è€…ï¼Œè¿™æ ·ç”Ÿäº§è€…æ‰çŸ¥é“è‡ªå·±ç”Ÿäº§çš„æ¶ˆæ¯æˆåŠŸå‘å¸ƒå‡ºå»</p><h3 id="å‘å¸ƒç¡®è®¤é€»è¾‘"><a href="#å‘å¸ƒç¡®è®¤é€»è¾‘" class="headerlink" title="å‘å¸ƒç¡®è®¤é€»è¾‘"></a>å‘å¸ƒç¡®è®¤é€»è¾‘</h3><p>ç”Ÿäº§è€…å°†ä¿¡é“è®¾ç½®æˆ confirm æ¨¡å¼ï¼Œä¸€æ—¦ä¿¡é“è¿›å…¥ confirm æ¨¡å¼ï¼Œæ‰€æœ‰åœ¨è¯¥ä¿¡é“ä¸Šé¢å‘å¸ƒçš„æ¶ˆæ¯éƒ½å°†ä¼šè¢«æŒ‡æ´¾ä¸€ä¸ªå”¯ä¸€çš„ ID(ä» 1 å¼€å§‹)ï¼Œä¸€æ—¦æ¶ˆæ¯è¢«æŠ•é€’åˆ°æ‰€æœ‰åŒ¹é…çš„é˜Ÿåˆ—ä¹‹åï¼Œbroker å°±ä¼šå‘é€ä¸€ä¸ªç¡®è®¤ç»™ç”Ÿäº§è€…(åŒ…å«æ¶ˆæ¯çš„å”¯ä¸€ ID)ï¼Œè¿™å°±ä½¿å¾—ç”Ÿäº§è€…çŸ¥é“æ¶ˆæ¯å·²ç»æ­£ç¡®åˆ°è¾¾ç›®çš„é˜Ÿåˆ—äº†ï¼Œå¦‚æœæ¶ˆæ¯å’Œé˜Ÿåˆ—æ˜¯å¯æŒä¹…åŒ–çš„ï¼Œé‚£ä¹ˆç¡®è®¤æ¶ˆæ¯ä¼šåœ¨å°†æ¶ˆæ¯å†™å…¥ç£ç›˜ä¹‹åå‘å‡ºï¼Œbroker å›ä¼ ç»™ç”Ÿäº§è€…çš„ç¡®è®¤æ¶ˆæ¯ä¸­ delivery-tag åŸŸåŒ…å«äº†ç¡®è®¤æ¶ˆæ¯çš„åºåˆ—å·ï¼Œæ­¤å¤– broker ä¹Ÿå¯ä»¥è®¾ç½® basic.ack çš„ multiple åŸŸï¼Œè¡¨ç¤ºåˆ°è¿™ä¸ªåºåˆ—å·ä¹‹å‰çš„æ‰€æœ‰æ¶ˆæ¯éƒ½å·²ç»å¾—åˆ°äº†å¤„ç†ã€‚</p><p>confirm æ¨¡å¼æœ€å¤§çš„å¥½å¤„åœ¨äºæ˜¯å¼‚æ­¥çš„ï¼Œä¸€æ—¦å‘å¸ƒä¸€æ¡æ¶ˆæ¯ï¼Œç”Ÿäº§è€…åº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ç­‰ä¿¡é“è¿”å›ç¡®è®¤çš„åŒæ—¶ç»§ç»­å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼Œå½“æ¶ˆæ¯æœ€ç»ˆå¾—åˆ°ç¡®è®¤ä¹‹åï¼Œç”Ÿäº§è€…åº”ç”¨ä¾¿å¯ä»¥é€šè¿‡å›è°ƒæ–¹æ³•æ¥å¤„ç†è¯¥ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚æœRabbitMQ å› ä¸ºè‡ªèº«å†…éƒ¨é”™è¯¯å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œå°±ä¼šå‘é€ä¸€æ¡ nack æ¶ˆæ¯ï¼Œ ç”Ÿäº§è€…åº”ç”¨ç¨‹åºåŒæ ·å¯ä»¥åœ¨å›è°ƒæ–¹æ³•ä¸­å¤„ç†è¯¥ nack æ¶ˆæ¯</p><h3 id="å¼€å¯å‘å¸ƒç¡®è®¤æ–¹æ³•"><a href="#å¼€å¯å‘å¸ƒç¡®è®¤æ–¹æ³•" class="headerlink" title="å¼€å¯å‘å¸ƒç¡®è®¤æ–¹æ³•"></a>å¼€å¯å‘å¸ƒç¡®è®¤æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åœ¨ channel.queueDeclare( ) åï¼Œä½¿ç”¨ä¸‹é¢æ–¹æ³•å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">channel.confirmSelect();</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ channel.basicPublish() å°†æ¶ˆæ¯å‘å¸ƒåï¼Œä½¿ç”¨ä¸‹é¢æ–¹æ³•ï¼Œç¡®è®¤æ¶ˆæ¯å‘å¸ƒ</span></span><br><span class="line">channel.waitForConfirms();</span><br></pre></td></tr></table></figure><h3 id="å•ä¸ªç¡®è®¤å‘å¸ƒ"><a href="#å•ä¸ªç¡®è®¤å‘å¸ƒ" class="headerlink" title="å•ä¸ªç¡®è®¤å‘å¸ƒ"></a>å•ä¸ªç¡®è®¤å‘å¸ƒ</h3><p>è¿™æ˜¯ä¸€ç§ç®€å•çš„ç¡®è®¤æ–¹å¼ï¼Œå®ƒæ˜¯ä¸€ç§<strong>åŒæ­¥ç¡®è®¤å‘å¸ƒ</strong>çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ä¹‹ååªæœ‰å®ƒè¢«ç¡®è®¤å‘å¸ƒï¼Œåç»­çš„æ¶ˆæ¯æ‰èƒ½ç»§ç»­å‘å¸ƒï¼Œ<code>waitForConfirmsOrDie(long)</code> è¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨æ¶ˆæ¯è¢«ç¡®è®¤çš„æ—¶å€™æ‰è¿”å›ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…è¿™ä¸ªæ¶ˆæ¯æ²¡æœ‰è¢«ç¡®è®¤é‚£ä¹ˆå®ƒå°†æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>è¿™ç§ç¡®è®¤æ–¹å¼æœ‰ä¸€ä¸ªæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ï¼š<strong>å‘å¸ƒé€Ÿåº¦ç‰¹åˆ«çš„æ…¢</strong>ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ç¡®è®¤å‘å¸ƒçš„æ¶ˆæ¯å°±ä¼šé˜»å¡æ‰€æœ‰åç»­æ¶ˆæ¯çš„å‘å¸ƒï¼Œè¿™ç§æ–¹å¼æœ€å¤šæä¾›æ¯ç§’ä¸è¶…è¿‡æ•°ç™¾æ¡å‘å¸ƒæ¶ˆæ¯çš„ååé‡ã€‚å½“ç„¶å¯¹äºæŸäº›åº”ç”¨ç¨‹åºæ¥è¯´è¿™å¯èƒ½å·²ç»è¶³å¤Ÿäº†ã€‚</p><blockquote><p><strong>ä¸‹é¢ä¸ºæ¶ˆæ¯ç”Ÿäº§è€…çš„ä»£ç ï¼Œç”±äºç¡®è®¤å‘å¸ƒæ˜¯ç”Ÿäº§è€…çš„æ“ä½œï¼Œæ‰€ä»¥è¿™é‡Œä¸æä¾›æ¶ˆè´¹è€…ä»£ç äº†ï¼Œå‘å¸ƒç¡®è®¤ä»£ç ä½¿ç”¨äº†<code>TODO</code>æ ‡è®°</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•ä¸ªç¡®è®¤å‘å¸ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//å¯¹åˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//TODO å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, QUEUE_NAME, <span class="literal">null</span>, (i + <span class="string">&quot;&quot;</span>).getBytes());</span><br><span class="line">            <span class="comment">//TODO å•ä¸ªæ¶ˆæ¯å°±é©¬ä¸Šè¿›è¡Œå‘å¸ƒç¡®è®¤</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> channel.waitForConfirms();</span><br><span class="line">            <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å®Œæ¯•&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ‰¹é‡ç¡®è®¤å‘å¸ƒ"><a href="#æ‰¹é‡ç¡®è®¤å‘å¸ƒ" class="headerlink" title="æ‰¹é‡ç¡®è®¤å‘å¸ƒ"></a>æ‰¹é‡ç¡®è®¤å‘å¸ƒ</h3><blockquote><p><strong>æ‰¹é‡ç¡®è®¤å’Œå•ä¸ªç¡®è®¤å†™æ³•ä¸€è‡´ï¼Œåªæ˜¯æ‰§è¡Œ<code>channel.waitForConfirms()</code>æ–¹æ³•çš„æ—¶æœºä¸ä¸€è‡´ï¼Œæ‰¹é‡ç¡®è®¤æ˜¯ç­‰æ¶ˆæ¯å‘å¸ƒäº†æŒ‡å®šæ•°é‡çš„æ—¶å€™ï¼Œå†æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œå•ä¸ªç¡®è®¤å‘å¸ƒæ˜¯ï¼Œæ¶ˆæ¯ä¸€å‘å¸ƒå°±ç«‹åˆ»æ‰§è¡Œè¯¥æ–¹æ³•</strong></p></blockquote><p>å•ä¸ªç¡®è®¤å‘å¸ƒæ–¹å¼éå¸¸æ…¢ï¼Œä¸å•ä¸ªç­‰å¾…ç¡®è®¤æ¶ˆæ¯ç›¸æ¯”ï¼Œå…ˆå‘å¸ƒä¸€æ‰¹æ¶ˆæ¯ç„¶åä¸€èµ·ç¡®è®¤å¯ä»¥æå¤§åœ°æé«˜ååé‡ï¼Œå½“ç„¶è¿™ç§æ–¹å¼çš„ç¼ºç‚¹å°±æ˜¯ï¼šå½“å‘ç”Ÿæ•…éšœå¯¼è‡´å‘å¸ƒå‡ºç°é—®é¢˜æ—¶ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸ªæ¶ˆæ¯å‡ºé—®é¢˜äº†ï¼Œæˆ‘ä»¬å¿…é¡»å°†æ•´ä¸ªæ‰¹å¤„ç†ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä»¥è®°å½•é‡è¦çš„ä¿¡æ¯è€Œåé‡æ–°å‘å¸ƒæ¶ˆæ¯ã€‚å½“ç„¶è¿™ç§æ–¹æ¡ˆä»ç„¶æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸€æ ·é˜»å¡æ¶ˆæ¯çš„å‘å¸ƒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç”Ÿäº§è€…æ‰¹é‡ç¡®è®¤å‘å¸ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//å¯¹åˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//TODO å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//TODO æ‰¹é‡ç¡®è®¤æ¶ˆæ¯å¤§å°ï¼Œå½“æ¶ˆæ¯å‘å¸ƒå¤šå°‘æ¡åè¿›è¡Œå‘å¸ƒç¡®è®¤</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, QUEUE_NAME, <span class="literal">null</span>, (i + <span class="string">&quot;&quot;</span>).getBytes());</span><br><span class="line"></span><br><span class="line">            <span class="comment">//TODO åˆ¤æ–­è¾¾åˆ°100æ¡æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ‰¹é‡ç¡®è®¤ä¸€æ¬¡</span></span><br><span class="line">            <span class="keyword">if</span> ((i + <span class="number">1</span>) % batchSize == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">//TODO å‘å¸ƒç¡®è®¤</span></span><br><span class="line">                channel.waitForConfirms();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼‚æ­¥ç¡®è®¤"><a href="#å¼‚æ­¥ç¡®è®¤" class="headerlink" title="å¼‚æ­¥ç¡®è®¤"></a>å¼‚æ­¥ç¡®è®¤</h3><p>å¼‚æ­¥ç¡®è®¤è™½ç„¶ç¼–ç¨‹é€»è¾‘æ¯”ä¸Šä¸¤ä¸ªè¦å¤æ‚ï¼Œä½†æ˜¯æ€§ä»·æ¯”æœ€é«˜ï¼Œæ— è®ºæ˜¯å¯é æ€§è¿˜æ˜¯æ•ˆç‡éƒ½å¾ˆå¥½ï¼Œåˆ©ç”¨äº†å›è°ƒå‡½æ•°æ¥è¾¾åˆ°æ¶ˆæ¯å¯é æ€§ä¼ é€’çš„ï¼Œè¿™ä¸ªä¸­é—´ä»¶ä¹Ÿæ˜¯é€šè¿‡å‡½æ•°å›è°ƒæ¥ä¿è¯æ˜¯å¦æŠ•é€’æˆåŠŸï¼Œä¸‹é¢è¯¦ç»†è®²è§£å¼‚æ­¥ç¡®è®¤æ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p><p><img src="https://www.naste.top:9000/images/202305231852001.png" alt="202305231852001"></p><p>å®é™…æ¡ˆä¾‹é‡Œï¼Œå°†å‘å¸ƒçš„æ¶ˆæ¯å­˜å…¥ Map é‡Œï¼Œæ–¹ä¾¿è·å–ã€‚<code>headMap</code> æ–¹æ³•ç”¨äºå°†å·²ç¡®è®¤çš„æ¶ˆæ¯å­˜å…¥æ–°çš„ Map ç¼“å­˜åŒºé‡Œï¼Œç„¶åæ¸…é™¤è¯¥æ–°ç¼“å­˜åŒºçš„å†…å®¹ã€‚å› ä¸º <code>headMap</code> æ–¹æ³•æ˜¯æµ…æ‹·è´ï¼Œæ‰€ä»¥æ¸…é™¤äº†ç¼“å­˜åŒºï¼Œç›¸å½“äºæ¸…é™¤äº†å†…å®¹çš„åœ°å€ï¼Œä¹Ÿå°±æ¸…é™¤äº†é˜Ÿåˆ—çš„ç¡®è®¤çš„æ¶ˆæ¯ã€‚</p><p><strong>æœªå¤„ç†å¼‚æ­¥æœªç¡®è®¤æ¶ˆæ¯ä»£ç </strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConfirmCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¼‚æ­¥ç¡®è®¤æ¶ˆæ¯å‘å¸ƒï¼ˆæœªå¤„ç†å¼‚æ­¥æœªç¡®è®¤æ¶ˆæ¯ä»£ç ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//å¯¹åˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¶ˆæ¯ç¡®è®¤å›è°ƒçš„å‡½æ•°</span></span><br><span class="line">        <span class="type">ConfirmCallback</span> <span class="variable">ackCallback</span> <span class="operator">=</span> (deliveryTag, multiple) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¡®è®¤çš„æ¶ˆæ¯:&quot;</span> + deliveryTag);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆæ¯ç¡®è®¤å¤±è´¥å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆæ¯çš„æ ‡è®°</span></span><br><span class="line"><span class="comment">         * 2.æ˜¯å¦ä¸ºæ‰¹é‡ç¡®è®¤</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">ConfirmCallback</span> <span class="variable">nackCallback</span> <span class="operator">=</span> (deliveryTag, multiple) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æœªç¡®è®¤çš„æ¶ˆæ¯:&quot;</span> + deliveryTag);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å¼‚æ­¥é€šçŸ¥</span></span><br><span class="line"><span class="comment">         * å‡†å¤‡æ¶ˆæ¯çš„ç›‘å¬å™¨ ç›‘å¬é‚£äº›æ¶ˆæ¯æˆåŠŸäº†ï¼Œå“ªäº›æ¶ˆæ¯å¤±è´¥äº†</span></span><br><span class="line"><span class="comment">         * 1.ç›‘å¬å“ªäº›æ¶ˆæ¯æˆåŠŸäº†</span></span><br><span class="line"><span class="comment">         * 2.ç›‘å¬å“ªäº›æ¶ˆæ¯å¤±è´¥äº†</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.addConfirmListener(ackCallback, nackCallback);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, QUEUE_NAME, <span class="literal">null</span>, (i + <span class="string">&quot;&quot;</span>).getBytes());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤„ç†å¼‚æ­¥æœªç¡®è®¤æ¶ˆæ¯ä»£ç </strong></p><blockquote><p><strong>æœ€å¥½çš„è§£å†³çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠæœªç¡®è®¤çš„æ¶ˆæ¯æ”¾åˆ°ä¸€ä¸ªåŸºäºå†…å­˜çš„èƒ½è¢«å‘å¸ƒçº¿ç¨‹è®¿é—®çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚è¯´ç”¨ ConcurrentLinkedQueue è¿™ä¸ªé˜Ÿåˆ—åœ¨ confirm callbacks ä¸å‘å¸ƒçº¿ç¨‹ä¹‹é—´è¿›è¡Œæ¶ˆæ¯çš„ä¼ é€’ã€‚</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConfirmCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentNavigableMap;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentSkipListMap;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¼‚æ­¥ç¡®è®¤æ¶ˆæ¯å‘å¸ƒï¼ˆå¤„ç†å¼‚æ­¥æœªç¡®è®¤æ¶ˆæ¯ä»£ç ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//å¯¹åˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * çº¿ç¨‹å®‰å…¨æœ‰åºçš„ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œé€‚ç”¨äºé«˜å¹¶å‘çš„æƒ…å†µä¸‹</span></span><br><span class="line"><span class="comment">         * 1.è½»æ¾çš„å°†åºå·ä¸æ¶ˆæ¯è¿›è¡Œå…³è”</span></span><br><span class="line"><span class="comment">         * 2.è½»æ¾æ‰¹é‡åˆ é™¤æ¡ç›® åªè¦ç»™åˆ°åºå·</span></span><br><span class="line"><span class="comment">         * 3.æ”¯æŒé«˜å¹¶å‘(å¤šçº¿ç¨‹)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        ConcurrentSkipListMap&lt;Long, String&gt; outstandingConfirms =</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConcurrentSkipListMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¶ˆæ¯ç¡®è®¤å›è°ƒçš„å‡½æ•°</span></span><br><span class="line">        <span class="type">ConfirmCallback</span> <span class="variable">ackCallback</span> <span class="operator">=</span> (deliveryTag, multiple) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (multiple) &#123;</span><br><span class="line">                <span class="comment">//2.åˆ é™¤æ‰å·²ç»ç¡®è®¤çš„æ¶ˆæ¯ å‰©ä¸‹çš„å°±æ˜¯æœªç¡®è®¤çš„æ¶ˆæ¯</span></span><br><span class="line">                ConcurrentNavigableMap&lt;Long, String&gt; confirmed =</span><br><span class="line">                        outstandingConfirms.headMap(deliveryTag);</span><br><span class="line">                confirmed.clear();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                outstandingConfirms.remove(deliveryTag);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¡®è®¤çš„æ¶ˆæ¯:&quot;</span> + deliveryTag);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * æ¶ˆæ¯ç¡®è®¤å¤±è´¥å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆæ¯çš„æ ‡è®°</span></span><br><span class="line"><span class="comment">         * 2.æ˜¯å¦ä¸ºæ‰¹é‡ç¡®è®¤</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">ConfirmCallback</span> <span class="variable">nackCallback</span> <span class="operator">=</span> (deliveryTag, multiple) -&gt; &#123;</span><br><span class="line">            <span class="comment">//3.æ‰“å°ä¸€ä¸‹æœªç¡®è®¤çš„æ¶ˆæ¯éƒ½æœ‰å“ªäº›</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> outstandingConfirms.remove(deliveryTag);</span><br><span class="line">            System.out.println(<span class="string">&quot;æœªç¡®è®¤çš„æ¶ˆæ¯æ˜¯:&quot;</span> + message + <span class="string">&quot;:::æœªç¡®è®¤çš„æ¶ˆæ¯tag:&quot;</span> + deliveryTag);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å¼‚æ­¥é€šçŸ¥</span></span><br><span class="line"><span class="comment">         * å‡†å¤‡æ¶ˆæ¯çš„ç›‘å¬å™¨ ç›‘å¬é‚£äº›æ¶ˆæ¯æˆåŠŸäº†ï¼Œå“ªäº›æ¶ˆæ¯å¤±è´¥äº†</span></span><br><span class="line"><span class="comment">         * 1.ç›‘å¬å“ªäº›æ¶ˆæ¯æˆåŠŸäº†</span></span><br><span class="line"><span class="comment">         * 2.ç›‘å¬å“ªäº›æ¶ˆæ¯å¤±è´¥äº†</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.addConfirmListener(ackCallback, nackCallback);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, QUEUE_NAME, <span class="literal">null</span>, (i + <span class="string">&quot;&quot;</span>).getBytes());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸‰ç§å‘å¸ƒç¡®è®¤æ–¹å¼å¯¹æ¯”"><a href="#ä¸‰ç§å‘å¸ƒç¡®è®¤æ–¹å¼å¯¹æ¯”" class="headerlink" title="ä¸‰ç§å‘å¸ƒç¡®è®¤æ–¹å¼å¯¹æ¯”"></a>ä¸‰ç§å‘å¸ƒç¡®è®¤æ–¹å¼å¯¹æ¯”</h3><ul><li>å•ç‹¬å‘å¸ƒæ¶ˆæ¯ï¼šåŒæ­¥ç­‰å¾…ç¡®è®¤ï¼Œç®€å•ï¼Œä½†ååé‡éå¸¸æœ‰é™ã€‚</li><li>æ‰¹é‡å‘å¸ƒæ¶ˆæ¯ï¼šæ‰¹é‡åŒæ­¥ç­‰å¾…ç¡®è®¤ï¼Œç®€å•ï¼Œåˆç†çš„ååé‡ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜ä½†å¾ˆéš¾æ¨æ–­å‡ºæ˜¯é‚£æ¡æ¶ˆæ¯å‡ºç°äº†é—®é¢˜ã€‚</li><li>å¼‚æ­¥å¤„ç†ï¼šæœ€ä½³æ€§èƒ½å’Œèµ„æºä½¿ç”¨ï¼Œåœ¨å‡ºç°é”™è¯¯çš„æƒ…å†µä¸‹å¯ä»¥å¾ˆå¥½åœ°æ§åˆ¶ï¼Œä½†æ˜¯å®ç°èµ·æ¥ç¨å¾®éš¾äº›</li></ul><h2 id="æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒç¡®è®¤çš„åŒºåˆ«"><a href="#æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒç¡®è®¤çš„åŒºåˆ«" class="headerlink" title="æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒç¡®è®¤çš„åŒºåˆ«"></a>æ¶ˆæ¯åº”ç­”å’Œå‘å¸ƒç¡®è®¤çš„åŒºåˆ«</h2><p>æ¶ˆæ¯åº”ç­”ï¼šå±äºæ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹å®Œæ¶ˆæ¯å‘Šè¯‰ RabbitMQ å·²ç»æ¶ˆè´¹æˆåŠŸ</p><p>å‘å¸ƒç¡®è®¤ï¼šå±äºç”Ÿäº§è€…ï¼Œç”Ÿäº§æ¶ˆæ¯åˆ° RabbitMQï¼ŒRabbitMQ éœ€è¦å‘Šè¯‰ç”Ÿäº§è€…å·²ç»æ”¶åˆ°æ¶ˆæ¯</p><h1 id="äº¤æ¢æœº"><a href="#äº¤æ¢æœº" class="headerlink" title="äº¤æ¢æœº"></a>äº¤æ¢æœº</h1><p><img src="https://www.naste.top:9000/images/image-20230526172345156.png" alt="image-20230526172345156"></p><h2 id="äº¤æ¢æœºï¼ˆExchangesï¼‰"><a href="#äº¤æ¢æœºï¼ˆExchangesï¼‰" class="headerlink" title="äº¤æ¢æœºï¼ˆExchangesï¼‰"></a>äº¤æ¢æœºï¼ˆExchangesï¼‰</h2><p>RabbitMQ æ¶ˆæ¯ä¼ é€’æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>ç”Ÿäº§è€…ç”Ÿäº§çš„æ¶ˆæ¯ä»ä¸ä¼šç›´æ¥å‘é€åˆ°é˜Ÿåˆ—</strong>ã€‚å®é™…ä¸Šï¼Œé€šå¸¸ç”Ÿäº§è€…ç”šè‡³éƒ½ä¸çŸ¥é“è¿™äº›æ¶ˆæ¯ä¼ é€’ä¼ é€’åˆ°äº†å“ªäº›é˜Ÿåˆ—ä¸­ã€‚</p><p>ç›¸åï¼Œ<strong>ç”Ÿäº§è€…åªèƒ½å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœº(exchange)</strong>ï¼Œäº¤æ¢æœºå·¥ä½œçš„å†…å®¹éå¸¸ç®€å•ï¼Œä¸€æ–¹é¢å®ƒæ¥æ”¶æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹é¢å°†å®ƒä»¬æ¨å…¥é˜Ÿåˆ—ã€‚äº¤æ¢æœºå¿…é¡»ç¡®åˆ‡çŸ¥é“å¦‚ä½•å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯ã€‚æ˜¯åº”è¯¥æŠŠè¿™äº›æ¶ˆæ¯æ”¾åˆ°ç‰¹å®šé˜Ÿåˆ—è¿˜æ˜¯è¯´æŠŠä»–ä»¬åˆ°è®¸å¤šé˜Ÿåˆ—ä¸­è¿˜æ˜¯è¯´åº”è¯¥ä¸¢å¼ƒå®ƒä»¬ã€‚è¿™å°±çš„ç”±äº¤æ¢æœºçš„ç±»å‹æ¥å†³å®šã€‚</p><h2 id="äº¤æ¢æœºç±»å‹"><a href="#äº¤æ¢æœºç±»å‹" class="headerlink" title="äº¤æ¢æœºç±»å‹"></a>äº¤æ¢æœºç±»å‹</h2><ul><li><p><strong>ç›´æ¥(direct)</strong>ï¼šå¤„ç†è·¯ç”±é”®ã€‚éœ€è¦å°†ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºä¸Šï¼Œè¦æ±‚è¯¥æ¶ˆæ¯ä¸ä¸€ä¸ªç‰¹å®šçš„è·¯ç”±é”®å®Œå…¨åŒ¹é…ã€‚è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŒ¹é…ã€‚å¦‚æœä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°è¯¥äº¤æ¢æœºä¸Šè¦æ±‚è·¯ç”±é”® abc ï¼Œåˆ™åªæœ‰è¢«æ ‡è®°ä¸º abc çš„æ¶ˆæ¯æ‰è¢«è½¬å‘ï¼Œä¸ä¼šè½¬å‘ abc.defï¼Œä¹Ÿä¸ä¼šè½¬å‘ dog.ghiï¼Œåªä¼šè½¬å‘ abcã€‚</p></li><li><p><strong>ä¸»é¢˜(topic)</strong>ï¼šå°†è·¯ç”±é”®å’ŒæŸæ¨¡å¼è¿›è¡ŒåŒ¹é…ã€‚æ­¤æ—¶é˜Ÿåˆ—éœ€è¦ç»‘å®šè¦ä¸€ä¸ªæ¨¡å¼ä¸Šã€‚ç¬¦å·â€œ#â€åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯ï¼Œç¬¦å· <em> åŒ¹é…ä¸å¤šä¸å°‘ä¸€ä¸ªè¯ã€‚å› æ­¤ abc.# èƒ½å¤ŸåŒ¹é…åˆ° abc.def.ghiï¼Œä½†æ˜¯ abc.</em> åªä¼šåŒ¹é…åˆ° abc.defã€‚</p></li><li><p><strong>æ ‡é¢˜(headers)</strong>ï¼šä¸å¤„ç†è·¯ç”±é”®ã€‚è€Œæ˜¯æ ¹æ®å‘é€çš„æ¶ˆæ¯å†…å®¹ä¸­çš„headerså±æ€§è¿›è¡ŒåŒ¹é…ã€‚åœ¨ç»‘å®š Queue ä¸ Exchange æ—¶æŒ‡å®šä¸€ç»„é”®å€¼å¯¹ï¼›å½“æ¶ˆæ¯å‘é€åˆ°RabbitMQ æ—¶ä¼šå–åˆ°è¯¥æ¶ˆæ¯çš„ headers ä¸ Exchange ç»‘å®šæ—¶æŒ‡å®šçš„é”®å€¼å¯¹è¿›è¡ŒåŒ¹é…ï¼›å¦‚æœå®Œå…¨åŒ¹é…åˆ™æ¶ˆæ¯ä¼šè·¯ç”±åˆ°è¯¥é˜Ÿåˆ—ï¼Œå¦åˆ™ä¸ä¼šè·¯ç”±åˆ°è¯¥é˜Ÿåˆ—ã€‚headers å±æ€§æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå¯ä»¥æ˜¯ Hashtableï¼Œé”®å€¼å¯¹çš„å€¼å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚è€Œ fanoutï¼Œdirectï¼Œtopic çš„è·¯ç”±é”®éƒ½éœ€è¦è¦å­—ç¬¦ä¸²å½¢å¼çš„ã€‚</p><ul><li>åŒ¹é…è§„åˆ™ x-match æœ‰ä¸‹åˆ—ä¸¤ç§ç±»å‹ï¼š<ul><li>x-match = all ï¼šè¡¨ç¤ºæ‰€æœ‰çš„é”®å€¼å¯¹éƒ½åŒ¹é…æ‰èƒ½æ¥å—åˆ°æ¶ˆæ¯</li><li>x-match = any ï¼šè¡¨ç¤ºåªè¦æœ‰é”®å€¼å¯¹åŒ¹é…å°±èƒ½æ¥å—åˆ°æ¶ˆæ¯</li></ul></li></ul></li><li><p><strong>æ‰‡å‡º(fanout)</strong>ï¼šä¸å¤„ç†è·¯ç”±é”®ã€‚ä½ åªéœ€è¦ç®€å•çš„å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºä¸Šã€‚ä¸€ä¸ªå‘é€åˆ°äº¤æ¢æœºçš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥äº¤æ¢æœºç»‘å®šçš„æ‰€æœ‰é˜Ÿåˆ—ä¸Šã€‚å¾ˆåƒå­ç½‘å¹¿æ’­ï¼Œæ¯å°å­ç½‘å†…çš„ä¸»æœºéƒ½è·å¾—äº†ä¸€ä»½å¤åˆ¶çš„æ¶ˆæ¯ã€‚Fanout äº¤æ¢æœºè½¬å‘æ¶ˆæ¯æ˜¯æœ€å¿«çš„ã€‚<code>ç±»ä¼¼äºï¼Œå¤šä¸ªäººå…³æ³¨ä¸€ä¸ªå…¬ä¼—å·ï¼Œè¯¥å…¬ä¼—å·å‘å¸ƒæ¶ˆæ¯ï¼Œæ‰€æœ‰è®¢é˜…çš„äººéƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯</code></p></li><li><p><strong>é»˜è®¤</strong>ï¼šé€šè¿‡ç©ºå­—ç¬¦ä¸²(â€œâ€)è¿›è¡Œæ ‡è¯†çš„äº¤æ¢æœºæ˜¯é»˜è®¤äº¤æ¢</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº¤æ¢æœºçš„åç§°ã€‚ç©ºå­—ç¬¦ä¸² è¡¨ç¤ºé»˜è®¤æˆ–æ— åç§°äº¤æ¢æœºï¼šæ¶ˆæ¯èƒ½è·¯ç”±å‘é€åˆ°é˜Ÿåˆ—ä¸­å…¶å®æ˜¯ç”± routingKey(bindingkey) ç»‘å®šæŒ‡å®šçš„ key</span></span><br><span class="line">channel.basicPublish(<span class="string">&quot;&quot;</span>, QUEUE_NAME, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br></pre></td></tr></table></figure><p>  <img src="https://www.naste.top:9000/images/image-20230526172615744.png" alt="image-20230526172615744"></p></li></ul><h2 id="ä¸´æ—¶é˜Ÿåˆ—"><a href="#ä¸´æ—¶é˜Ÿåˆ—" class="headerlink" title="ä¸´æ—¶é˜Ÿåˆ—"></a>ä¸´æ—¶é˜Ÿåˆ—</h2><p>ä¹‹å‰çš„ä½¿ç”¨çš„æ˜¯å…·æœ‰ç‰¹å®šåç§°çš„é˜Ÿåˆ—(è¿˜è®°å¾— hello å’Œ ack_queue å—ï¼Ÿ)ã€‚é˜Ÿåˆ—çš„åç§°æˆ‘ä»¬æ¥è¯´è‡³å…³é‡è¦ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šæˆ‘ä»¬çš„æ¶ˆè´¹è€…å»æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—çš„æ¶ˆæ¯ã€‚</p><p>æ¯å½“æˆ‘ä»¬è¿æ¥åˆ° Rabbit æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªå…¨æ–°çš„ç©ºé˜Ÿåˆ—ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰<strong>éšæœºåç§°çš„é˜Ÿåˆ—</strong>ï¼Œæˆ–è€…èƒ½è®©æœåŠ¡å™¨ä¸ºæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªéšæœºé˜Ÿåˆ—åç§°é‚£å°±æ›´å¥½äº†ã€‚å…¶æ¬¡ä¸€æ—¦æˆ‘ä»¬æ–­å¼€äº†æ¶ˆè´¹è€…çš„è¿æ¥ï¼Œé˜Ÿåˆ—å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚</p><p>åˆ›å»ºä¸´æ—¶é˜Ÿåˆ—çš„æ–¹å¼å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–åˆ›å»ºçš„ä¸´æ—¶é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> channel.queueDeclare().getQueue();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºä¸´æ—¶é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTwo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_MESSAGE&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">//è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸´æ—¶é˜Ÿåˆ—å¹¶ä¸”è·å–åˆ›å»ºçš„ä¸´æ—¶é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> channel.queueDeclare().getQueue();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿäº§ä¸€ä¸ªå¯¹åˆ—</span></span><br><span class="line"><span class="comment">         * 1.å¯¹åˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.å¯¹åˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrueå¯ä»¥å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ falseï¼šåªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€é“¾æ¥ä»¥åï¼Œè¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrueè¡¨ç¤ºè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(queueName, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸­è¾“å…¥éœ€è¦ç”Ÿäº§çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;è¯·è¾“å…¥ä¿¡æ¯ï¼š&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * å‘é€ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">             * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * 2.è·¯ç”±çš„keyå€¼æ˜¯å“ªä¸ªæœ¬æ¬¡æ˜¯é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">             * 3.å…¶ä»–å‚æ•°ä¿¡æ¯ï¼Œè¿™ä½¿ç”¨ã€MessageProperties.PERSISTENT_TEXT_PLAINã€‘å¼€å¯æ¶ˆæ¯æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">             * 4.å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ä½“</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="literal">null</span>, message.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/image-20230526173242830.png" alt="image-20230526173242830"></p><h2 id="ç»‘å®šäº¤æ¢æœºï¼ˆç»‘å®šbindingsï¼‰"><a href="#ç»‘å®šäº¤æ¢æœºï¼ˆç»‘å®šbindingsï¼‰" class="headerlink" title="ç»‘å®šäº¤æ¢æœºï¼ˆç»‘å®šbindingsï¼‰"></a>ç»‘å®šäº¤æ¢æœºï¼ˆç»‘å®šbindingsï¼‰</h2><p>ä»€ä¹ˆæ˜¯ bingding å‘¢ï¼Œbinding å…¶å®æ˜¯ exchange å’Œ queue ä¹‹é—´çš„æ¡¥æ¢ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ exchange å’Œé‚£ä¸ªé˜Ÿåˆ—è¿›è¡Œäº†ç»‘å®šå…³ç³»ã€‚æ¯”å¦‚è¯´ä¸‹é¢è¿™å¼ å›¾å‘Šè¯‰æˆ‘ä»¬çš„å°±æ˜¯ äº¤æ¢æœº ä¸ é˜Ÿåˆ—1 å’Œ é˜Ÿåˆ—2 è¿›è¡Œäº†ç»‘å®š</p><p><img src="https://www.naste.top:9000/images/image-20230526192930194.png" alt="image-20230526192930194"></p><h2 id="å„ç±»å‹äº¤æ¢æœºä½¿ç”¨"><a href="#å„ç±»å‹äº¤æ¢æœºä½¿ç”¨" class="headerlink" title="å„ç±»å‹äº¤æ¢æœºä½¿ç”¨"></a>å„ç±»å‹äº¤æ¢æœºä½¿ç”¨</h2><h3 id="Fanout"><a href="#Fanout" class="headerlink" title="Fanout"></a>Fanout</h3><p>ä¸ºäº†è¯´æ˜è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç®€å•çš„æ—¥å¿—ç³»ç»Ÿã€‚å®ƒå°†ç”±ä¸¤ä¸ªç¨‹åºç»„æˆ:ç¬¬ä¸€ä¸ªç¨‹åºå°†å‘å‡ºæ—¥å¿—æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªç¨‹åºæ˜¯æ¶ˆè´¹è€…ã€‚å…¶ä¸­å¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åæŠŠæ—¥å¿—å­˜å‚¨åœ¨ç£ç›˜</p><h4 id="ç”Ÿäº§è€…-5"><a href="#ç”Ÿäº§è€…-5" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€ç»™äº¤æ¢æœº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;exchange_test&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * åˆ›å»ºä¸€ä¸ªexchangeï¼ˆäº¤æ¢æœºï¼‰</span></span><br><span class="line"><span class="comment">         * 1.exchangeçš„åç§°</span></span><br><span class="line"><span class="comment">         * 2.exchangeçš„ç±»å‹</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.FANOUT);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * å‘é€æ¶ˆæ¯ç»™æŒ‡å®šçš„äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * exchangeï¼ˆäº¤æ¢å™¨ï¼‰ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ¶ˆæ¯å°†è¦å‘é€åˆ°å“ªä¸ªäº¤æ¢å™¨ã€‚</span></span><br><span class="line"><span class="comment">             * routing_keyï¼ˆè·¯ç”±é”®ï¼‰ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ¶ˆæ¯çš„è·¯ç”±é”®ï¼Œç”¨äºé€‰æ‹©ä¸è¯¥è·¯ç”±é”®åŒ¹é…çš„é˜Ÿåˆ—ã€‚</span></span><br><span class="line"><span class="comment">             * propertiesï¼ˆå±æ€§ï¼‰ï¼šä¸€ä¸ªAMQPå±æ€§å¯¹è±¡ï¼Œç”¨äºæºå¸¦ä¸€äº›é¢å¤–çš„å…ƒæ•°æ®ï¼ˆå¦‚æ¶ˆæ¯ç±»å‹ã€ä¼˜å…ˆçº§ç­‰ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">             * bodyï¼ˆæ¶ˆæ¯ä½“ï¼‰ï¼šä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œè¡¨ç¤ºæ¶ˆæ¯çš„å†…å®¹ã€‚</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(EXCHANGE_NAME, <span class="string">&quot;&quot;</span>, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…-5"><a href="#æ¶ˆè´¹è€…-5" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€…ï¼Œé€šè¿‡å¸®ä¼šé¡¶çš„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerOne</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;exchange_test&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜ä¸€ä¸ªäº¤æ¢æœºã€äº¤æ¢æœºåç§°ï¼Œäº¤æ¢æœºç±»å‹ã€‘</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.FANOUT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—çš„åç§°æ˜¯éšæœºçš„</span></span><br><span class="line"><span class="comment">         * å½“æ¶ˆè´¹è€…æ–­å¼€ä¸é˜Ÿåˆ—çš„è¿æ¥çš„æ—¶å€™ é˜Ÿåˆ—å°±è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> channel.queueDeclare().getQueue();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç»‘å®šäº¤æ¢æœºä¸é˜Ÿåˆ—ã€é˜Ÿåˆ—åç§°ã€äº¤æ¢æœºåç§°ã€äº¤æ¢æœºå’Œé˜Ÿåˆ—ç»‘å®šçš„RoutingKeyã€‘</span></span><br><span class="line">        channel.queueBind(queueName, EXCHANGE_NAME, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯ï¼ŒæŠŠæ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Š...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(queueName, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç»“æœï¼šç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€ç»™ç»‘å®šçš„é˜Ÿåˆ—ï¼Œæ¶ˆè´¹è€…ä»ç»‘å®šçš„é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼Œéƒ½èƒ½è·å–åˆ°ï¼Œ<code>ç±»ä¼¼äºï¼Œå¤šä¸ªäººå…³æ³¨ä¸€ä¸ªå…¬ä¼—å·ï¼Œè¯¥å…¬ä¼—å·å‘å¸ƒæ¶ˆæ¯ï¼Œæ‰€æœ‰è®¢é˜…çš„äººéƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯</code></strong></p><p><img src="https://www.naste.top:9000/images/image-20230526193106406.png" alt="image-20230526193106406"></p><h3 id="Direct"><a href="#Direct" class="headerlink" title="Direct"></a>Direct</h3><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç®€å•çš„æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚æˆ‘ä»¬èƒ½å¤Ÿå‘è®¸å¤šæ¥æ”¶è€…å¹¿æ’­æ—¥å¿—æ¶ˆæ¯ã€‚åœ¨æœ¬èŠ‚æˆ‘ä»¬å°†å‘å…¶ä¸­æ·»åŠ ä¸€äº›ç‰¹åˆ«çš„åŠŸèƒ½â€”â€”è®©æŸä¸ªæ¶ˆè´¹è€…è®¢é˜…å‘å¸ƒçš„éƒ¨åˆ†æ¶ˆæ¯ã€‚ä¾‹å¦‚æˆ‘ä»¬åªæŠŠä¸¥é‡é”™è¯¯æ¶ˆæ¯å®šå‘å­˜å‚¨åˆ°æ—¥å¿—æ–‡ä»¶(ä»¥èŠ‚çœç£ç›˜ç©ºé—´)ï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿåœ¨æ§åˆ¶å°ä¸Šæ‰“å°æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯ã€‚</p><p>æˆ‘ä»¬å†æ¬¡æ¥å›é¡¾ä¸€ä¸‹ä»€ä¹ˆæ˜¯ bindingsï¼Œç»‘å®šæ˜¯äº¤æ¢æœºå’Œé˜Ÿåˆ—ä¹‹é—´çš„æ¡¥æ¢å…³ç³»ã€‚ä¹Ÿå¯ä»¥è¿™ä¹ˆç†è§£ï¼š <strong>é˜Ÿåˆ—åªå¯¹å®ƒç»‘å®šçš„äº¤æ¢æœºçš„æ¶ˆæ¯æ„Ÿå…´è¶£</strong>ã€‚ç»‘å®šç”¨å‚æ•°ï¼šroutingKey æ¥è¡¨ç¤ºä¹Ÿå¯ç§°è¯¥å‚æ•°ä¸º binding keyï¼Œ åˆ›å»ºç»‘å®šæˆ‘ä»¬ç”¨ä»£ç :channel.queueBind(queueName, EXCHANGE_NAME, â€œroutingKeyâ€);</p><p>ç»‘å®šä¹‹åçš„æ„ä¹‰ç”±å…¶äº¤æ¢ç±»å‹å†³å®šã€‚</p><h4 id="Directä»‹ç»"><a href="#Directä»‹ç»" class="headerlink" title="Directä»‹ç»"></a>Directä»‹ç»</h4><p>ä¸Šä¸€èŠ‚ä¸­çš„æˆ‘ä»¬çš„æ—¥å¿—ç³»ç»Ÿå°†æ‰€æœ‰æ¶ˆæ¯å¹¿æ’­ç»™æ‰€æœ‰æ¶ˆè´¹è€…ï¼Œå¯¹æ­¤æˆ‘ä»¬æƒ³åšä¸€äº›æ”¹å˜ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸Œæœ›å°†æ—¥å¿—æ¶ˆæ¯å†™å…¥ç£ç›˜çš„ç¨‹åºä»…æ¥æ”¶ä¸¥é‡é”™è¯¯(errros)ï¼Œè€Œä¸å­˜å‚¨å“ªäº›è­¦å‘Š(warning)æˆ–ä¿¡æ¯(info)æ—¥å¿— æ¶ˆæ¯é¿å…æµªè´¹ç£ç›˜ç©ºé—´ã€‚Fanout è¿™ç§äº¤æ¢ç±»å‹å¹¶ä¸èƒ½ç»™æˆ‘ä»¬å¸¦æ¥å¾ˆå¤§çš„çµæ´»æ€§-å®ƒåªèƒ½è¿›è¡Œæ— æ„è¯†çš„å¹¿æ’­ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ direct è¿™ç§ç±»å‹æ¥è¿›è¡Œæ›¿æ¢ï¼Œè¿™ç§ç±»å‹çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œæ¶ˆæ¯åªå»åˆ°å®ƒç»‘å®šçš„ routingKey é˜Ÿåˆ—ä¸­å»ã€‚</p><p><img src="https://www.naste.top:9000/images/image-20230529095924798.png" alt="image-20230529095924798"></p><p>åœ¨ä¸Šé¢è¿™å¼ å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° X ç»‘å®šäº†ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œç»‘å®šç±»å‹æ˜¯ directã€‚é˜Ÿåˆ—1 ç»‘å®šé”®ä¸º orangeï¼Œ é˜Ÿåˆ—2 ç»‘å®šé”®æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªç»‘å®šé”®ä¸º blackï¼Œå¦ä¸€ä¸ªç»‘å®šé”®ä¸º green.</p><p>åœ¨è¿™ç§ç»‘å®šæƒ…å†µä¸‹ï¼Œç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åˆ° exchange ä¸Šï¼Œç»‘å®šé”®ä¸º orange çš„æ¶ˆæ¯ä¼šè¢«å‘å¸ƒåˆ°é˜Ÿåˆ—1ã€‚ç»‘å®šé”®ä¸º blackæˆ–greençš„æ¶ˆæ¯ä¼šè¢«å‘å¸ƒåˆ°é˜Ÿåˆ—2ï¼Œå…¶ä»–æ¶ˆæ¯ç±»å‹çš„æ¶ˆæ¯å°†è¢«ä¸¢å¼ƒã€‚</p><h4 id="å¤šé‡ç»‘å®š"><a href="#å¤šé‡ç»‘å®š" class="headerlink" title="å¤šé‡ç»‘å®š"></a>å¤šé‡ç»‘å®š</h4><p>å½“ç„¶å¦‚æœ exchange çš„ç»‘å®šç±»å‹æ˜¯directï¼Œ<strong>ä½†æ˜¯å®ƒç»‘å®šçš„å¤šä¸ªé˜Ÿåˆ—çš„ key å¦‚æœéƒ½ç›¸åŒ</strong>ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è™½ç„¶ç»‘å®šç±»å‹æ˜¯ direct <strong>ä½†æ˜¯å®ƒè¡¨ç°çš„å°±å’Œ fanout æœ‰ç‚¹ç±»ä¼¼äº†</strong>ï¼Œå°±è·Ÿå¹¿æ’­å·®ä¸å¤šï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p><p><img src="https://www.naste.top:9000/images/image-20230529100107558.png" alt="image-20230529100107558"></p><h4 id="ç”Ÿäº§è€…-6"><a href="#ç”Ÿäº§è€…-6" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * directç±»å‹äº¤æ¢æœºæµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;direct_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            <span class="comment">// orangeæ˜¯routingKeyï¼Œå¯ä»¥å˜æ¢</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * exchangeï¼ˆäº¤æ¢å™¨ï¼‰ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ¶ˆæ¯å°†è¦å‘é€åˆ°å“ªä¸ªäº¤æ¢å™¨ã€‚</span></span><br><span class="line"><span class="comment">             * routing_keyï¼ˆè·¯ç”±é”®ï¼‰ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ¶ˆæ¯çš„è·¯ç”±é”®ï¼Œç”¨äºé€‰æ‹©ä¸è¯¥è·¯ç”±é”®åŒ¹é…çš„é˜Ÿåˆ—ã€‚</span></span><br><span class="line"><span class="comment">             * propertiesï¼ˆå±æ€§ï¼‰ï¼šä¸€ä¸ªAMQPå±æ€§å¯¹è±¡ï¼Œç”¨äºæºå¸¦ä¸€äº›é¢å¤–çš„å…ƒæ•°æ®ï¼ˆå¦‚æ¶ˆæ¯ç±»å‹ã€ä¼˜å…ˆçº§ç­‰ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">             * bodyï¼ˆæ¶ˆæ¯ä½“ï¼‰ï¼šä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œè¡¨ç¤ºæ¶ˆæ¯çš„å†…å®¹ã€‚</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(EXCHANGE_NAME, <span class="string">&quot;orange&quot;</span>, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…1-1"><a href="#æ¶ˆè´¹è€…1-1" class="headerlink" title="æ¶ˆè´¹è€…1"></a>æ¶ˆè´¹è€…1</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€…1ï¼ŒroutingKeyï¼šorange</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerOne</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;direct_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;person&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜ä¸€ä¸ªäº¤æ¢æœºã€äº¤æ¢æœºåç§°ï¼Œäº¤æ¢æœºç±»å‹ã€‘</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * é˜Ÿåˆ—åç§°ã€‚</span></span><br><span class="line"><span class="comment">         * æŒ‡å®šé˜Ÿåˆ—æ˜¯å¦éœ€è¦æŒä¹…åŒ–ã€‚</span></span><br><span class="line"><span class="comment">         * æŒ‡å®šé˜Ÿåˆ—æ˜¯å¦ä¸ºç‹¬å é˜Ÿåˆ—ã€‚</span></span><br><span class="line"><span class="comment">         * æŒ‡å®šé˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚</span></span><br><span class="line"><span class="comment">         * ç”¨äºè®¾ç½®é˜Ÿåˆ—çš„å…¶ä»–å±æ€§ï¼Œä¾‹å¦‚ TTLã€æœ€å¤§é•¿åº¦ç­‰ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç»‘å®šäº¤æ¢æœºä¸é˜Ÿåˆ—ã€é˜Ÿåˆ—åç§°ã€äº¤æ¢æœºåç§°ã€äº¤æ¢æœºå’Œé˜Ÿåˆ—ç»‘å®šçš„RoutingKeyã€‘</span></span><br><span class="line">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class="string">&quot;orange&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯ï¼ŒæŠŠæ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Š...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;exchangeï¼šdirect_exchange\nqueueï¼šperson\nroutingKeyï¼šorange\næ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(QUEUE_NAME, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…2-1"><a href="#æ¶ˆè´¹è€…2-1" class="headerlink" title="æ¶ˆè´¹è€…2"></a>æ¶ˆè´¹è€…2</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€…2ï¼ŒroutingKeyï¼šblack</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTwo</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;direct_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;user&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜ä¸€ä¸ªäº¤æ¢æœºã€äº¤æ¢æœºåç§°ï¼Œäº¤æ¢æœºç±»å‹ã€‘</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * é˜Ÿåˆ—åç§°ã€‚</span></span><br><span class="line"><span class="comment">         * æŒ‡å®šé˜Ÿåˆ—æ˜¯å¦éœ€è¦æŒä¹…åŒ–ã€‚</span></span><br><span class="line"><span class="comment">         * æŒ‡å®šé˜Ÿåˆ—æ˜¯å¦ä¸ºç‹¬å é˜Ÿåˆ—ã€‚</span></span><br><span class="line"><span class="comment">         * æŒ‡å®šé˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚</span></span><br><span class="line"><span class="comment">         * ç”¨äºè®¾ç½®é˜Ÿåˆ—çš„å…¶ä»–å±æ€§ï¼Œä¾‹å¦‚ TTLã€æœ€å¤§é•¿åº¦ç­‰ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç»‘å®šäº¤æ¢æœºä¸é˜Ÿåˆ—ã€é˜Ÿåˆ—åç§°ã€äº¤æ¢æœºåç§°ã€äº¤æ¢æœºå’Œé˜Ÿåˆ—ç»‘å®šçš„RoutingKeyã€‘</span></span><br><span class="line">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class="string">&quot;black&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯ï¼ŒæŠŠæ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Š...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;exchangeï¼šdirect_exchange\nqueueï¼šuser\nroutingKeyï¼šblack\næ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(QUEUE_NAME, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p><img src="https://www.naste.top:9000/images/image-20230529104022902.png" alt="image-20230529104022902"></p><p><img src="https://www.naste.top:9000/images/image-20230529104243705.png" alt="image-20230529104243705"></p><h3 id="Topics"><a href="#Topics" class="headerlink" title="Topics"></a>Topics</h3><h4 id="Topicçš„ä»‹ç»"><a href="#Topicçš„ä»‹ç»" class="headerlink" title="Topicçš„ä»‹ç»"></a>Topicçš„ä»‹ç»</h4><p>åœ¨ä¸Šä¸€ä¸ªå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ”¹è¿›äº†æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åªèƒ½è¿›è¡Œéšæ„å¹¿æ’­çš„ fanout äº¤æ¢æœºï¼Œè€Œæ˜¯ä½¿ç”¨äº† direct äº¤æ¢æœºï¼Œä»è€Œæœ‰èƒ½å®ç°æœ‰é€‰æ‹©æ€§åœ°æ¥æ”¶æ—¥å¿—ã€‚</p><p>å°½ç®¡ä½¿ç”¨ direct äº¤æ¢æœºæ”¹è¿›äº†æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½†æ˜¯å®ƒä»ç„¶å­˜åœ¨å±€é™æ€§â€”â€”æ¯”æ–¹è¯´æˆ‘ä»¬æƒ³æ¥æ”¶çš„æ—¥å¿—ç±»å‹æœ‰ info.base å’Œ info.advantageï¼ŒæŸä¸ªé˜Ÿåˆ—åªæƒ³ info.base çš„æ¶ˆæ¯ï¼Œé‚£è¿™ä¸ªæ—¶å€™direct å°±åŠä¸åˆ°äº†ã€‚è¿™ä¸ªæ—¶å€™å°±åªèƒ½ä½¿ç”¨ <strong>topic</strong> ç±»å‹</p><p><strong>Topic çš„è¦æ±‚</strong></p><p>å‘é€åˆ°ç±»å‹æ˜¯ topic äº¤æ¢æœºçš„æ¶ˆæ¯çš„ routing_key ä¸èƒ½éšæ„å†™ï¼Œå¿…é¡»æ»¡è¶³ä¸€å®šçš„è¦æ±‚ï¼Œå®ƒå¿…é¡»æ˜¯<strong>ä¸€ä¸ªå•è¯åˆ—è¡¨</strong>ï¼Œ<strong>ä»¥ç‚¹å·åˆ†éš”å¼€</strong>ã€‚è¿™äº›å•è¯å¯ä»¥æ˜¯ä»»æ„å•è¯</p><p>æ¯”å¦‚è¯´ï¼šâ€stock.usd.nyseâ€, â€œnyse.vmwâ€, â€œquick.orange.rabbitâ€ è¿™ç§ç±»å‹çš„ã€‚</p><p>å½“ç„¶è¿™ä¸ªå•è¯åˆ—è¡¨æœ€å¤šä¸èƒ½è¶…è¿‡ 255 ä¸ªå­—èŠ‚ã€‚</p><p>åœ¨è¿™ä¸ªè§„åˆ™åˆ—è¡¨ä¸­ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ›¿æ¢ç¬¦æ˜¯å¤§å®¶éœ€è¦æ³¨æ„çš„ï¼š</p><ul><li><strong>*(æ˜Ÿå·)å¯ä»¥ä»£æ›¿ä¸€ä¸ªä½ç½®</strong></li><li><strong>#(äº•å·)å¯ä»¥æ›¿ä»£é›¶ä¸ªæˆ–å¤šä¸ªä½ç½®</strong></li></ul><h4 id="TopicåŒ¹é…æ¡ˆä¾‹"><a href="#TopicåŒ¹é…æ¡ˆä¾‹" class="headerlink" title="TopicåŒ¹é…æ¡ˆä¾‹"></a>TopicåŒ¹é…æ¡ˆä¾‹</h4><p><img src="https://www.naste.top:9000/images/image-20230529105705819.png" alt="image-20230529105705819"></p><ul><li>Q1â€”&gt;ç»‘å®šçš„æ˜¯<ul><li>ä¸­é—´å¸¦ orange å¸¦ 3 ä¸ªå•è¯çš„å­—ç¬¦ä¸² <code>(*.orange.*)</code></li></ul></li><li>Q2â€”&gt;ç»‘å®šçš„æ˜¯<ul><li>æœ€åä¸€ä¸ªå•è¯æ˜¯ rabbit çš„ 3 ä¸ªå•è¯ <code>(*.*.rabbit)</code></li><li>ç¬¬ä¸€ä¸ªå•è¯æ˜¯ lazy çš„å¤šä¸ªå•è¯ <code>(lazy.#)</code></li></ul></li></ul><p>ä¸Šå›¾æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šå…³ç³»å›¾ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»–ä»¬ä¹‹é—´æ•°æ®æ¥æ”¶æƒ…å†µæ˜¯æ€ä¹ˆæ ·çš„</p><div class="table-container"><table><thead><tr><th>ä¾‹å­</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>quick.orange.rabbit</td><td>è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°</td></tr><tr><td>azy.orange.elephant</td><td>è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°</td></tr><tr><td>quick.orange.fox</td><td>è¢«é˜Ÿåˆ— Q1 æ¥æ”¶åˆ°</td></tr><tr><td>lazy.brown.fox</td><td>è¢«é˜Ÿåˆ— Q2 æ¥æ”¶åˆ°</td></tr><tr><td>lazy.pink.rabbit</td><td>è™½ç„¶æ»¡è¶³ä¸¤ä¸ªç»‘å®šä½†åªè¢«é˜Ÿåˆ— Q2 æ¥æ”¶ä¸€æ¬¡</td></tr><tr><td>quick.brown.fox</td><td>ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¸ä¼šè¢«ä»»ä½•é˜Ÿåˆ—æ¥æ”¶åˆ°ä¼šè¢«ä¸¢å¼ƒ</td></tr><tr><td>quick.orange.male.rabbit</td><td>æ˜¯å››ä¸ªå•è¯ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¼šè¢«ä¸¢å¼ƒ</td></tr><tr><td>lazy.orange.male.rabbit</td><td>æ˜¯å››ä¸ªå•è¯ä½†åŒ¹é… Q2</td></tr></tbody></table></div><blockquote><p><strong>å½“ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šé”®æ˜¯ #ï¼Œé‚£ä¹ˆè¿™ä¸ªé˜Ÿåˆ—å°†æ¥æ”¶æ‰€æœ‰æ•°æ®ï¼Œå°±æœ‰ç‚¹åƒ fanout äº†</strong></p><p><strong>å¦‚æœé˜Ÿåˆ—ç»‘å®šé”®å½“ä¸­æ²¡æœ‰ # å’Œ * å‡ºç°ï¼Œé‚£ä¹ˆè¯¥é˜Ÿåˆ—ç»‘å®šç±»å‹å°±æ˜¯ direct äº†</strong></p></blockquote><h4 id="ç”Ÿäº§è€…-7"><a href="#ç”Ÿäº§è€…-7" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * topicsç±»å‹äº¤æ¢æœºæµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerOne</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;topic_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * Q1--&gt;ç»‘å®šçš„æ˜¯</span></span><br><span class="line"><span class="comment">         *      ä¸­é—´å¸¦ orange å¸¦ 3 ä¸ªå•è¯çš„å­—ç¬¦ä¸²(*.orange.*)</span></span><br><span class="line"><span class="comment">         * Q2--&gt;ç»‘å®šçš„æ˜¯</span></span><br><span class="line"><span class="comment">         *      æœ€åä¸€ä¸ªå•è¯æ˜¯ rabbit çš„ 3 ä¸ªå•è¯(*.*.rabbit)</span></span><br><span class="line"><span class="comment">         *      ç¬¬ä¸€ä¸ªå•è¯æ˜¯ lazy çš„å¤šä¸ªå•è¯(lazy.#)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        HashMap&lt;String, String&gt; bindingKeyMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.orange.rabbit&quot;</span>, <span class="string">&quot;è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.orange.elephant&quot;</span>, <span class="string">&quot;è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.orange.fox&quot;</span>, <span class="string">&quot;è¢«é˜Ÿåˆ— Q1 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.brown.fox&quot;</span>, <span class="string">&quot;è¢«é˜Ÿåˆ— Q2 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.pink.rabbit&quot;</span>, <span class="string">&quot;è™½ç„¶æ»¡è¶³ä¸¤ä¸ªç»‘å®šä½†åªè¢«é˜Ÿåˆ— Q2 æ¥æ”¶ä¸€æ¬¡&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.brown.fox&quot;</span>, <span class="string">&quot;ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¸ä¼šè¢«ä»»ä½•é˜Ÿåˆ—æ¥æ”¶åˆ°ä¼šè¢«ä¸¢å¼ƒ&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.orange.male.rabbit&quot;</span>, <span class="string">&quot;æ˜¯å››ä¸ªå•è¯ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¼šè¢«ä¸¢å¼ƒ&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.orange.male.rabbit&quot;</span>, <span class="string">&quot;æ˜¯å››ä¸ªå•è¯ä½†åŒ¹é… Q2&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; bindingKeyEntry : bindingKeyMap.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">routingKey</span> <span class="operator">=</span> bindingKeyEntry.getKey();</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> bindingKeyEntry.getValue();</span><br><span class="line"></span><br><span class="line">            channel.basicPublish(EXCHANGE_NAME, routingKey, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…1-2"><a href="#æ¶ˆè´¹è€…1-2" class="headerlink" title="æ¶ˆè´¹è€…1"></a>æ¶ˆè´¹è€…1</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * topicsç±»å‹äº¤æ¢æœºæ¶ˆæ¯æ¥æ”¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerOne</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;topic_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">//å£°æ˜äº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.TOPIC);</span><br><span class="line">        <span class="comment">//å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> <span class="string">&quot;Q1&quot;</span>;</span><br><span class="line">        channel.queueDeclare(queueName,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(queueName,EXCHANGE_NAME,<span class="string">&quot;*.orange.*&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag,message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(),<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶é˜Ÿåˆ—ï¼š&quot;</span>+queueName+<span class="string">&quot;  ç»‘å®šé”®:&quot;</span>+message.getEnvelope().getRoutingKey());</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(queueName,<span class="literal">true</span>,deliverCallback,consumerTag -&gt;&#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…2-2"><a href="#æ¶ˆè´¹è€…2-2" class="headerlink" title="æ¶ˆè´¹è€…2"></a>æ¶ˆè´¹è€…2</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.DeliverCallback;</span><br><span class="line"><span class="keyword">import</span> com.xiaofei.rabbitmq.utils.ChannelUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * topicsç±»å‹äº¤æ¢æœºæ¶ˆæ¯æ¥æ”¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTwo</span> &#123;</span><br><span class="line">    <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;topic_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line">        <span class="comment">//å£°æ˜äº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.TOPIC);</span><br><span class="line">        <span class="comment">//å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> <span class="string">&quot;Q2&quot;</span>;</span><br><span class="line">        channel.queueDeclare(queueName,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(queueName,EXCHANGE_NAME,<span class="string">&quot;*.*.rabbit&quot;</span>);</span><br><span class="line">        channel.queueBind(queueName,EXCHANGE_NAME,<span class="string">&quot;lazy.#&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag,message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(),<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶é˜Ÿåˆ—ï¼š&quot;</span>+queueName+<span class="string">&quot;  ç»‘å®šé”®:&quot;</span>+message.getEnvelope().getRoutingKey());</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(queueName,<span class="literal">true</span>,deliverCallback,consumerTag -&gt;&#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»“æœ-1"><a href="#ç»“æœ-1" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p><img src="https://www.naste.top:9000/images/image-20230529110312371.png" alt="image-20230529110312371"></p><h1 id="æ­»ä¿¡é˜Ÿåˆ—"><a href="#æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—"></a>æ­»ä¿¡é˜Ÿåˆ—</h1><h2 id="æ­»ä¿¡æ¦‚å¿µ"><a href="#æ­»ä¿¡æ¦‚å¿µ" class="headerlink" title="æ­»ä¿¡æ¦‚å¿µ"></a>æ­»ä¿¡æ¦‚å¿µ</h2><p>å…ˆä»æ¦‚å¿µè§£é‡Šä¸Šææ¸…æ¥šè¿™ä¸ªå®šä¹‰ï¼Œæ­»ä¿¡ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ— æ³•è¢«æ¶ˆè´¹çš„æ¶ˆæ¯ï¼Œå­—é¢æ„æ€å¯ä»¥è¿™æ ·ç†è§£ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œproducer å°†æ¶ˆæ¯æŠ•é€’åˆ° broker æˆ–è€…ç›´æ¥åˆ°queue é‡Œäº†ï¼Œconsumer ä» queue å–å‡ºæ¶ˆæ¯ è¿›è¡Œæ¶ˆè´¹ï¼Œä½†æŸäº›æ—¶å€™ç”±äºç‰¹å®šçš„åŸå› <strong>å¯¼è‡´ queue ä¸­çš„æŸäº›æ¶ˆæ¯æ— æ³•è¢«æ¶ˆè´¹</strong>ï¼Œè¿™æ ·çš„æ¶ˆæ¯å¦‚æœæ²¡æœ‰åç»­çš„å¤„ç†ï¼Œå°±å˜æˆäº†æ­»ä¿¡ï¼Œæœ‰æ­»ä¿¡è‡ªç„¶å°±æœ‰äº†æ­»ä¿¡é˜Ÿåˆ—ã€‚</p><p>åº”ç”¨åœºæ™¯ï¼šä¸ºäº†ä¿è¯è®¢å•ä¸šåŠ¡çš„æ¶ˆæ¯æ•°æ®ä¸ä¸¢å¤±ï¼Œéœ€è¦ä½¿ç”¨åˆ° RabbitMQ çš„æ­»ä¿¡é˜Ÿåˆ—æœºåˆ¶ï¼Œå½“æ¶ˆæ¯æ¶ˆè´¹å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå°†æ¶ˆæ¯æŠ•å…¥æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚è¿˜æœ‰æ¯”å¦‚è¯´ï¼šç”¨æˆ·åœ¨å•†åŸä¸‹å•æˆåŠŸå¹¶ç‚¹å‡»å»æ”¯ä»˜ååœ¨æŒ‡å®šæ—¶é—´æœªæ”¯ä»˜æ—¶è‡ªåŠ¨å¤±æ•ˆã€‚</p><h2 id="æ­»ä¿¡çš„æ¥æº"><a href="#æ­»ä¿¡çš„æ¥æº" class="headerlink" title="æ­»ä¿¡çš„æ¥æº"></a>æ­»ä¿¡çš„æ¥æº</h2><ul><li><p>æ¶ˆæ¯ TTL è¿‡æœŸ</p><p>  TTLæ˜¯ Time To Live çš„ç¼©å†™, ä¹Ÿå°±æ˜¯ç”Ÿå­˜æ—¶é—´</p></li><li><p>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦</p><p>  é˜Ÿåˆ—æ»¡äº†ï¼Œæ— æ³•å†æ·»åŠ æ•°æ®åˆ° MQ ä¸­</p></li><li><p>æ¶ˆæ¯è¢«æ‹’ç»</p><p>  (basic.reject æˆ– basic.nack) å¹¶ä¸” requeue = false</p></li></ul><h2 id="æ­»ä¿¡å®æˆ˜"><a href="#æ­»ä¿¡å®æˆ˜" class="headerlink" title="æ­»ä¿¡å®æˆ˜"></a>æ­»ä¿¡å®æˆ˜</h2><p>äº¤æ¢æœºç±»å‹æ˜¯ directï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸¤ä¸ªé˜Ÿåˆ—ï¼šæ¶ˆæ¯é˜Ÿåˆ—å’Œæ­»ä¿¡é˜Ÿåˆ—</p><p><img src="https://www.naste.top:9000/images/image.691xh9mh3yk0.webp" alt="image"></p><h3 id="æ¶ˆæ¯TTLè¿‡æœŸ"><a href="#æ¶ˆæ¯TTLè¿‡æœŸ" class="headerlink" title="æ¶ˆæ¯TTLè¿‡æœŸ"></a>æ¶ˆæ¯TTLè¿‡æœŸ</h3><p><strong>ç”Ÿäº§è€…</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> frx</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/7/25  19:13</span></span><br><span class="line"><span class="comment"> * desc:æ­»ä¿¡é˜Ÿåˆ—ä¹‹ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;</span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ­»ä¿¡æ¶ˆæ¯ è®¾ç½®ttlæ—¶é—´ live to time å•ä½æ˜¯ms</span></span><br><span class="line">        AMQP.<span class="type">BasicProperties</span> <span class="variable">properties</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">AMQP</span>.BasicProperties().builder().expiration(<span class="string">&quot;10000&quot;</span>).build();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;<span class="number">11</span> ; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;info&quot;</span>+i;</span><br><span class="line">            channel.basicPublish(NORMAL_EXCHANGE,<span class="string">&quot;zhangsan&quot;</span>,properties,message.getBytes());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ¶ˆè´¹è€… C1 ä»£ç </strong>(å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> frx</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/7/25  17:00</span></span><br><span class="line"><span class="comment"> * desc:æœ¬æ¬¡æ˜¯ä¸ºäº†æ­»ä¿¡é˜Ÿåˆ—å®æˆ˜</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€…1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;normal_queue&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;dead_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœºï¼Œç±»å‹ä¸ºdirect</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜æ™®é€šé˜Ÿåˆ—</span></span><br><span class="line">        Map&lt;String,Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//è¿‡æœŸæ—¶é—´ 10s ç”±ç”Ÿäº§è€…æŒ‡å®š æ›´åŠ çµæ´»</span></span><br><span class="line">        <span class="comment">//arguments.put(&quot;x-message-ttl&quot;,10000);</span></span><br><span class="line">        <span class="comment">//æ­£å¸¸çš„é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>,DEAD_EXCHANGE);<span class="comment">//å›¾ä¸­çº¢ç®­å¤´</span></span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡routingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line"></span><br><span class="line">        channel.queueDeclare(NORMAL_QUEUE,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,arguments);</span><br><span class="line">        <span class="comment">/////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(DEAD_QUEUE,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»‘å®šæ™®é€šçš„äº¤æ¢æœºä¸é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(NORMAL_QUEUE,NORMAL_EXCHANGE,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»‘å®šæ­»ä¿¡çš„äº¤æ¢æœºä¸æ­»ä¿¡çš„é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(DEAD_QUEUE,DEAD_EXCHANGE,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag,message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer01æ¥å—çš„æ¶ˆæ¯æ˜¯ï¼š&quot;</span>+<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(),<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        channel.basicConsume(NORMAL_QUEUE,<span class="literal">true</span>,deliverCallback,consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆå¯åŠ¨æ¶ˆè´¹è€… C1ï¼Œåˆ›å»ºå‡ºé˜Ÿåˆ—ï¼Œç„¶ååœæ­¢è¯¥ C1 çš„è¿è¡Œï¼Œåˆ™ C1 å°†æ— æ³•æ”¶åˆ°é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œæ— æ³•æ”¶åˆ°çš„æ¶ˆæ¯ 10 ç§’åè¿›å…¥æ­»ä¿¡é˜Ÿåˆ—ã€‚å¯åŠ¨ç”Ÿäº§è€… producer ç”Ÿäº§æ¶ˆæ¯</p><p><strong>ç”Ÿäº§è€…æœªå‘é€æ¶ˆæ¯</strong></p><p><img src="https://www.naste.top:9000/images/image.5ldx5kffws00.webp" alt="image"></p><p><strong>ç”Ÿäº§è€…å‘é€äº†10æ¡æ¶ˆæ¯ï¼Œæ­¤æ—¶æ­£å¸¸æ¶ˆæ¯é˜Ÿåˆ—æœ‰10æ¡æœªæ¶ˆè´¹æ¶ˆæ¯</strong></p><p><img src="https://www.naste.top:9000/images/image.4k5fjvtukpe0.webp" alt="image"></p><p><strong>æ—¶é—´è¿‡å»10ç§’ï¼Œæ­£å¸¸é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯ç”±äºæ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œæ¶ˆæ¯è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—</strong></p><p><img src="https://www.naste.top:9000/images/image.5g2svti1sec0.webp" alt="image"></p><p><strong>æ¶ˆè´¹è€… C2 ä»£ç </strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> frx</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/7/25  19:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;dead_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ­»ä¿¡æ¶ˆæ¯...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer02æ¥å—çš„æ¶ˆæ¯æ˜¯ï¼š&quot;</span>+<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(),<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        channel.basicConsume(DEAD_QUEUE,<span class="literal">true</span>,deliverCallback,consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ•ˆæœæ¼”ç¤º</strong></p><p><img src="https://www.naste.top:9000/images/image.3a1tkaqx5jm0.webp" alt="image"></p><ul><li>æ§åˆ¶å°</li></ul><p><img src="https://www.naste.top:9000/images/image.2qvoqd9bcdc0.webp" alt="image"></p><h3 id="æ­»ä¿¡æœ€å¤§é•¿åº¦"><a href="#æ­»ä¿¡æœ€å¤§é•¿åº¦" class="headerlink" title="æ­»ä¿¡æœ€å¤§é•¿åº¦"></a>æ­»ä¿¡æœ€å¤§é•¿åº¦</h3><ol><li>æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç å»æ‰ TTL å±æ€§ï¼Œ<code>basicPublish</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ”¹ä¸º null</li></ol><figure class="highlight java"><figcaption><span>&#123;9,10,13&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;</span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ­»ä¿¡æ¶ˆæ¯ è®¾ç½®ttlæ—¶é—´ live to time å•ä½æ˜¯ms</span></span><br><span class="line">        <span class="comment">//AMQP.BasicProperties properties =</span></span><br><span class="line">        <span class="comment">//        new AMQP.BasicProperties().builder().expiration(&quot;10000&quot;).build();</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;<span class="number">11</span> ; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;info&quot;</span>+i;</span><br><span class="line">            channel.basicPublish(NORMAL_EXCHANGE,<span class="string">&quot;zhangsan&quot;</span>,<span class="literal">null</span>,message.getBytes());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>C1 æ¶ˆè´¹è€…ä¿®æ”¹ä»¥ä¸‹ä»£ç (<strong>å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯</strong>)</li></ol><figure class="highlight java"><figcaption><span>&#123;30&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;normal_queue&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;dead_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœºï¼Œç±»å‹ä¸ºdirect</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜æ™®é€šé˜Ÿåˆ—</span></span><br><span class="line">        Map&lt;String,Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//è¿‡æœŸæ—¶é—´ 10s ç”±ç”Ÿäº§è€…æŒ‡å®š æ›´åŠ çµæ´»</span></span><br><span class="line">        <span class="comment">//arguments.put(&quot;x-message-ttl&quot;,10000);</span></span><br><span class="line">        <span class="comment">//æ­£å¸¸çš„é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>,DEAD_EXCHANGE);<span class="comment">//å›¾ä¸­çº¢ç®­å¤´</span></span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡routingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­£å¸¸é˜Ÿåˆ—é•¿åº¦çš„é™åˆ¶ï¼Œä¾‹å¦‚å‘é€10ä¸ªæ¶ˆæ¯ï¼Œ6ä¸ªä¸ºæ­£å¸¸ï¼Œ4ä¸ªä¸ºæ­»ä¿¡</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-max-length&quot;</span>,<span class="number">6</span>);</span><br><span class="line">        </span><br><span class="line">        channel.queueDeclare(NORMAL_QUEUE,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,arguments);</span><br><span class="line">        <span class="comment">/////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(DEAD_QUEUE,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»‘å®šæ™®é€šçš„äº¤æ¢æœºä¸é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(NORMAL_QUEUE,NORMAL_EXCHANGE,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»‘å®šæ­»ä¿¡çš„äº¤æ¢æœºä¸æ­»ä¿¡çš„é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(DEAD_QUEUE,DEAD_EXCHANGE,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag,message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer01æ¥å—çš„æ¶ˆæ¯æ˜¯ï¼š&quot;</span>+<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(),<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        channel.basicConsume(NORMAL_QUEUE,<span class="literal">true</span>,deliverCallback,consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>::: tip æ³¨æ„</p><p>å› ä¸ºå‚æ•°æ”¹å˜äº†ï¼Œæ‰€ä»¥éœ€è¦æŠŠåŸå…ˆé˜Ÿåˆ—åˆ é™¤</p><p>:::</p><ol><li>C2 æ¶ˆè´¹è€…ä»£ç ä¸å˜</li></ol><ul><li>å¯åŠ¨æ¶ˆè´¹è€…C1ï¼Œåˆ›å»ºå‡ºé˜Ÿåˆ—ï¼Œç„¶ååœæ­¢è¯¥ C1 çš„è¿è¡Œï¼Œå¯åŠ¨ç”Ÿäº§è€…</li></ul><p><img src="https://www.naste.top:9000/images/image.6nv41w7ky0o0.webp" alt="image"></p><ul><li>å¯åŠ¨ C2 æ¶ˆè´¹è€…</li></ul><p><img src="https://www.naste.top:9000/images/image.3mg5ph9jr020.webp" alt="image"></p><ul><li>æ§åˆ¶å°</li></ul><p><img src="https://www.naste.top:9000/images/image.664h3njwl6w0.webp" alt="image"></p><h3 id="æ­»ä¿¡æ¶ˆæ¯è¢«æ‹’"><a href="#æ­»ä¿¡æ¶ˆæ¯è¢«æ‹’" class="headerlink" title="æ­»ä¿¡æ¶ˆæ¯è¢«æ‹’"></a>æ­»ä¿¡æ¶ˆæ¯è¢«æ‹’</h3><ol><li>æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç åŒä¸Šç”Ÿäº§è€…ä¸€è‡´</li><li>éœ€æ±‚ï¼šæ¶ˆè´¹è€… C1 æ‹’æ”¶æ¶ˆæ¯ â€œinfo5â€ï¼Œå¼€å¯æ‰‹åŠ¨åº”ç­”</li></ol><p><strong>æ¶ˆè´¹è€…C1</strong></p><figure class="highlight java"><figcaption><span>&#123;30,46-53,57&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;normal_queue&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;dead_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> ChannelUtils.getChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœºï¼Œç±»å‹ä¸ºdirect</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å£°æ˜æ™®é€šé˜Ÿåˆ—</span></span><br><span class="line">        Map&lt;String,Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//è¿‡æœŸæ—¶é—´ 10s ç”±ç”Ÿäº§è€…æŒ‡å®š æ›´åŠ çµæ´»</span></span><br><span class="line">        <span class="comment">//arguments.put(&quot;x-message-ttl&quot;,10000);</span></span><br><span class="line">        <span class="comment">//æ­£å¸¸çš„é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>,DEAD_EXCHANGE);<span class="comment">//å›¾ä¸­çº¢ç®­å¤´</span></span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡routingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­£å¸¸é˜Ÿåˆ—é•¿åº¦çš„é™åˆ¶ï¼Œä¾‹å¦‚å‘é€10ä¸ªæ¶ˆæ¯ï¼Œ6ä¸ªä¸ºæ­£å¸¸ï¼Œ4ä¸ªä¸ºæ­»ä¿¡</span></span><br><span class="line">        <span class="comment">//arguments.put(&quot;x-max-length&quot;,6);</span></span><br><span class="line"></span><br><span class="line">        channel.queueDeclare(NORMAL_QUEUE,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,arguments);</span><br><span class="line">        <span class="comment">/////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(DEAD_QUEUE,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»‘å®šæ™®é€šçš„äº¤æ¢æœºä¸é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(NORMAL_QUEUE,NORMAL_EXCHANGE,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»‘å®šæ­»ä¿¡çš„äº¤æ¢æœºä¸æ­»ä¿¡çš„é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(DEAD_QUEUE,DEAD_EXCHANGE,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag,message) -&gt;&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(msg.equals(<span class="string">&quot;info5&quot;</span>))&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Consumer01æ¥å—çš„æ¶ˆæ¯æ˜¯ï¼š&quot;</span>+msg+<span class="string">&quot;ï¼š æ­¤æ¶ˆæ¯æ˜¯è¢«C1æ‹’ç»çš„&quot;</span>);</span><br><span class="line">                <span class="comment">//requeue è®¾ç½®ä¸º false ä»£è¡¨æ‹’ç»é‡æ–°å…¥é˜Ÿ è¯¥é˜Ÿåˆ—å¦‚æœé…ç½®äº†æ­»ä¿¡äº¤æ¢æœºå°†å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­</span></span><br><span class="line">                channel.basicReject(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Consumer01æ¥å—çš„æ¶ˆæ¯æ˜¯ï¼š&quot;</span>+msg);</span><br><span class="line">                channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//å¼€å¯æ‰‹åŠ¨åº”ç­”ï¼Œä¹Ÿå°±æ˜¯å…³é—­æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">        channel.basicConsume(NORMAL_QUEUE,<span class="literal">false</span>,deliverCallback,consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¼€å¯æ¶ˆè´¹è€…C1ï¼Œåˆ›å»ºå‡ºé˜Ÿåˆ—ï¼Œç„¶ååœæ­¢è¯¥ C1 çš„è¿è¡Œï¼Œå¯åŠ¨ç”Ÿäº§è€…</li></ul><p><img src="https://www.naste.top:9000/images/image.ncokzmns2t.webp" alt="image"></p><ul><li>å¯åŠ¨æ¶ˆè´¹è€… C1 ç­‰å¾… 10 ç§’ä¹‹åï¼Œå†å¯åŠ¨æ¶ˆè´¹è€… C2</li></ul><p><img src="https://www.naste.top:9000/images/image.1xxchsmgsgdc.webp" alt="image"></p><ul><li>C1æ§åˆ¶å°</li></ul><p><img src="https://www.naste.top:9000/images/image.5zgbkg8gij80.webp" alt="image"></p><ul><li>C2æ§åˆ¶å°</li></ul><p><img src="https://www.naste.top:9000/images/image.783con5n7f40.webp" alt="image"></p><h1 id="å»¶è¿Ÿé˜Ÿåˆ—"><a href="#å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—"></a>å»¶è¿Ÿé˜Ÿåˆ—</h1><h2 id="å»¶è¿Ÿé˜Ÿåˆ—ä»‹ç»"><a href="#å»¶è¿Ÿé˜Ÿåˆ—ä»‹ç»" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—ä»‹ç»"></a>å»¶è¿Ÿé˜Ÿåˆ—ä»‹ç»</h2><p>å»¶æ—¶é˜Ÿåˆ—,é˜Ÿåˆ—å†…éƒ¨æ˜¯æœ‰åºçš„ï¼Œæœ€é‡è¦çš„ç‰¹æ€§å°±ä½“ç°åœ¨å®ƒçš„å»¶æ—¶å±æ€§ä¸Šï¼Œå»¶æ—¶é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯å¸Œæœ› åœ¨æŒ‡å®šæ—¶é—´åˆ°äº†ä»¥åæˆ–ä¹‹å‰å–å‡ºå’Œå¤„ç†ï¼Œç®€å•æ¥è¯´ï¼Œå»¶æ—¶é˜Ÿåˆ—å°±æ˜¯ç”¨æ¥å­˜æ”¾éœ€è¦åœ¨æŒ‡å®šæ—¶é—´è¢«å¤„ç†çš„ å…ƒç´ çš„é˜Ÿåˆ—ã€‚</p><ol><li>è®¢å•åœ¨ååˆ†é’Ÿä¹‹å†…æœªæ”¯ä»˜åˆ™è‡ªåŠ¨å–æ¶ˆ</li><li>æ–°åˆ›å»ºçš„åº—é“ºï¼Œå¦‚æœåœ¨åå¤©å†…éƒ½æ²¡æœ‰ä¸Šä¼ è¿‡å•†å“ï¼Œåˆ™è‡ªåŠ¨å‘é€æ¶ˆæ¯æé†’</li><li>ç”¨æˆ·æ³¨å†ŒæˆåŠŸåï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰ç™»é™†åˆ™è¿›è¡ŒçŸ­ä¿¡æé†’</li><li>ç”¨æˆ·å‘èµ·é€€æ¬¾ï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰å¾—åˆ°å¤„ç†åˆ™é€šçŸ¥ç›¸å…³è¿è¥äººå‘˜</li><li>é¢„å®šä¼šè®®åï¼Œéœ€è¦åœ¨é¢„å®šçš„æ—¶é—´ç‚¹å‰ååˆ†é’Ÿé€šçŸ¥å„ä¸ªä¸ä¼šäººå‘˜å‚åŠ ä¼šè®®</li></ol><p>è¿™äº›åœºæ™¯éƒ½æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œéœ€è¦åœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿä¹‹åæˆ–è€…ä¹‹å‰çš„æŒ‡å®šæ—¶é—´ç‚¹å®ŒæˆæŸä¸€é¡¹ä»»åŠ¡ï¼Œå¦‚ï¼š å‘ç”Ÿè®¢å•ç”Ÿæˆäº‹ä»¶ï¼Œåœ¨ååˆ†é’Ÿä¹‹åæ£€æŸ¥è¯¥è®¢å•æ”¯ä»˜çŠ¶æ€ï¼Œç„¶åå°†æœªæ”¯ä»˜çš„è®¢å•è¿›è¡Œå…³é—­ï¼›é‚£æˆ‘ä»¬ä¸€ç›´è½®è¯¢æ•°æ®ï¼Œæ¯ç§’æŸ¥ä¸€æ¬¡ï¼Œå–å‡ºéœ€è¦è¢«å¤„ç†çš„æ•°æ®ï¼Œç„¶åå¤„ç†ä¸å°±å®Œäº‹äº†å—ï¼Ÿ</p><p>å¦‚æœæ•°æ®é‡æ¯”è¾ƒå°‘ï¼Œç¡®å®å¯ä»¥è¿™æ ·åšï¼Œæ¯”å¦‚ï¼šå¯¹äºã€Œå¦‚æœè´¦å•ä¸€å‘¨å†…æœªæ”¯ä»˜åˆ™è¿›è¡Œè‡ªåŠ¨ç»“ç®—ã€è¿™æ ·çš„éœ€æ±‚ï¼Œ å¦‚æœå¯¹äºæ—¶é—´ä¸æ˜¯ä¸¥æ ¼é™åˆ¶ï¼Œè€Œæ˜¯å®½æ¾æ„ä¹‰ä¸Šçš„ä¸€å‘¨ï¼Œé‚£ä¹ˆæ¯å¤©æ™šä¸Šè·‘ä¸ªå®šæ—¶ä»»åŠ¡æ£€æŸ¥ä¸€ä¸‹æ‰€æœ‰æœªæ”¯ä»˜çš„è´¦å•ï¼Œç¡®å®ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚ä½†å¯¹äºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå¹¶ä¸”æ—¶æ•ˆæ€§è¾ƒå¼ºçš„åœºæ™¯ï¼Œå¦‚ï¼šã€Œè®¢å•ååˆ†é’Ÿå†…æœªæ”¯ä»˜åˆ™å…³é—­ã€ï¼ŒçŸ­æœŸå†…æœªæ”¯ä»˜çš„è®¢å•æ•°æ®å¯èƒ½ä¼šæœ‰å¾ˆå¤šï¼Œæ´»åŠ¨æœŸé—´ç”šè‡³ä¼šè¾¾åˆ°ç™¾ä¸‡ç”šè‡³åƒä¸‡çº§åˆ«ï¼Œå¯¹è¿™ä¹ˆåºå¤§çš„æ•°æ®é‡ä»æ—§ä½¿ç”¨è½®è¯¢çš„æ–¹å¼æ˜¾ç„¶æ˜¯ä¸å¯å–çš„ï¼Œå¾ˆå¯èƒ½åœ¨ä¸€ç§’å†…æ— æ³•å®Œæˆæ‰€æœ‰è®¢å•çš„æ£€æŸ¥ï¼ŒåŒæ—¶ä¼šç»™æ•°æ®åº“å¸¦æ¥å¾ˆå¤§å‹åŠ›ï¼Œæ— æ³•æ»¡è¶³ä¸šåŠ¡è¦æ±‚è€Œä¸”æ€§èƒ½ä½ä¸‹ã€‚</p><p><img src="https://www.naste.top:9000/images/image-20230530185309579.png" alt="image-20230530185309579"></p><h2 id="TTLçš„ä¸¤ç§è®¾ç½®"><a href="#TTLçš„ä¸¤ç§è®¾ç½®" class="headerlink" title="TTLçš„ä¸¤ç§è®¾ç½®"></a>TTLçš„ä¸¤ç§è®¾ç½®</h2><p>TTL æ˜¯ä»€ä¹ˆå‘¢ï¼ŸTTL æ˜¯ RabbitMQ ä¸­ä¸€ä¸ªæ¶ˆæ¯æˆ–è€…é˜Ÿåˆ—çš„å±æ€§ï¼Œè¡¨æ˜ä¸€æ¡æ¶ˆæ¯æˆ–è€…è¯¥é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ¶ˆæ¯çš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€æ¡æ¶ˆæ¯è®¾ç½®äº† TTL å±æ€§æˆ–è€…è¿›å…¥äº†è®¾ç½® TTL å±æ€§çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¿™æ¡æ¶ˆæ¯å¦‚æœåœ¨ TTL è®¾ç½®çš„æ—¶é—´å†…æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œåˆ™ä¼šæˆä¸ºã€Œæ­»ä¿¡ã€ã€‚å¦‚æœåŒæ—¶é…ç½®äº†é˜Ÿåˆ—çš„ TTL å’Œæ¶ˆæ¯çš„ TTLï¼Œé‚£ä¹ˆè¾ƒå°çš„é‚£ä¸ªå€¼å°†ä¼šè¢«ä½¿ç”¨ï¼Œæœ‰ä¸¤ç§æ–¹å¼è®¾ç½® TTLã€‚</p><p><strong>é˜Ÿåˆ—è®¾ç½® TTL</strong></p><p>åœ¨åˆ›å»ºé˜Ÿåˆ—çš„æ—¶å€™è®¾ç½®é˜Ÿåˆ—çš„ x-message-ttl å±æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">params.put(<span class="string">&quot;x-message-ttl&quot;</span>,<span class="number">5000</span>);</span><br><span class="line"><span class="keyword">return</span> QueueBuilder.durable(<span class="string">&quot;QA&quot;</span>).withArguments(args).build(); <span class="comment">// QA é˜Ÿåˆ—çš„æœ€å¤§å­˜æ´»æ—¶é—´ä½ 5000 æ¯«ç§’</span></span><br></pre></td></tr></table></figure><p><strong>æ¶ˆæ¯è®¾ç½® TTL</strong></p><p>é’ˆå¯¹æ¯æ¡æ¶ˆæ¯è®¾ç½® TTL</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rabbitTemplate.converAndSend(<span class="string">&quot;X&quot;</span>,<span class="string">&quot;XC&quot;</span>,message,correlationData -&gt; &#123;</span><br><span class="line">    correlationData.getMessageProperties().setExpiration(<span class="string">&quot;5000&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªä»£ç å—æ¥è‡ªä¸‹æ–¹çš„æ¡ˆä¾‹</p><p><strong>ä¸¤è€…åŒºåˆ«</strong></p><p>å¦‚æœè®¾ç½®äº†é˜Ÿåˆ—çš„ TTL å±æ€§ï¼Œé‚£ä¹ˆä¸€æ—¦æ¶ˆæ¯è¿‡æœŸï¼Œå°±ä¼šè¢«é˜Ÿåˆ—ä¸¢å¼ƒ(å¦‚æœé…ç½®äº†æ­»ä¿¡é˜Ÿåˆ—è¢«ä¸¢åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­)ï¼Œè€Œç¬¬äºŒç§æ–¹å¼ï¼Œæ¶ˆæ¯å³ä½¿è¿‡æœŸï¼Œä¹Ÿä¸ä¸€å®šä¼šè¢«é©¬ä¸Šä¸¢å¼ƒï¼Œå› ä¸ºæ¶ˆæ¯æ˜¯å¦è¿‡æœŸæ˜¯åœ¨å³å°†æŠ•é€’åˆ°æ¶ˆè´¹è€…ä¹‹å‰åˆ¤å®šçš„ï¼Œå¦‚æœå½“å‰é˜Ÿåˆ—æœ‰ä¸¥é‡çš„æ¶ˆæ¯ç§¯å‹æƒ…å†µï¼Œåˆ™å·²è¿‡æœŸçš„æ¶ˆæ¯ä¹Ÿè®¸è¿˜èƒ½å­˜æ´»è¾ƒé•¿æ—¶é—´ï¼Œå…·ä½“çœ‹ä¸‹æ–¹æ¡ˆä¾‹ã€‚</p><p>å¦å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœä¸è®¾ç½® TTLï¼Œè¡¨ç¤ºæ¶ˆæ¯æ°¸è¿œä¸ä¼šè¿‡æœŸï¼Œå¦‚æœå°† TTL è®¾ç½®ä¸º 0ï¼Œåˆ™è¡¨ç¤ºé™¤éæ­¤æ—¶å¯ä»¥ç›´æ¥æŠ•é€’è¯¥æ¶ˆæ¯åˆ°æ¶ˆè´¹è€…ï¼Œå¦åˆ™è¯¥æ¶ˆæ¯å°†ä¼šè¢«ä¸¢å¼ƒ</p><h2 id="SpringBootä¸­æ•´åˆRabbitMQ"><a href="#SpringBootä¸­æ•´åˆRabbitMQ" class="headerlink" title="SpringBootä¸­æ•´åˆRabbitMQ"></a>SpringBootä¸­æ•´åˆRabbitMQ</h2><blockquote><p><strong>ä½¿ç”¨<a href="https://www.naste.top:18083/">å°é£ä»£ç ç”Ÿæˆå™¨</a>å¿«é€Ÿç”ŸæˆSpringBooté¡¹ç›®</strong></p></blockquote><h3 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--RabbitMQ-SpringBoot ä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ymlé…ç½®"><a href="#ymlé…ç½®" class="headerlink" title="ymlé…ç½®"></a>ymlé…ç½®</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.40</span><span class="number">.168</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">guest</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">guest</span></span><br></pre></td></tr></table></figure><h2 id="é˜Ÿåˆ—TTLâ€”SpringBoot"><a href="#é˜Ÿåˆ—TTLâ€”SpringBoot" class="headerlink" title="é˜Ÿåˆ—TTLâ€”SpringBoot"></a>é˜Ÿåˆ—TTLâ€”SpringBoot</h2><h3 id="ä»£ç æ¶æ„å›¾"><a href="#ä»£ç æ¶æ„å›¾" class="headerlink" title="ä»£ç æ¶æ„å›¾"></a>ä»£ç æ¶æ„å›¾</h3><p>åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ— QA å’Œ QBï¼Œä¸¤ä¸ªé˜Ÿåˆ—çš„ TTL åˆ†åˆ«è®¾ç½®ä¸º 10S å’Œ 40Sï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªäº¤æ¢æœº X å’Œæ­»ä¿¡äº¤æ¢æœº Yï¼Œå®ƒä»¬çš„ç±»å‹éƒ½æ˜¯ directï¼Œåˆ›å»ºä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ— QDï¼Œå®ƒä»¬çš„ç»‘å®šå…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="https://www.naste.top:9000/images/image.6ipia9redgw0.webp" alt="image"></p><p>åŸå…ˆé…ç½®é˜Ÿåˆ—ä¿¡æ¯ï¼Œå†™åœ¨äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä»£ç ä¸­ï¼Œç°åœ¨å¯å†™åœ¨é…ç½®ç±»ä¸­ï¼Œç”Ÿäº§è€…åªå‘æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…åªæ¥å—æ¶ˆæ¯</p><h3 id="TTLé…ç½®"><a href="#TTLé…ç½®" class="headerlink" title="TTLé…ç½®"></a>TTLé…ç½®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * TTLé…ç½®ç±»ä»£ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TtlQueueConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">X_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;X&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">Y_DEAD_LETTER_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;Y&quot;</span>;</span><br><span class="line">    <span class="comment">//æ™®é€šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_A</span> <span class="operator">=</span> <span class="string">&quot;QA&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_B</span> <span class="operator">=</span> <span class="string">&quot;QB&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_LETTER_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;QD&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜xExchange  åˆ«å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;xExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">xExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(X_EXCHANGE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜yExchange åˆ«å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;yExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">yExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜æ™®é€šé˜Ÿåˆ—  è¦æœ‰ttl ä¸º10s</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueA&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queueA</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡RoutingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;YD&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®TTL 10s å•ä½æ˜¯ms</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-message-ttl&quot;</span>, <span class="number">10000</span>);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_A).withArguments(arguments).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜æ™®é€šé˜Ÿåˆ—  è¦æœ‰ttl ä¸º40s</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueB&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queueB</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡RoutingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;YD&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®TTL 10s å•ä½æ˜¯ms</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-message-ttl&quot;</span>, <span class="number">40000</span>);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_B).withArguments(arguments).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜æ­»ä¿¡é˜Ÿåˆ—  è¦æœ‰ttl ä¸º40s</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueD&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queueD</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(DEAD_LETTER_QUEUE).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜é˜Ÿåˆ— QA ç»‘å®š X äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueABindingX</span><span class="params">(<span class="meta">@Qualifier(&quot;queueA&quot;)</span> Queue queueA,</span></span><br><span class="line"><span class="params">                                  <span class="meta">@Qualifier(&quot;xExchange&quot;)</span> DirectExchange xExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queueA).to(xExchange).with(<span class="string">&quot;XA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜é˜Ÿåˆ— QB ç»‘å®š X äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueBBindingX</span><span class="params">(<span class="meta">@Qualifier(&quot;queueB&quot;)</span> Queue queueB,</span></span><br><span class="line"><span class="params">                                  <span class="meta">@Qualifier(&quot;xExchange&quot;)</span> DirectExchange xExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queueB).to(xExchange).with(<span class="string">&quot;XB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜é˜Ÿåˆ— QD ç»‘å®š Y äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueDBindingY</span><span class="params">(<span class="meta">@Qualifier(&quot;queueD&quot;)</span> Queue queueD,</span></span><br><span class="line"><span class="params">                                  <span class="meta">@Qualifier(&quot;yExchange&quot;)</span> DirectExchange yExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queueD).to(yExchange).with(<span class="string">&quot;YD&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç”Ÿäº§è€…-8"><a href="#ç”Ÿäº§è€…-8" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h3><p><strong>Controllerå±‚æ¥æ”¶å‚æ•°ï¼Œå°†æ¥æ”¶çš„å‚æ•°ä¿¡æ¯æ”¾å…¥åˆ°RabbitMQä¸­</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘é€æ¶ˆæ¯&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;ttl&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SendMessageController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å§‹å‘æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sendMsg/&#123;message&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable(&quot;message&quot;)</span> String message)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´:&#123;&#125;,å‘é€ä¸€æ¡ä¿¡æ¯ç»™ä¸¤ä¸ªTTLé˜Ÿåˆ—ï¼š&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XA&quot;</span>, <span class="string">&quot;æ¶ˆæ¯æ¥è‡ªttlä¸º10sçš„é˜Ÿåˆ—:&quot;</span> + message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XB&quot;</span>, <span class="string">&quot;æ¶ˆæ¯æ¥è‡ªttlä¸º40sçš„é˜Ÿåˆ—:&quot;</span> + message);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>å‘èµ·è¯·æ±‚ï¼š<a href="http://localhost:8088/ttl/sendMsg/å“ˆå“ˆå“ˆ1">http://localhost:8088/ttl/sendMsg/å“ˆå“ˆå“ˆ1</a></p><p><img src="https://www.naste.top:9000/images/image-20230530202305866.png" alt="image-20230530202305866"></p><p>ç¬¬ä¸€æ¡æ¶ˆæ¯åœ¨ 10S åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œç„¶åè¢«æ¶ˆè´¹è€…æ¶ˆè´¹æ‰ï¼Œç¬¬äºŒæ¡æ¶ˆæ¯åœ¨ 40S ä¹‹åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œ ç„¶åè¢«æ¶ˆè´¹æ‰ï¼Œè¿™æ ·ä¸€ä¸ªå»¶æ—¶é˜Ÿåˆ—å°±æ‰“é€ å®Œæˆäº†ã€‚</p><p>ä¸è¿‡ï¼Œå¦‚æœè¿™æ ·ä½¿ç”¨çš„è¯ï¼Œå²‚ä¸æ˜¯æ¯å¢åŠ ä¸€ä¸ªæ–°çš„æ—¶é—´éœ€æ±‚ï¼Œå°±è¦æ–°å¢ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™é‡Œåªæœ‰ 10S å’Œ 40S ä¸¤ä¸ªæ—¶é—´é€‰é¡¹ï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªå°æ—¶åå¤„ç†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¢åŠ  TTL ä¸ºä¸€ä¸ªå°æ—¶çš„é˜Ÿåˆ—ï¼Œå¦‚æœæ˜¯é¢„å®šä¼šè®®å®¤ç„¶åæå‰é€šçŸ¥è¿™æ ·çš„åœºæ™¯ï¼Œå²‚ä¸æ˜¯è¦å¢åŠ æ— æ•°ä¸ªé˜Ÿåˆ—æ‰èƒ½æ»¡è¶³éœ€æ±‚ï¼Ÿ</p><h2 id="å»¶æ—¶é˜Ÿåˆ—TTLä¼˜åŒ–"><a href="#å»¶æ—¶é˜Ÿåˆ—TTLä¼˜åŒ–" class="headerlink" title="å»¶æ—¶é˜Ÿåˆ—TTLä¼˜åŒ–"></a>å»¶æ—¶é˜Ÿåˆ—TTLä¼˜åŒ–</h2><p>åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ— QCï¼Œè¯¥é˜Ÿåˆ—ä¸è®¾ç½® TTL æ—¶é—´ï¼Œæ ¹æ®å‰ç«¯çš„è¯·æ±‚ç¡®å®š TTL æ—¶é—´ï¼Œç»‘å®šå…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="https://www.naste.top:9000/images/image.267zky9xj8dc.webp" alt="image"></p><h3 id="é…ç½®ç±»ä»£ç "><a href="#é…ç½®ç±»ä»£ç " class="headerlink" title="é…ç½®ç±»ä»£ç "></a>é…ç½®ç±»ä»£ç </h3><p><strong>æ–°å¢ä¸€ä¸ªé…ç½®æ–‡ä»¶ç±»ï¼Œç”¨äºæ–°å¢é˜Ÿåˆ— QCï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä¸Šæ–¹çš„é…ç½®æ–‡ä»¶ç±»é‡Œ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MsgTtlQueueConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™®é€šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_C</span> <span class="operator">=</span> <span class="string">&quot;QC&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºçš„åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String Y_DEAD_LETTER_EXCHANGE=<span class="string">&quot;Y&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜QC</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueC&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">QueueC</span><span class="params">()</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>,Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">        <span class="comment">//è®¾ç½®æ­»ä¿¡RoutingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>,<span class="string">&quot;XC&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_C).withArguments(arguments).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜é˜Ÿåˆ— QC ç»‘å®š X äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueCBindingX</span><span class="params">(<span class="meta">@Qualifier(&quot;queueC&quot;)</span> Queue queueC,</span></span><br><span class="line"><span class="params">                                  <span class="meta">@Qualifier(&quot;xExchange&quot;)</span> DirectExchange xExchange)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queueC).to(xExchange).with(<span class="string">&quot;XC&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç”Ÿäº§è€…-9"><a href="#ç”Ÿäº§è€…-9" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h3><p><strong>Controller æ–°å¢æ–¹æ³•ï¼šè¯¥æ–¹æ³•æ¥æ”¶çš„è¯·æ±‚è¦å¸¦æœ‰ TTL æ—¶é—´</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xiaofei.rabbit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘é€æ¶ˆæ¯&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;ttl&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SendMessageController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å§‹å‘æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sendMsg/&#123;message&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable(&quot;message&quot;)</span> String message)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´:&#123;&#125;,å‘é€ä¸€æ¡ä¿¡æ¯ç»™ä¸¤ä¸ªTTLé˜Ÿåˆ—ï¼š&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XA&quot;</span>, <span class="string">&quot;æ¶ˆæ¯æ¥è‡ªttlä¸º10sçš„é˜Ÿåˆ—:&quot;</span> + message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XB&quot;</span>, <span class="string">&quot;æ¶ˆæ¯æ¥è‡ªttlä¸º40sçš„é˜Ÿåˆ—:&quot;</span> + message);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å§‹å‘æ¶ˆæ¯ å‘TTL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sendExpirationMsg/&#123;message&#125;/&#123;ttlTime&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable(&quot;message&quot;)</span> String message,</span></span><br><span class="line"><span class="params">                        <span class="meta">@PathVariable(&quot;ttlTime&quot;)</span> String ttlTime)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´:&#123;&#125;,å‘é€ä¸€æ¡æ—¶é•¿æ˜¯&#123;&#125;æ¯«ç§’TTLä¿¡æ¯ç»™é˜Ÿåˆ—QCï¼š&#123;&#125;&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), ttlTime, message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XC&quot;</span>, message, msg -&gt; &#123;</span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯çš„æ—¶å€™çš„å»¶è¿Ÿæ—¶é•¿</span></span><br><span class="line">            msg.getMessageProperties().setExpiration(ttlTime);</span><br><span class="line">            <span class="keyword">return</span> msg;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>å‘é€è¯·æ±‚</p><ul><li><a href="http://localhost:8088/ttl/sendExpirationMsg/ä½ å¥½1/20000">http://localhost:8088/ttl/sendExpirationMsg/ä½ å¥½1/20000</a></li><li><a href="http://localhost:8088/ttl/sendExpirationMsg/ä½ å¥½2/2000">http://localhost:8088/ttl/sendExpirationMsg/ä½ å¥½2/2000</a></li></ul><blockquote><p><strong>å‡ºç°é—®é¢˜</strong>:</p><p><img src="https://www.naste.top:9000/images/1658765665496.39yyrmljat80.webp" alt="1658765665496"></p></blockquote><p>çœ‹èµ·æ¥ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œå°±ä»‹ç»è¿‡å¦‚æœä½¿ç”¨åœ¨æ¶ˆæ¯å±æ€§ä¸Šè®¾ç½® TTL çš„æ–¹å¼ï¼Œæ¶ˆæ¯å¯èƒ½å¹¶ä¸ä¼šæŒ‰æ—¶ã€Œæ­»äº¡ã€</p><blockquote><p>å› ä¸º RabbitMQ åªä¼šæ£€æŸ¥ç¬¬ä¸€ä¸ªæ¶ˆæ¯æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸåˆ™ä¸¢åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œ å¦‚æœç¬¬ä¸€ä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆé•¿ï¼Œè€Œç¬¬äºŒä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆçŸ­ï¼Œç¬¬äºŒä¸ªæ¶ˆæ¯å¹¶ä¸ä¼šä¼˜å…ˆå¾—åˆ°æ‰§è¡Œ</p></blockquote><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå¦‚å›¾çš„æ—¶é—´ï¼šä½ å¥½ 2 å»¶æ—¶ 2 ç§’ï¼Œå´åæ‰§è¡Œï¼Œè¿˜è¦ç­‰å¾…ä½ å¥½ 1 æ¶ˆè´¹åå†æ‰§è¡Œä½ å¥½2</p><h2 id="Rabbitmqæ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆåç»­è¡¥å……æˆ–ä¿®æ”¹ï¼‰"><a href="#Rabbitmqæ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆåç»­è¡¥å……æˆ–ä¿®æ”¹ï¼‰" class="headerlink" title="Rabbitmqæ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆåç»­è¡¥å……æˆ–ä¿®æ”¹ï¼‰"></a>Rabbitmqæ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆåç»­è¡¥å……æˆ–ä¿®æ”¹ï¼‰</h2><p>ä¸Šæ–‡ä¸­æåˆ°çš„é—®é¢˜ï¼Œç¡®å®æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸èƒ½å®ç°åœ¨æ¶ˆæ¯ç²’åº¦ä¸Šçš„ TTLï¼Œå¹¶ä½¿å…¶åœ¨è®¾ç½®çš„ TTL æ—¶é—´åŠæ—¶æ­»äº¡ï¼Œå°±æ— æ³•è®¾è®¡æˆä¸€ä¸ªé€šç”¨çš„å»¶æ—¶é˜Ÿåˆ—ã€‚é‚£å¦‚ä½•è§£å†³å‘¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å»è§£å†³è¯¥é—®é¢˜ã€‚</p><p><strong>å®‰è£…å»¶æ—¶é˜Ÿåˆ—æ’ä»¶</strong></p><p>å¯å»<a href="https://www.rabbitmq.com/community-plugins.html">å®˜ç½‘ä¸‹è½½</a>æ‰¾åˆ° <strong>rabbitmq_delayed_message_exchange</strong> æ’ä»¶ï¼Œæ”¾ç½®åˆ° RabbitMQ çš„æ’ä»¶ç›®å½•ã€‚</p><p>å› ä¸ºå®˜ç½‘ä¹Ÿæ˜¯è·³è½¬å»è¯¥æ’ä»¶çš„ GitHub åœ°å€è¿›è¡Œä¸‹è½½ï¼š<a href="https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases">ç‚¹å‡»è·³è½¬</a></p><p>æ‰“å¼€ Linuxï¼Œç”¨ <code>Xftp</code> å°†æ’ä»¶æ”¾åˆ° RabbitMQ çš„<mark>å®‰è£…ç›®å½•</mark>ä¸‹çš„ plgins ç›®å½•ï¼Œ</p><p>RabbitMQ ä¸å…¶ plgins ç›®å½•é»˜è®¤åˆ†åˆ«ä½äº</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># RabbitMQ å®‰è£…ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/lib/rabbitmq/lib/rabbitmq_server-3.8.8   </span><br><span class="line"><span class="comment"># RabbitMQ çš„ plgins æ‰€åœ¨ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /usr/lib/rabbitmq/lib/rabbitmq_server-3.8.8/plugins</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æˆ‘çš„ç‰ˆæœ¬æ˜¯ <code>/rabbitmq_server-3.8.8</code></p><p>è¿›å…¥ç›®å½•åæ‰§è¡Œä¸‹é¢å‘½ä»¤è®©è¯¥æ’ä»¶ç”Ÿæ•ˆï¼Œç„¶åé‡å¯ RabbitMQ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_delayed_message_exchange</span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">systemctl restart rabbitmq-server</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@master plugins]<span class="comment"># rabbitmq-plugins enable rabbitmq_delayed_message_exchange</span></span><br><span class="line">Enabling plugins on node rabbit@master:</span><br><span class="line">rabbitmq_delayed_message_exchange</span><br><span class="line">The following plugins have been configured:</span><br><span class="line">  rabbitmq_delayed_message_exchange</span><br><span class="line">  rabbitmq_management</span><br><span class="line">  rabbitmq_management_agent</span><br><span class="line">  rabbitmq_web_dispatch</span><br><span class="line">Applying plugin configuration to rabbit@master...</span><br><span class="line">The following plugins have been enabled:</span><br><span class="line">  rabbitmq_delayed_message_exchange</span><br><span class="line"></span><br><span class="line">started 1 plugins.</span><br><span class="line">[root@master plugins]<span class="comment"># systemctl restart rabbitmq-server</span></span><br></pre></td></tr></table></figure><p>::: tip è§£é‡Š</p><p>å®‰è£…å‘½ä»¤ä¸èƒ½å‡ºç°æ’ä»¶ç‰ˆæœ¬å’Œåç¼€ï¼Œå¦‚ <code>rabbitmq-plugins enable rabbitmq_delayed_message_exchange-3.8.0.ez</code> ä¼šæŠ¥é”™</p><p>å¿…é¡»æ˜¯ <code>rabbitmq-plugins enable rabbitmq_delayed_message_exchange</code>ï¼Œåé¢ä¸å…è®¸å¡«å…¥ç‰ˆæœ¬å’Œæ–‡ä»¶åç¼€</p><p>:::</p><p>æ‰“å¼€ Web ç•Œé¢ï¼ŒæŸ¥çœ‹äº¤æ¢æœºçš„æ–°å¢åŠŸèƒ½åˆ—è¡¨ï¼Œå¦‚æœå¤šå‡ºäº†å¦‚å›¾æ‰€ç¤ºï¼Œä»£è¡¨æˆåŠŸæ·»åŠ æ’ä»¶</p><p><img src="https://www.naste.top:9000/images/image.3nqc69j0pws0.webp" alt="image"></p><h2 id="æ’ä»¶å®æˆ˜"><a href="#æ’ä»¶å®æˆ˜" class="headerlink" title="æ’ä»¶å®æˆ˜"></a>æ’ä»¶å®æˆ˜</h2><p>åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ— delayed.queueï¼Œä¸€ä¸ªè‡ªå®šä¹‰äº¤æ¢æœº delayed.exchangeï¼Œç»‘å®šå…³ç³»å¦‚ä¸‹:</p><p><img src="https://www.naste.top:9000/images/image.1tla4z5g4yps.webp" alt="image"></p><h3 id="é…ç½®ç±»ä»£ç -1"><a href="#é…ç½®ç±»ä»£ç -1" class="headerlink" title="é…ç½®ç±»ä»£ç "></a>é…ç½®ç±»ä»£ç </h3><p>æ–°å¢ä¸€ä¸ªé…ç½®ç±» <code>DelayedQueueConfig</code>ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨åŸæ¥çš„é…ç½®æ–‡ä»¶é‡Œï¼Œä»£ç é‡Œä½¿ç”¨äº† <code>CustomExchange</code> ç±»ï¼Œé€šè¿‡å‚æ•°æ¥è‡ªå®šä¹‰ä¸€ä¸ªç±»å‹(directã€topicç­‰)</p><p>åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„äº¤æ¢æœºä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ–°çš„äº¤æ¢ç±»å‹ï¼Œè¯¥ç±»å‹æ¶ˆæ¯æ”¯æŒå»¶è¿ŸæŠ•é€’æœºåˆ¶æ¶ˆæ¯ä¼ é€’åå¹¶ä¸ä¼šç«‹å³æŠ•é€’åˆ°ç›®æ ‡é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨ mnesia(ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿ)è¡¨ä¸­ï¼Œå½“è¾¾åˆ°æŠ•é€’æ—¶é—´æ—¶ï¼Œæ‰æŠ•é€’åˆ°ç›®æ ‡é˜Ÿåˆ—ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayedQueueConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//äº¤æ¢æœº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;delayed.exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;delayed.queue&quot;</span>;</span><br><span class="line">    <span class="comment">//routingKey</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;delayed.routingkey&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">delayedQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(DELAYED_QUEUE_NAME);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜äº¤æ¢æœº,åŸºäºæ’ä»¶çš„äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CustomExchange <span class="title function_">delayedExchange</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        arguments.put(<span class="string">&quot;x-delayed-type&quot;</span>,<span class="string">&quot;direct&quot;</span>);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1.äº¤æ¢æœºçš„åç§°</span></span><br><span class="line"><span class="comment">         * 2.äº¤æ¢æœºçš„ç±»å‹ x-delayed-message</span></span><br><span class="line"><span class="comment">         * 3.æ˜¯å¦éœ€è¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦éœ€è¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–çš„å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CustomExchange</span>(DELAYED_EXCHANGE_NAME,<span class="string">&quot;x-delayed-message&quot;</span>,</span><br><span class="line">                <span class="literal">true</span>,<span class="literal">false</span>,arguments);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">delayedQueueBindingDelayedExchange</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@Qualifier(&quot;delayedQueue&quot;)</span> Queue delayedQueue,</span></span><br><span class="line"><span class="params">            <span class="meta">@Qualifier(&quot;delayedExchange&quot;)</span>CustomExchange delayedExchange)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(delayedQueue).to(delayedExchange)</span><br><span class="line">                .with(DELAYED_ROUTING_KEY).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç”Ÿäº§è€…ä»£ç </strong></p><p>åœ¨ controller é‡Œæ–°å¢ä¸€ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼€å§‹å‘æ¶ˆæ¯ï¼ŒåŸºäºæ’ä»¶çš„ æ¶ˆæ¯åŠ å»¶è¿Ÿçš„æ—¶é—´</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/sendDelayMsg/&#123;message&#125;/&#123;delayTime&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable(&quot;message&quot;)</span> String message,</span></span><br><span class="line"><span class="params">                    <span class="meta">@PathVariable(&quot;delayTime&quot;)</span> Integer delayTime)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;å½“å‰æ—¶é—´:&#123;&#125;,å‘é€ä¸€æ¡æ—¶é•¿æ˜¯&#123;&#125;æ¯«ç§’TTLä¿¡æ¯ç»™å»¶è¿Ÿé˜Ÿåˆ—delayed.queueï¼š&#123;&#125;&quot;</span>,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Date</span>().toString(),delayTime,message);</span><br><span class="line"></span><br><span class="line">    rabbitTemplate.convertAndSend(DelayedQueueConfig.DELAYED_EXCHANGE_NAME,</span><br><span class="line">            DelayedQueueConfig.DELAYED_ROUTING_KEY,message, msg -&gt; &#123;</span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯çš„æ—¶å€™çš„å»¶è¿Ÿæ—¶é•¿ å•ä½ms</span></span><br><span class="line">        msg.getMessageProperties().setDelay(delayTime);</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ¶ˆè´¹è€…ä»£ç </strong></p><p>ç›‘å¬å»¶æ—¶é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰æ¶ˆæ¯è¿›å…¥è¯¥é˜Ÿåˆ—ï¼Œåˆ™æ‰“å°åˆ°æ§åˆ¶å°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayQueueConsumer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = DelayedQueueConfig.DELAYED_QUEUE_NAME)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveDelayQueue</span><span class="params">(Message message)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody());</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;,æ”¶åˆ°å»¶æ—¶é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="http://localhost:8088/ttl/sendDelayMsg/hello1/20000">http://localhost:8088/ttl/sendDelayMsg/hello1/20000</a></p><p><a href="http://localhost:8088/ttl/sendDelayMsg/hello2/2000">http://localhost:8088/ttl/sendDelayMsg/hello2/2000</a></p><p><img src="https://www.naste.top:9000/images/image.17h77dwilchs.webp" alt="image"></p><p>å¯ä»¥çœ‹åˆ°å“ªæ€• hello1 éœ€è¦20ç§’å†è¿›å…¥å»¶æ—¶é˜Ÿåˆ—ï¼Œhello2 2 ç§’åç›´æ¥è¿›å…¥å»¶æ—¶é˜Ÿåˆ—ï¼Œæ— éœ€ç­‰å¾… hello1</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å»¶æ—¶é˜Ÿåˆ—åœ¨éœ€è¦å»¶æ—¶å¤„ç†çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œä½¿ç”¨ RabbitMQ æ¥å®ç°å»¶æ—¶é˜Ÿåˆ—å¯ä»¥å¾ˆå¥½çš„åˆ©ç”¨ RabbitMQ çš„ç‰¹æ€§ï¼Œå¦‚ï¼šæ¶ˆæ¯å¯é å‘é€ã€æ¶ˆæ¯å¯é æŠ•é€’ã€æ­»ä¿¡é˜Ÿåˆ—æ¥ä¿éšœæ¶ˆæ¯è‡³å°‘è¢«æ¶ˆè´¹ä¸€æ¬¡ä»¥åŠæœªè¢«æ­£ç¡®å¤„ç†çš„æ¶ˆæ¯ä¸ä¼šè¢«ä¸¢å¼ƒã€‚å¦å¤–ï¼Œé€šè¿‡ RabbitMQ é›†ç¾¤çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½çš„è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œä¸ä¼šå› ä¸ºå•ä¸ªèŠ‚ç‚¹æŒ‚æ‰å¯¼è‡´å»¶æ—¶é˜Ÿåˆ—ä¸å¯ç”¨æˆ–è€…æ¶ˆæ¯ä¸¢å¤±ã€‚</p><p>å½“ç„¶ï¼Œå»¶æ—¶é˜Ÿåˆ—è¿˜æœ‰å¾ˆå¤šå…¶å®ƒé€‰æ‹©ï¼Œæ¯”å¦‚åˆ©ç”¨ Java çš„ DelayQueueï¼Œåˆ©ç”¨ Redis çš„ zsetï¼Œåˆ©ç”¨ Quartz æˆ–è€…åˆ©ç”¨ kafka çš„æ—¶é—´è½®ï¼Œè¿™äº›æ–¹å¼å„æœ‰ç‰¹ç‚¹,çœ‹éœ€è¦é€‚ç”¨çš„åœºæ™¯ã€‚</p><h1 id="å‘å¸ƒç¡®è®¤é«˜çº§"><a href="#å‘å¸ƒç¡®è®¤é«˜çº§" class="headerlink" title="å‘å¸ƒç¡®è®¤é«˜çº§"></a>å‘å¸ƒç¡®è®¤é«˜çº§</h1><h2 id="å‘å¸ƒç¡®è®¤SpringBootç‰ˆæœ¬"><a href="#å‘å¸ƒç¡®è®¤SpringBootç‰ˆæœ¬" class="headerlink" title="å‘å¸ƒç¡®è®¤SpringBootç‰ˆæœ¬"></a>å‘å¸ƒç¡®è®¤SpringBootç‰ˆæœ¬</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><h3 id="æ·»åŠ é…ç½®ç±»"><a href="#æ·»åŠ é…ç½®ç±»" class="headerlink" title="æ·»åŠ é…ç½®ç±»"></a>æ·»åŠ é…ç½®ç±»</h3><h3 id="æ¶ˆæ¯ç”Ÿäº§è€…"><a href="#æ¶ˆæ¯ç”Ÿäº§è€…" class="headerlink" title="æ¶ˆæ¯ç”Ÿäº§è€…"></a>æ¶ˆæ¯ç”Ÿäº§è€…</h3><h3 id="æ¶ˆæ¯æ¶ˆè´¹è€…"><a href="#æ¶ˆæ¯æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆæ¯æ¶ˆè´¹è€…"></a>æ¶ˆæ¯æ¶ˆè´¹è€…</h3><h3 id="æ¶ˆæ¯ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åçš„å›è°ƒæ¥å£"><a href="#æ¶ˆæ¯ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åçš„å›è°ƒæ¥å£" class="headerlink" title="æ¶ˆæ¯ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åçš„å›è°ƒæ¥å£"></a>æ¶ˆæ¯ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åçš„å›è°ƒæ¥å£</h3><h2 id="å›é€€æ¶ˆæ¯"><a href="#å›é€€æ¶ˆæ¯" class="headerlink" title="å›é€€æ¶ˆæ¯"></a>å›é€€æ¶ˆæ¯</h2><h3 id="ä»‹ç»-1"><a href="#ä»‹ç»-1" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><h2 id="å®æˆ˜-1"><a href="#å®æˆ˜-1" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><h3 id="ä¿®æ”¹å›è°ƒæ¥å£"><a href="#ä¿®æ”¹å›è°ƒæ¥å£" class="headerlink" title="ä¿®æ”¹å›è°ƒæ¥å£"></a>ä¿®æ”¹å›è°ƒæ¥å£</h3><h2 id="å¤‡ä»½äº¤æ¢æœº"><a href="#å¤‡ä»½äº¤æ¢æœº" class="headerlink" title="å¤‡ä»½äº¤æ¢æœº"></a>å¤‡ä»½äº¤æ¢æœº</h2><h3 id="ä»‹ç»-2"><a href="#ä»‹ç»-2" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><h3 id="å®æˆ˜-2"><a href="#å®æˆ˜-2" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><h3 id="ä¿®æ”¹é«˜çº§ç¡®è®¤å‘å¸ƒ-é…ç½®ç±»"><a href="#ä¿®æ”¹é«˜çº§ç¡®è®¤å‘å¸ƒ-é…ç½®ç±»" class="headerlink" title="ä¿®æ”¹é«˜çº§ç¡®è®¤å‘å¸ƒ é…ç½®ç±»"></a>ä¿®æ”¹é«˜çº§ç¡®è®¤å‘å¸ƒ é…ç½®ç±»</h3><h3 id="æŠ¥è­¦æ¶ˆè´¹è€…"><a href="#æŠ¥è­¦æ¶ˆè´¹è€…" class="headerlink" title="æŠ¥è­¦æ¶ˆè´¹è€…"></a>æŠ¥è­¦æ¶ˆè´¹è€…</h3><h1 id="RabbitMQå…¶ä»–çŸ¥è¯†ç‚¹"><a href="#RabbitMQå…¶ä»–çŸ¥è¯†ç‚¹" class="headerlink" title="RabbitMQå…¶ä»–çŸ¥è¯†ç‚¹"></a>RabbitMQå…¶ä»–çŸ¥è¯†ç‚¹</h1><h2 id="å¹‚ç­‰æ€§"><a href="#å¹‚ç­‰æ€§" class="headerlink" title="å¹‚ç­‰æ€§"></a>å¹‚ç­‰æ€§</h2><h3 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><h3 id="æ¶ˆæ¯é‡å¤æ¶ˆè´¹"><a href="#æ¶ˆæ¯é‡å¤æ¶ˆè´¹" class="headerlink" title="æ¶ˆæ¯é‡å¤æ¶ˆè´¹"></a>æ¶ˆæ¯é‡å¤æ¶ˆè´¹</h3><h3 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h3><h3 id="æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ"><a href="#æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ" class="headerlink" title="æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ"></a>æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ</h3><h2 id="ä¼˜å…ˆçº§é˜Ÿåˆ—"><a href="#ä¼˜å…ˆçº§é˜Ÿåˆ—" class="headerlink" title="ä¼˜å…ˆçº§é˜Ÿåˆ—"></a>ä¼˜å…ˆçº§é˜Ÿåˆ—</h2><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><h3 id="æ·»åŠ æ–¹æ³•"><a href="#æ·»åŠ æ–¹æ³•" class="headerlink" title="æ·»åŠ æ–¹æ³•"></a>æ·»åŠ æ–¹æ³•</h3><h2 id="å®æˆ˜-3"><a href="#å®æˆ˜-3" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><h3 id="ç”Ÿäº§è€…ä»£ç "><a href="#ç”Ÿäº§è€…ä»£ç " class="headerlink" title="ç”Ÿäº§è€…ä»£ç "></a>ç”Ÿäº§è€…ä»£ç </h3><h3 id="æ¶ˆè´¹è€…ä»£ç "><a href="#æ¶ˆè´¹è€…ä»£ç " class="headerlink" title="æ¶ˆè´¹è€…ä»£ç "></a>æ¶ˆè´¹è€…ä»£ç </h3><h2 id="æƒ°æ€§é˜Ÿåˆ—"><a href="#æƒ°æ€§é˜Ÿåˆ—" class="headerlink" title="æƒ°æ€§é˜Ÿåˆ—"></a>æƒ°æ€§é˜Ÿåˆ—</h2><h3 id="ä½¿ç”¨åœºæ™¯-1"><a href="#ä½¿ç”¨åœºæ™¯-1" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><h3 id="ä¸¤ç§æ¨¡å¼"><a href="#ä¸¤ç§æ¨¡å¼" class="headerlink" title="ä¸¤ç§æ¨¡å¼"></a>ä¸¤ç§æ¨¡å¼</h3><h3 id="å†…å­˜å¼€é”€å¯¹æ¯”"><a href="#å†…å­˜å¼€é”€å¯¹æ¯”" class="headerlink" title="å†…å­˜å¼€é”€å¯¹æ¯”"></a>å†…å­˜å¼€é”€å¯¹æ¯”</h3><blockquote><p><strong>æ­»ä¿¡é˜Ÿåˆ—ã€å»¶è¿Ÿé˜Ÿåˆ—ã€å‘å¸ƒç¡®è®¤é«˜çº§ã€RabbitmQå…¶ä»–çŸ¥è¯†ç‚¹ç­‰åç»­ä½¿ç”¨åˆ°è¿›è¡Œè¡¥å……</strong></p></blockquote>]]></content>
    
    
    <summary type="html">RabbitMQ</summary>
    
    
    
    <category term="æ¶ˆæ¯ä¸­é—´ä»¶" scheme="https://www.naste.top:1024/categories/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
    <category term="RabbitMQ" scheme="https://www.naste.top:1024/tags/RabbitMQ/"/>
    
    <category term="SpringBoot" scheme="https://www.naste.top:1024/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨JavaScriptä¿®æ”¹ç½‘é¡µä»»æ„å…ƒç´ çš„æ–‡æœ¬å†…å®¹</title>
    <link href="https://www.naste.top:1024/posts/1455011995.html"/>
    <id>https://www.naste.top:1024/posts/1455011995.html</id>
    <published>2023-05-15T06:33:56.000Z</published>
    <updated>2023-05-15T06:51:42.190Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><p><img src="https://www.naste.top:9000/images/image-20230515145106241.png" alt="image-20230515145106241"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•ä¸€ï¼š</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">contentEditable</span>=<span class="string">&quot;true&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•äºŒï¼š</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">designMode</span>=<span class="string">&#x27;on&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ä½¿ç”¨JavaScriptä¿®æ”¹ç½‘é¡µä»»æ„å…ƒç´ çš„æ–‡æœ¬å†…å®¹</summary>
    
    
    
    <category term="å‰ç«¯" scheme="https://www.naste.top:1024/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="JavaScript" scheme="https://www.naste.top:1024/tags/JavaScript/"/>
    
    <category term="å‰ç«¯" scheme="https://www.naste.top:1024/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>pinia</title>
    <link href="https://www.naste.top:1024/posts/3038627921.html"/>
    <id>https://www.naste.top:1024/posts/3038627921.html</id>
    <published>2023-05-11T01:13:43.000Z</published>
    <updated>2023-05-11T06:18:27.174Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="ä»€ä¹ˆæ˜¯pinia"><a href="#ä»€ä¹ˆæ˜¯pinia" class="headerlink" title="ä»€ä¹ˆæ˜¯pinia"></a>ä»€ä¹ˆæ˜¯pinia</h1><p><strong>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://pinia.web3doc.top/">https://pinia.web3doc.top/</a></strong></p><p>Pinia æ˜¯ Vue çš„ä¸“å±çŠ¶æ€ç®¡ç†åº“ï¼Œå¯ä»¥å®ç°è·¨ç»„ä»¶æˆ–é¡µé¢å…±äº«çŠ¶æ€ï¼Œæ˜¯ vuex çŠ¶æ€ç®¡ç†å·¥å…·çš„æ›¿ä»£å“ï¼Œå’Œ Vuexç›¸æ¯”ï¼Œå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿</p><ol><li>æä¾›æ›´åŠ ç®€å•çš„API ï¼ˆå»æ‰äº† mutation ï¼‰</li><li>æä¾›ç¬¦åˆç»„åˆå¼APIé£æ ¼çš„API ï¼ˆå’Œ Vue3 æ–°è¯­æ³•ç»Ÿä¸€ï¼‰</li><li>å»æ‰äº†modulesçš„æ¦‚å¿µï¼Œæ¯ä¸€ä¸ªstoreéƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—</li><li>æ­é… TypeScript ä¸€èµ·ä½¿ç”¨æä¾›å¯é çš„ç±»å‹æ¨æ–­</li></ol><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºä¸€ä¸ªvue3é¡¹ç›® å…·ä½“ä½¿ç”¨æŸ¥çœ‹æœ¬ç«™vue3æ–‡æ¡£</span></span><br><span class="line">npm init vue@latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£… pinia</span></span><br><span class="line">npm i pinia</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰“å¼€main.jsæ–‡ä»¶åŠ å…¥ä¸‹é¢ä»£ç </span></span><br><span class="line">import &#123; createPinia &#125; from &#x27;pinia&#x27;</span><br><span class="line"></span><br><span class="line">createApp(App).use(createPinia()).mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><ul><li><p>åˆ›å»ºstoreï¼šåœ¨srcç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªstoresæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å®šä¹‰ä¸€ä¸ªä¸€ä¸ªçš„storeï¼ˆä¸€ä¸ªä¸€ä¸ªçš„jsæ–‡ä»¶ï¼Œæ¯”å¦‚ <code>userInfo.jsã€category.js</code>ç­‰ï¼‰</p>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> usePersonStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;person&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰å±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> person = <span class="title function_">ref</span>(&#123;</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        <span class="attr">password</span>: <span class="string">&quot;xiaofei&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">updateUsername</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        person.<span class="property">value</span>.<span class="property">username</span> = <span class="string">&quot;xiaofei&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">updatePassword</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        person.<span class="property">value</span>.<span class="property">password</span> = <span class="string">&quot;123456&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        person, updateUsername, updatePassword</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨store</p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;usePersonStore&#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/person&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storePerson = <span class="title function_">usePersonStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//è·å–stateé‡Œé¢çš„å˜é‡</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(storePerson.<span class="property">person</span>.<span class="property">username</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(storePerson.<span class="property">person</span>.<span class="property">password</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//è·å–actionsé‡Œé¢çš„æ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript">storePerson.<span class="title function_">updatePassword</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨stateé‡Œé¢å®šä¹‰çš„å˜é‡ï¼Œè·å–ç”¨æˆ·åå’Œå¯†ç  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; storePerson.person.username &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; storePerson.person.password &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨actionsé‡Œé¢å®šä¹‰çš„æ–¹æ³• --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;storePerson.updateUsername&quot;</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·å<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h1><blockquote><p><strong>gettersç›´æ¥ä½¿ç”¨è®¡ç®—å±æ€§å³å¯å®ç°</strong></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;computed, ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> usePersonStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;person&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰å±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> person = <span class="title function_">ref</span>(&#123;</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä½¿ç”¨è®¡ç®—å±æ€§å®šä¹‰getters</span></span><br><span class="line">    <span class="keyword">const</span> updateUsernameGetters = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> person.<span class="property">value</span>.<span class="property">username</span> + <span class="string">&quot;ï¼šè®¡ç®—å±æ€§åçš„å€¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">updateUsername</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        person.<span class="property">value</span>.<span class="property">username</span> = <span class="string">&quot;xiaofei&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        person, updateUsernameGetters, updateUsername</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;usePersonStore&#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/person&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storePerson = <span class="title function_">usePersonStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//è·å–stateé‡Œé¢çš„å˜é‡</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(storePerson.<span class="property">person</span>.<span class="property">username</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨stateé‡Œé¢å®šä¹‰çš„å˜é‡ï¼Œè·å–ç”¨æˆ·åå’Œå¯†ç  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; storePerson.person.username &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨è®¡ç®—å±æ€§å®šä¹‰getters --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; storePerson.updateUsernameGetters&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨actionsé‡Œé¢å®šä¹‰çš„æ–¹æ³• --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;storePerson.updateUsername&quot;</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·å<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="action"><a href="#action" class="headerlink" title="action"></a>action</h1><ul><li>storeä¸­å®šä¹‰action</li><li>ç»„ä»¶ä¸­è§¦å‘action</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> usePersonStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;person&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰å±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> dataList = <span class="title function_">ref</span>([])</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥ action,asyncå’Œawaitå¿…é¡»æœ‰</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">loadList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span>)</span><br><span class="line">        dataList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        dataList, loadList</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;usePersonStore&#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/person&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storePerson = <span class="title function_">usePersonStore</span>()</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è°ƒç”¨å®šä¹‰çš„actionsæ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript">storePerson.<span class="title function_">loadList</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in storePerson.dataList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="storeToRefsè·å–refå®šä¹‰æ•°æ®ï¼ˆæ¨èï¼‰"><a href="#storeToRefsè·å–refå®šä¹‰æ•°æ®ï¼ˆæ¨èï¼‰" class="headerlink" title="storeToRefsè·å–refå®šä¹‰æ•°æ®ï¼ˆæ¨èï¼‰"></a>storeToRefsè·å–refå®šä¹‰æ•°æ®ï¼ˆæ¨èï¼‰</h1><blockquote><p><strong>storeToRefsåªèƒ½è·å–stateå’Œgetters</strong></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> usePersonStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;person&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰å±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> dataList = <span class="title function_">ref</span>([])</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥ action,asyncå’Œawaitå¿…é¡»æœ‰</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">loadList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span>)</span><br><span class="line">        dataList.<span class="property">value</span> = res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        dataList, loadList</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;usePersonStore&#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/person&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;storeToRefs&#125; <span class="keyword">from</span> <span class="string">&quot;pinia/dist/pinia&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storePerson = <span class="title function_">usePersonStore</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//ä½¿ç”¨storeToRefsè·å–refå®šä¹‰æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> &#123;dataList&#125; = <span class="title function_">storeToRefs</span>(storePerson)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//å‡½æ•°ä¸èƒ½ä½¿ç”¨storeToRefsè·å–ï¼Œåªèƒ½ä½¿ç”¨è·å–çš„å¯¹è±¡ç›´æ¥è°ƒç”¨</span></span></span><br><span class="line"><span class="language-javascript">storePerson.<span class="title function_">loadList</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in dataList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="piniaæŒä¹…åŒ–"><a href="#piniaæŒä¹…åŒ–" class="headerlink" title="piniaæŒä¹…åŒ–"></a>piniaæŒä¹…åŒ–</h1>]]></content>
    
    
    <summary type="html">pinia</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>vue3</title>
    <link href="https://www.naste.top:1024/posts/2591061011.html"/>
    <id>https://www.naste.top:1024/posts/2591061011.html</id>
    <published>2023-05-10T07:18:51.000Z</published>
    <updated>2023-05-11T02:18:41.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="å®‰è£…åŠé¡¹ç›®åˆå§‹åŒ–"><a href="#å®‰è£…åŠé¡¹ç›®åˆå§‹åŒ–" class="headerlink" title="å®‰è£…åŠé¡¹ç›®åˆå§‹åŒ–"></a>å®‰è£…åŠé¡¹ç›®åˆå§‹åŒ–</h1><h2 id="è®¤è¯†create-vue"><a href="#è®¤è¯†create-vue" class="headerlink" title="è®¤è¯†create-vue"></a>è®¤è¯†create-vue</h2><blockquote><p><strong>create-vueæ˜¯Vueå®˜æ–¹æ–°çš„è„šæ‰‹æ¶å·¥å…·ï¼Œåº•å±‚åˆ‡æ¢åˆ°äº† vite ï¼ˆä¸‹ä¸€ä»£å‰ç«¯å·¥å…·é“¾ï¼‰ï¼Œä¸ºå¼€å‘æä¾›æé€Ÿå“åº”</strong></p></blockquote><p><img src="https://www.naste.top:9000/images/1678178479590-ac164009-4a72-4448-85bf-67dc13f3d0c4.png" alt="image.png"></p><h2 id="ä½¿ç”¨create-vueåˆ›å»ºé¡¹ç›®"><a href="#ä½¿ç”¨create-vueåˆ›å»ºé¡¹ç›®" class="headerlink" title="ä½¿ç”¨create-vueåˆ›å»ºé¡¹ç›®"></a>ä½¿ç”¨create-vueåˆ›å»ºé¡¹ç›®</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‰ç½®æ¡ä»¶ - å·²å®‰è£…16.0æˆ–æ›´é«˜ç‰ˆæœ¬çš„Node.js</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œè¿™ä¸€æŒ‡ä»¤å°†ä¼šå®‰è£…å¹¶æ‰§è¡Œ create-vue</span></span><br><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure><p><img src="https://www.naste.top:9000/images/1678178685782-71a3b311-423d-4528-aae9-85e6068db452.png" alt="image.png"></p><h1 id="ç†Ÿæ‚‰é¡¹ç›®å’Œå…³é”®æ–‡ä»¶"><a href="#ç†Ÿæ‚‰é¡¹ç›®å’Œå…³é”®æ–‡ä»¶" class="headerlink" title="ç†Ÿæ‚‰é¡¹ç›®å’Œå…³é”®æ–‡ä»¶"></a>ç†Ÿæ‚‰é¡¹ç›®å’Œå…³é”®æ–‡ä»¶</h1><p><img src="https://www.naste.top:9000/images/1678178749511-f4a42cbf-987b-46a7-9a01-9cd4f00a5fcf.png" alt="image.png"></p><h1 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h1><h2 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- setupå†™æ³• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> message = <span class="string">&#x27;this is message&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">logMessage</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(message)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ—§ç‰ˆæœ¬å†™æ³• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> message = <span class="string">&#x27;this is message&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">logMessage</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(message)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// å¿…é¡»returnæ‰å¯ä»¥</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      message,</span></span><br><span class="line"><span class="language-javascript">      logMessage</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="reactiveå’Œrefå‡½æ•°"><a href="#reactiveå’Œrefå‡½æ•°" class="headerlink" title="reactiveå’Œrefå‡½æ•°"></a>reactiveå’Œrefå‡½æ•°</h2><h3 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a>reactive</h3><blockquote><p><strong>æ¥å—å¯¹è±¡ç±»å‹æ•°æ®çš„å‚æ•°ä¼ å…¥å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼çš„å¯¹è±¡æ¥å—å¯¹è±¡ç±»å‹æ•°æ®çš„å‚æ•°ä¼ å…¥å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼çš„å¯¹è±¡</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// reactiveåªèƒ½æ”¯æŒå¯¹è±¡ç±»å‹</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;reactive&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// reactiveé‡Œé¢å®šä¹‰å„ç§å±æ€§</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> person = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">id</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">username</span>: <span class="string">&#x27;XiaoFei&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// åˆ›å»ºä¸€ä¸ªå‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addAge</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  person.<span class="property">age</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>personå¯¹è±¡ä¿¡æ¯ï¼š&#123;&#123; person &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addAge&quot;</span>&gt;</span>ç‚¹å‡»æ·»åŠ å¹´é¾„ï¼š&#123;&#123; person.age &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><blockquote><p><strong>æ¥æ”¶ç®€å•ç±»å‹æˆ–è€…å¯¹è±¡ç±»å‹çš„æ•°æ®ä¼ å…¥å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼çš„å¯¹è±¡</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// ref å‡½æ•°å¯ä»¥æ¥æ”¶æ™®é€šç±»å‹ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å¯¹è±¡ï¼Œrefå®šä¹‰çš„ï¼Œéœ€è¦åœ¨è·å–çš„æ—¶å€™ .value</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// refæ¥æ”¶æ™®é€šç±»å‹å€¼</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// refæ¥æ”¶å¯¹è±¡ç±»å‹å€¼</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> person = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">id</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">username</span>: <span class="string">&#x27;XiaoFei&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addCount</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  count.<span class="property">value</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å®šä¹‰å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addAge</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  person.<span class="property">value</span>.<span class="property">age</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>æ™®é€šç±»å‹å€¼<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>countï¼š&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addCount&quot;</span>&gt;</span>ç‚¹å‡»æ·»åŠ <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>ä¼ å…¥å¯¹è±¡<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>personï¼š&#123;&#123; person &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addAge&quot;</span>&gt;</span>ç‚¹å‡»æ·»åŠ <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="reactiveå¯¹æ¯”ref"><a href="#reactiveå¯¹æ¯”ref" class="headerlink" title="reactiveå¯¹æ¯”ref"></a>reactiveå¯¹æ¯”ref</h3><ul><li>éƒ½æ˜¯ç”¨æ¥ç”Ÿæˆå“åº”å¼æ•°æ®</li><li>ä¸åŒç‚¹<ul><li>reactiveä¸èƒ½å¤„ç†ç®€å•ç±»å‹çš„æ•°æ®</li><li>refå‚æ•°ç±»å‹æ”¯æŒæ›´å¥½ï¼Œä½†æ˜¯å¿…é¡»é€šè¿‡.valueåšè®¿é—®ä¿®æ”¹</li><li>refå‡½æ•°å†…éƒ¨çš„å®ç°ä¾èµ–äºreactiveå‡½æ•°</li></ul></li><li>åœ¨å®é™…å·¥ä½œä¸­çš„æ¨è<ul><li>æ¨èä½¿ç”¨refå‡½æ•°ï¼Œå‡å°‘è®°å¿†è´Ÿæ‹…</li></ul></li></ul><h2 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h2><ul><li>è®¡ç®—å±æ€§ä¸­ä¸åº”è¯¥æœ‰â€œå‰¯ä½œç”¨â€ï¼Œ<strong>æ¯”å¦‚å¼‚æ­¥è¯·æ±‚ / ä¿®æ”¹dom</strong></li><li>é¿å…ç›´æ¥ä¿®æ”¹è®¡ç®—å±æ€§ä¸­çš„å€¼ï¼Œ<strong>è®¡ç®—å±æ€§åº”è¯¥åªè¯»çš„</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å¯¼å…¥</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref, computed&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// åŸå§‹æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> list = <span class="title function_">ref</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è®¡ç®—å±æ€§åæ•°æ®</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> computedList = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// è¿”å›æ•°ç»„ä¸­ &gt; 2çš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> list.<span class="property">value</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item &gt; <span class="number">2</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span> åŸå§‹æ•°æ® â€”â€” &#123;&#123; list &#125;&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span> è®¡ç®—å±æ€§æ•°æ® â€”â€” &#123;&#123; computedList &#125;&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><blockquote><p><strong>å±æ€§ç›‘å¬ï¼Œå½“å±æ€§çš„å€¼æ”¹å˜æ—¶ï¼Œè§¦å‘watchè®¾ç½®çš„å‡½æ•°</strong></p></blockquote><h3 id="ç›‘å¬å•ä¸ª-å¤šä¸ªæ•°æ®"><a href="#ç›‘å¬å•ä¸ª-å¤šä¸ªæ•°æ®" class="headerlink" title="ç›‘å¬å•ä¸ª / å¤šä¸ªæ•°æ®"></a>ç›‘å¬å•ä¸ª / å¤šä¸ªæ•°æ®</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å¯¼å…¥watch</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref, watch&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> age = <span class="title function_">ref</span>(<span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addCountAndAge</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  count.<span class="property">value</span>++</span></span><br><span class="line"><span class="language-javascript">  age.<span class="property">value</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è°ƒç”¨ watch ä¾¦å¬å•ä¸ªæ•°æ®å˜åŒ–</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(count, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è°ƒç”¨ watch ä¾¦å¬å•ä¸ªæ•°æ®å˜åŒ–&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;count&#x27;</span>, count.<span class="property">value</span>, newValue, oldValue)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è°ƒç”¨ watch ä¾¦å¬å¤šä¸ªæ•°æ®å˜åŒ–ã€å¤šä¸ªå€¼ä½¿ç”¨[]æ¥æ”¶ã€‘</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>([count, age], <span class="function">(<span class="params">[countNewValue, ageNewValue], [countOldValue, ageOldCount]</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è°ƒç”¨ watch ä¾¦å¬å¤šä¸ªæ•°æ®å˜åŒ–&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;count&#x27;</span>, count.<span class="property">value</span>, countNewValue, countOldValue)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;age&#x27;</span>, age.<span class="property">value</span>, ageNewValue, ageOldCount)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addCountAndAge&quot;</span>&gt;</span>Countï¼š&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addCountAndAge&quot;</span>&gt;</span>Ageï¼š&#123;&#123; age &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="immediate"><a href="#immediate" class="headerlink" title="immediate"></a>immediate</h3><blockquote><p><strong>immediateï¼šwatchçš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¼ å…¥å¯¹è±¡ï¼Œimmediateè®¾ç½®ä¸ºtrueï¼Œä¼šå…ˆæ‰§è¡Œä¸€æ¬¡watchçš„å›è°ƒå‡½æ•°ï¼Œä¸ç”¨ç­‰ç›‘å¬çš„å±æ€§å€¼æ”¹å˜</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å¯¼å…¥watch</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref, watch&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addCountAndAge</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  count.<span class="property">value</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è°ƒç”¨ watch ä¾¦å¬å•ä¸ªæ•°æ®å˜åŒ– ï¼Œimmediateä¸ºwatchçš„ç¬¬ä¸‰ä¸ªå‚æ•°</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// immediateè®¾ç½®ä¸ºtrue ä¼šå…ˆæ‰§è¡Œä¸€æ¬¡watchçš„å›è°ƒå‡½æ•°ï¼Œä¸ç”¨ç­‰ç›‘å¬çš„å±æ€§å€¼æ”¹å˜</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(count,<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;watchå›è°ƒå‡½æ•°æ‰§è¡Œäº†&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;, &#123;<span class="attr">immediate</span>: <span class="literal">true</span>&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addCountAndAge&quot;</span>&gt;</span>Countï¼š&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="deep"><a href="#deep" class="headerlink" title="deep"></a>deep</h3><blockquote><p><strong>é€šè¿‡watchç›‘å¬çš„refå¯¹è±¡é»˜è®¤æ˜¯æµ…å±‚ä¾¦å¬çš„ï¼Œç›´æ¥ä¿®æ”¹åµŒå¥—çš„å¯¹è±¡å±æ€§ä¸ä¼šè§¦å‘å›è°ƒæ‰§è¡Œï¼Œéœ€è¦å¼€å¯deepï¼Œ<code>deepå¼€å¯æœ‰æ€§èƒ½æŸè€—ï¼Œå°½é‡ä¸ä½¿ç”¨deep</code></strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å¯¼å…¥watch</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref, watch&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> person = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">age</span>: <span class="number">18</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">count</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateAge</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  person.<span class="property">value</span>.<span class="property">age</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateCount</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  person.<span class="property">value</span>.<span class="property">count</span>++</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// åœ¨watchçš„ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®  deep:true ï¼Œwatchæ‰èƒ½ç›‘å¬refè®¾ç½®çš„å¯¹è±¡å±æ€§ï¼Œæ­¤æ—¶ï¼Œå¯¹è±¡ä¸­æ— è®ºå“ªä¸ªå€¼æ”¹å˜éƒ½ä¼šè§¦å‘watchçš„å›è°ƒ</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(</span></span><br><span class="line"><span class="language-javascript">    person,</span></span><br><span class="line"><span class="language-javascript">    <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;personä¿®æ”¹äº†&quot;</span>, person.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123;<span class="attr">deep</span>: <span class="literal">true</span>&#125;</span></span><br><span class="line"><span class="language-javascript">)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// åœ¨watchçš„ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®  deep:true ï¼Œwatchæ‰èƒ½ç›‘å¬refè®¾ç½®çš„å¯¹è±¡å±æ€§ï¼Œæ­¤æ—¶ï¼ŒæŒ‡å®šçš„å¯¹è±¡ä¸­çš„å±æ€§çš„å€¼ä¿®æ”¹äº†æ‰èƒ½è§¦å‘watchçš„å›è°ƒ</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(</span></span><br><span class="line"><span class="language-javascript">    <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      person.<span class="property">value</span>.<span class="property">age</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;personä¿®æ”¹äº†&quot;</span>, person.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123;<span class="attr">deep</span>: <span class="literal">true</span>&#125;</span></span><br><span class="line"><span class="language-javascript">)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;updateAge&quot;</span>&gt;</span>ä¿®æ”¹ageï¼š&#123;&#123; person.age &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;updateCount&quot;</span>&gt;</span>ä¿®æ”¹countï¼š&#123;&#123; person.count &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#ç”Ÿå‘½å‘¨æœŸå‡½æ•°" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå‡½æ•°"></a>ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h1><blockquote><p><strong>é€‰é¡¹å¼ï¼švue2</strong></p><p><strong>ç»„åˆå¼ï¼švue3</strong></p></blockquote><p><img src="https://www.naste.top:9000/images/1678183720098-4d40e806-bc0d-4c38-bcbe-9aed440f6b23.png" alt="image.png"></p><blockquote><p><strong>ä½¿ç”¨importä»vueä¸­å¼•å…¥å„ä¸ªéœ€è¦ä½¿ç”¨çš„ç”Ÿå‘½å‘¨æœŸå‡½ï¼ŒåŒä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šæ¬¡ï¼Œè¯¥æƒ…å†µåº”ç”¨åœºæ™¯<code>å¦‚æœæ¥æ”¶åˆ«äººå†™çš„é¡¹ç›®ï¼Œä¸æ”¹åŠ¨åˆ«äººçš„ä»£ç ï¼Œåœ¨ä»–å‰é¢æ‰§è¡Œæ–°çš„åŠŸèƒ½ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°åœ¨ä»–å‰/åæ‰§è¡Œå³å¯</code></strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// ç”Ÿå‘½å‘¨æœŸ</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onBeforeMount</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onBeforeMount1&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//åŒä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°å¯ä»¥åŒæ—¶å†™å¤šä¸ªï¼Œä¼šæŒ‰ç…§é¡ºåºæ‰§è¡Œ</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onBeforeMount</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onBeforeMount2&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onMounted&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onBeforeUpdate</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onBeforeUpdate&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onUpdated</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onUpdated&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onBeforeUnmount&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onUnmounted&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="ç»„ä»¶é—´é€šä¿¡"><a href="#ç»„ä»¶é—´é€šä¿¡" class="headerlink" title="ç»„ä»¶é—´é€šä¿¡"></a>ç»„ä»¶é—´é€šä¿¡</h1><h2 id="çˆ¶ä¼ å­"><a href="#çˆ¶ä¼ å­" class="headerlink" title="çˆ¶ä¼ å­"></a>çˆ¶ä¼ å­</h2><blockquote><p><strong>çˆ¶ç»„ä»¶</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å¼•å…¥å­ç»„ä»¶</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Son</span> <span class="keyword">from</span> <span class="string">&#x27;./Son.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> person = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&quot;XiaoFei&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯ä»¥ä¼ å…¥ä¸Šé¢å®šä¹‰çš„å‚æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">son</span> <span class="attr">:person</span>=<span class="string">&quot;person&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>å­ç»„ä»¶</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>å­ç»„ä»¶æ¥æ”¶çš„æ•°æ®ï¼š&#123;&#123; props &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å­ç»„ä»¶æ¥æ”¶æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//å‚æ•°å:å‚æ•°ç±»å‹</span></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">person</span>: <span class="title class_">Object</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">person</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å­ä¼ çˆ¶"><a href="#å­ä¼ çˆ¶" class="headerlink" title="å­ä¼ çˆ¶"></a>å­ä¼ çˆ¶</h2><blockquote><p><strong>çˆ¶ç»„ä»¶</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å¼•å…¥å­ç»„ä»¶</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Son</span> <span class="keyword">from</span> <span class="string">&#x27;./Son.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getSonData</span> = (<span class="params">sonData</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å­ç»„ä»¶ä¼ é€’çš„æ•°æ®ï¼š&quot;</span>, sonData)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯ä»¥ä¼ å…¥ä¸Šé¢å®šä¹‰çš„å‚æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">son</span> @<span class="attr">get-son-data</span>=<span class="string">&quot;getSonData&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>å­ç»„ä»¶</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> person = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&quot;XiaoFei&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// é€šè¿‡ defineEmits ç¼–è¯‘å™¨å®ç”Ÿæˆemitæ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;get-son-data&#x27;</span>])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">sentMsg</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// è§¦å‘è‡ªå®šä¹‰å‡½æ•° å‘çˆ¶ç»„ä»¶ä¼ è¾“æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">emit</span>(<span class="string">&#x27;get-son-data&#x27;</span>, person)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sentMsg&quot;</span>&gt;</span>ç‚¹å‡»åï¼Œå‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è·¨ç»„ä»¶"><a href="#è·¨ç»„ä»¶" class="headerlink" title="è·¨ç»„ä»¶"></a>è·¨ç»„ä»¶</h2><blockquote><p><strong><code>provide</code>å’Œ<code>inject</code>å®ç°è·¨ç»„ä»¶é—´çš„ä»»æ„é€šè®¯</strong></p><p><strong>å¦‚æœä¼ é€’çš„æ˜¯æ–¹æ³•ï¼Œæ–¹æ³•ä¸­æœ‰ä¿®æ”¹ä¼ é€’æ•°æ®ç»„ä»¶ä¸­çš„æ•°æ®ï¼Œæ¥æ”¶æ–¹æ³•çš„ç»„ä»¶æ‹¿åˆ°è¯¥å‡½æ•°ä¹Ÿä¼šä¿®æ”¹ä¼ é€’æ•°æ®ç»„ä»¶ä¸­çš„æ•°æ®</strong></p></blockquote><ul><li><p>ä¼ é€’æ•°æ®ç»„ä»¶</p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Son</span> <span class="keyword">from</span> <span class="string">&#x27;./Son.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;provide, ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// éœ€è¦ä¼ é€’çš„å¯¹è±¡å‚æ•°</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> user = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">username</span>: <span class="string">&quot;123456&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">password</span>: <span class="string">&quot;223456&quot;</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// éœ€è¦ä¼ é€’çš„æ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">testMethod</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¼ é€’æµ‹è¯•æ–¹æ³•&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è·¨ç»„ä»¶ä¼ é€’æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">provide</span>(<span class="string">&#x27;user&#x27;</span>, user)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è·¨ç»„ä»¶ä¼ é€’æ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">provide</span>(<span class="string">&#x27;testMethod&#x27;</span>, testMethod)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">son</span> <span class="attr">ref</span>=<span class="string">&quot;sonRef&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>æ¥æ”¶æ•°æ®ç»„ä»¶</p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;inject&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è·¨ç»„ä»¶æ¥æ”¶å‚æ•°</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> user = <span class="title function_">inject</span>(<span class="string">&#x27;user&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// è·¨ç»„ä»¶æ¥æ”¶æ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> testMethod = <span class="title function_">inject</span>(<span class="string">&#x27;testMethod&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// åœ¨scriptä¸­ä½¿ç”¨è·¨ç»„ä»¶æ¥æ”¶çš„æ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">testMethod</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä½¿ç”¨è·¨ç»„ä»¶æ¥æ”¶çš„å‚æ•° --&gt;</span></span><br><span class="line">    &#123;&#123; user &#125;&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åœ¨templateä¸­ä½¿ç”¨è·¨ç»„ä»¶æ¥æ”¶æ–¹æ³• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;testMethod&quot;</span>&gt;</span>ä½¿ç”¨è·¨ç»„ä»¶æ¥æ”¶æ–¹æ³•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="æ¨¡ç‰ˆå¼•ç”¨"><a href="#æ¨¡ç‰ˆå¼•ç”¨" class="headerlink" title="æ¨¡ç‰ˆå¼•ç”¨"></a>æ¨¡ç‰ˆå¼•ç”¨</h1><blockquote><p><strong>é€šè¿‡ ref æ ‡è¯† è·å–çœŸå®çš„ dom å¯¹è±¡æˆ–è€…ç»„ä»¶å®ä¾‹å¯¹è±¡</strong></p></blockquote><h2 id="è·å–æ ‡ç­¾å¯¹è±¡dom"><a href="#è·å–æ ‡ç­¾å¯¹è±¡dom" class="headerlink" title="è·å–æ ‡ç­¾å¯¹è±¡dom"></a>è·å–æ ‡ç­¾å¯¹è±¡dom</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;onMounted, ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> h1Ref = <span class="title function_">ref</span>(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// ä½¿ç”¨refè·å–domå¯¹è±¡ï¼Œéœ€è¦åœ¨ç»„ä»¶æŒ‚è½½å®Œæˆä¹‹åæ‰èƒ½è·å–</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(h1Ref.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">ref</span>=<span class="string">&quot;h1Ref&quot;</span>&gt;</span>domæ ‡ç­¾<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è·å–vueç»„ä»¶domåŠä½¿ç”¨testMessageè·å–ç»„ä»¶å±æ€§"><a href="#è·å–vueç»„ä»¶domåŠä½¿ç”¨testMessageè·å–ç»„ä»¶å±æ€§" class="headerlink" title="è·å–vueç»„ä»¶domåŠä½¿ç”¨testMessageè·å–ç»„ä»¶å±æ€§"></a>è·å–vueç»„ä»¶domåŠä½¿ç”¨testMessageè·å–ç»„ä»¶å±æ€§</h2><blockquote><p><strong>çˆ¶ç»„ä»¶ä½¿ç”¨refè·å–åˆ°çš„vueç»„ä»¶çš„domï¼Œé»˜è®¤æƒ…å†µä¸‹åœ¨ <code>script setup</code>è¯­æ³•ç³–ä¸‹ç»„ä»¶å†…éƒ¨çš„å±æ€§å’Œæ–¹æ³•æ˜¯ä¸å¼€æ”¾ç»™çˆ¶ç»„ä»¶è®¿é—®çš„ï¼Œå¯ä»¥é€šè¿‡<code>defineExpose</code>ç¼–è¯‘å®æŒ‡å®šå“ªäº›å±æ€§å’Œæ–¹æ³•å®¹è®¸è®¿é—®</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;onMounted, ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Son</span> <span class="keyword">from</span> <span class="string">&#x27;./Son.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> sonRef = <span class="title function_">ref</span>(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(sonRef.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">son</span> <span class="attr">ref</span>=<span class="string">&quot;sonRef&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Sonç»„ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">import &#123;ref&#125; from &quot;vue&quot;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">const name = ref(&quot;XiaoFei&quot;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="comment">&lt;!-- å½“ä½¿ç”¨refè·å–è¯¥ç»„ä»¶çš„æ¨¡æ¿å¼•ç”¨æ—¶ï¼Œä½¿ç”¨defineExposeæŒ‡å®šå“ªäº›å±æ€§å’Œæ–¹æ³•å®¹è®¸è®¿é—® --&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">defineExpose(&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  name</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">&#125;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p>]]></content>
    
    
    <summary type="html">vue3</summary>
    
    
    
    <category term="å‰ç«¯" scheme="https://www.naste.top:1024/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="Vue" scheme="https://www.naste.top:1024/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>JVM</title>
    <link href="https://www.naste.top:1024/posts/1723864827.html"/>
    <id>https://www.naste.top:1024/posts/1723864827.html</id>
    <published>2023-04-25T13:33:12.000Z</published>
    <updated>2023-04-26T04:09:02.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p>]]></content>
    
    
    <summary type="html">JVM</summary>
    
    
    
    <category term="Java" scheme="https://www.naste.top:1024/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.naste.top:1024/tags/Java/"/>
    
    <category term="JVM" scheme="https://www.naste.top:1024/tags/JVM/"/>
    
  </entry>
  
  <entry>
    <title>å¼€æœºå¯åŠ¨Shellè„šæœ¬</title>
    <link href="https://www.naste.top:1024/posts/2098160006.html"/>
    <id>https://www.naste.top:1024/posts/2098160006.html</id>
    <published>2023-04-12T02:10:45.000Z</published>
    <updated>2023-04-12T02:20:30.819Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>[TOC]</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ol><li>ChatGPT</li><li><a href="">Linuxä¸‹è®¾ç½®å¼€æœºè‡ªåŠ¨è¿è¡Œè„šæœ¬çš„5ç§æ–¹æ³•ï¼šhttps://blog.csdn.net/qq_44839276/article/details/107622265</a></li></ol><h1 id="systemd"><a href="#systemd" class="headerlink" title="systemd"></a>systemd</h1><blockquote><p><strong>å°†Shellè„šæœ¬ä½¿ç”¨systemdï¼Œä½¿ç”¨æœåŠ¡å¯åŠ¨</strong></p></blockquote><p><strong>ä½¿ç”¨<code>vim /etc/systemd/system/my-script.service</code>ï¼Œå°†ä¸‹é¢å†…å®¹åŠ å…¥æœåŠ¡è„šæœ¬ä¸­ï¼Œå¹¶ä¸”ç»™è„šæœ¬åŠ ä¸Šå¯æ‰§è¡Œæƒé™<code>chmod +x éœ€è¦æ‰§è¡Œçš„è„šæœ¬</code></strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=My script</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Type=oneshot è¡¨ç¤ºæœåŠ¡åªè¿è¡Œä¸€æ¬¡ï¼Œå¹¶åœ¨è„šæœ¬ç»“æŸåé€€å‡ºã€‚RemainAfterExit=<span class="built_in">yes</span> åˆ™è¡¨ç¤ºæœåŠ¡åœ¨è„šæœ¬ç»“æŸååº”ä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</span></span><br><span class="line">Type=oneshot</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line">ExecStart=/bin/bash /root/start.sh</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=default.target</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®å¼€æœºå¯åŠ¨è„šæœ¬</span></span><br><span class="line">systemctl enable my-script.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨è„šæœ¬</span></span><br><span class="line">systemctl start my-script.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹è„šæœ¬æ‰§è¡Œæ—¥å¿—</span></span><br><span class="line">journalctl -u my-script.service</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–</span></span><br><span class="line">systemctl status my-script.service</span><br></pre></td></tr></table></figure><h2 id="ç›¸å…³é”™è¯¯å‚è€ƒ"><a href="#ç›¸å…³é”™è¯¯å‚è€ƒ" class="headerlink" title="ç›¸å…³é”™è¯¯å‚è€ƒ"></a>ç›¸å…³é”™è¯¯å‚è€ƒ</h2><p>å¦‚æœæœåŠ¡å·²ç»æ­£ç¡®å¯åŠ¨ï¼Œä½†æ˜¯è„šæœ¬æ²¡æœ‰è¿è¡Œï¼Œå¯èƒ½æ˜¯ç”±äºä»¥ä¸‹åŸå› ï¼š</p><ol><li><p>æ£€æŸ¥è„šæœ¬æ–‡ä»¶ä¸­çš„å‘½ä»¤æ˜¯å¦æ­£ç¡®ï¼ŒåŒ…æ‹¬å‘½ä»¤çš„è·¯å¾„ã€å‚æ•°ã€è¯­æ³•ç­‰ã€‚æ‚¨å¯ä»¥æ‰‹åŠ¨è¿è¡Œè„šæœ¬æ¥æ£€æŸ¥å®ƒæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚</p></li><li><p>æ£€æŸ¥æœåŠ¡çš„å·¥ä½œç›®å½•å’Œç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®ã€‚å¦‚æœåœ¨è„šæœ¬ä¸­ä½¿ç”¨äº†ç›¸å¯¹è·¯å¾„æˆ–å…¶ä»–éœ€è¦ç¯å¢ƒå˜é‡æ”¯æŒçš„å‘½ä»¤ï¼Œè¿™ä¸€ç‚¹æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p></li><li><p>æ£€æŸ¥è„šæœ¬æ˜¯å¦éœ€è¦ä¸€äº›ç‰¹å®šçš„æƒé™æˆ–æˆæƒæ¥è¿è¡Œã€‚å¦‚æœæ‚¨é€šè¿‡ sudo æˆ–ç±»ä¼¼çš„æ–¹å¼ä»¥ root æƒé™æ‰§è¡Œè„šæœ¬ï¼Œåˆ™æœåŠ¡ä¹Ÿå¿…é¡»ä»¥ç›¸åº”çš„æƒé™çº§åˆ«è¿è¡Œã€‚</p></li><li><p>æ£€æŸ¥æœåŠ¡çš„å¯åŠ¨ç±»å‹ã€‚å¦‚æœæ‚¨çš„æœåŠ¡æ˜¯å¯åŠ¨åç«‹å³åœæ­¢çš„ï¼Œé‚£ä¹ˆè„šæœ¬åœ¨æœåŠ¡åœæ­¢æ—¶å°†è¢«æ€æ­»ã€‚æ‚¨å¯ä»¥æ›´æ”¹æœåŠ¡çš„å¯åŠ¨ç±»å‹ä¸º oneshotï¼Œè¿™æ ·è„šæœ¬åœ¨æœåŠ¡å¯åŠ¨æ—¶ä¼šè¿è¡Œå¹¶ç«‹å³é€€å‡ºï¼Œå¹¶ä¸”æœåŠ¡å°†ä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</p></li><li><p>å¦‚æœæ‚¨çš„æœåŠ¡ä¾èµ–äºå…¶ä»–æœåŠ¡æˆ–è¿›ç¨‹ï¼Œè¯·ç¡®ä¿è¿™äº›æœåŠ¡æˆ–è¿›ç¨‹åœ¨ç³»ç»Ÿä¸Šå·²ç»æ­£ç¡®é…ç½®å¹¶æ­£åœ¨è¿è¡Œã€‚</p></li><li><p>å¦‚æœæ‚¨çš„è„šæœ¬éœ€è¦ä¸å…¶ä»–ç¨‹åºäº¤äº’ï¼Œè¯·ç¡®ä¿å®ƒä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•å†²çªæˆ–é”™è¯¯ã€‚</p></li></ol>]]></content>
    
    
    <summary type="html">å¼€æœºå¯åŠ¨Shellè„šæœ¬</summary>
    
    
    
    <category term="Linux" scheme="https://www.naste.top:1024/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.naste.top:1024/tags/Linux/"/>
    
    <category term="Shell" scheme="https://www.naste.top:1024/tags/Shell/"/>
    
  </entry>
  
</feed>
